2025-07-30 16:45:28,421 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 16:45:28,422 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 16:45:29,954 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:45:29,998 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:45:30,039 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 16:47:02,428 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 16:47:02,429 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 16:47:03,531 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:47:03,540 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:47:03,544 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 16:47:03,561 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 16:47:03,628 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 16:47:03,632 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:05:58,483 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:05:58,484 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:05:59,874 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:05:59,887 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:05:59,892 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:05:59,900 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:05:59,987 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:05:59,990 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:13:18,649 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:13:18] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:17:51,508 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:17:51,509 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:17:52,575 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:17:52,585 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:17:52,594 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:17:52,601 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:17:52,665 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:17:52,667 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:18:21,172 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:21] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:18:57,349 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:57] "[33mGET /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:18:58,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:58] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-07-30 17:19:14,821 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:19:14,822 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:19:15,639 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:19:15,649 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:19:15,654 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:19:15,660 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:19:15,726 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:19:15,727 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:19:36,995 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:19:36] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:19:58,547 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:19:58] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:21:05,586 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:21:05] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:23:23,021 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:23:23] "[33mPOST /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:23:40,253 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:23:40,254 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:23:41,694 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:23:41,707 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:23:41,713 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:23:41,738 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:23:41,816 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:23:41,822 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:24:06,666 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:24:06] "[33mPOST /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:26:38,518 - app.core.auth - WARNING - verify_slack_request:61 - Invalid Slack signature from 127.0.0.1
2025-07-30 17:26:38,518 - app.core.auth - WARNING - decorated_function:107 - Invalid request signature from 127.0.0.1
2025-07-30 17:26:38,521 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:26:38] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 403 -
2025-07-30 17:28:14,147 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:28:14,148 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:28:15,138 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:28:15,148 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:28:15,153 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:28:15,170 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:28:15,238 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:28:15,244 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:28:25,228 - app.core.auth - WARNING - check_user_permission:89 - Unauthorized access attempt by user: U0968C1G72L
2025-07-30 17:28:25,229 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:28:25] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 403 -
2025-07-30 17:29:59,555 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:29:59,555 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:30:00,410 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:00,418 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:00,423 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:30:00,444 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:30:00,494 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:30:00,496 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:30:08,104 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885808', 'text': ''}
2025-07-30 17:30:08,105 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:30:08,120 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:30:08,124 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:30:08] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:30:27,069 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:30:27,070 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:30:27,852 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:27,860 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:27,864 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:30:27,879 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:30:28,022 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:30:28,038 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:30:32,023 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885832', 'text': ''}
2025-07-30 17:30:32,024 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:30:32,038 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:30:32,041 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:30:32] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:32:34,580 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:32:34,581 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:32:35,517 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:32:35,525 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:32:35,529 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:32:35,542 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:32:35,593 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:32:35,598 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:32:40,251 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885960', 'text': ''}
2025-07-30 17:32:40,253 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:32:40,348 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:32:40,402 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:32:40] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:34:01,607 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:34:01,608 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:34:02,420 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:34:02,429 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:34:02,434 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:34:02,445 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:34:02,499 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:34:02,503 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:34:08,567 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886049', 'text': ''}
2025-07-30 17:34:08,569 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:34:08] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 17:35:06,284 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:35:06,286 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:35:07,167 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:35:07,176 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:35:07,181 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:35:07,201 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:35:07,295 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:35:07,311 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:35:19,185 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886119', 'text': ''}
2025-07-30 17:35:19,186 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:35:19] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 17:41:56,676 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:41:56,677 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:41:57,940 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:41:57,981 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:41:58,005 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:41:58,012 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:41:58,095 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:41:58,096 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:43:07,953 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/getdata', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886588', 'text': ''}
2025-07-30 17:43:12,041 - app.services.google_service - ERROR - read_sheet_data:91 - Error reading sheet data: <HttpError 404 when requesting https://sheets.googleapis.com/v4/spreadsheets/your-sheet-id/values/A1%3AB10?alt=json returned "Requested entity was not found.". Details: "Requested entity was not found.">
2025-07-30 17:43:12,068 - app.handlers.command_handler - ERROR - handle_get_sheet_data:139 - Error getting sheet data: <HttpError 404 when requesting https://sheets.googleapis.com/v4/spreadsheets/your-sheet-id/values/A1%3AB10?alt=json returned "Requested entity was not found.". Details: "Requested entity was not found.">
2025-07-30 17:43:12,082 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:43:12] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:03:34,112 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:03:34,130 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:03:43,454 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:03:43,471 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:03:43,491 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:03:43,518 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:03:43,737 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:03:43,738 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:08:43,198 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:08:43,199 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:08:47,057 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:08:47,072 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:08:47,079 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:08:47,106 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:08:47,235 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:08:47,235 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:12:05,109 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/getdata', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753891924', 'text': 'source=sheet sheet_id=1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c range=A1:B10'}
2025-07-30 19:12:16,403 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 19:12:18,962 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 19:12:19,032 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:12:19] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:31:06,412 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893066', 'text': ''}
2025-07-30 19:31:06,446 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:31:06] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:31:59,308 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893114', 'text': ''}
2025-07-30 19:31:59,310 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:31:59] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:32:22,844 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:32:22,845 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:32:24,382 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:32:24,392 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:32:24,397 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:32:24,417 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:32:24,496 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:32:24,503 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:32:31,931 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893152', 'text': ''}
2025-07-30 19:32:35,200 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:32:35,202 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:32:35] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:33:35,477 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893214', 'text': ''}
2025-07-30 19:33:36,322 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:33:36,323 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:33:36] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:39:24,546 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:39:24,547 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:39:25,840 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,854 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,862 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:39:25,983 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,994 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,998 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:39:26,013 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:39:26,085 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:39:26,087 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:40:37,405 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893637', 'text': ''}
2025-07-30 19:40:37,407 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:40:37] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:46:40,708 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:46:40,709 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:46:41,563 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,572 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,576 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:46:41,663 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,671 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,675 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:46:41,702 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:46:41,746 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:46:41,748 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:47:18,388 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894038', 'text': ''}
2025-07-30 19:47:18,390 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:47:18] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:47:25,752 - app.core.auth - WARNING - decorated_function:120 - No user ID found in request
2025-07-30 19:47:25,753 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:47:25] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 400 -
2025-07-30 19:49:13,349 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:49:13,350 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:49:14,358 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,366 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,371 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:49:14,444 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,453 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,457 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:49:14,475 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:49:14,512 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:49:14,513 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:49:25,595 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:25] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:49:35,983 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894176', 'text': ''}
2025-07-30 19:49:35,988 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:35] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:49:41,701 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:41] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:50:16,207 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894216', 'text': ''}
2025-07-30 19:50:16,210 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:50:16] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:50:23,007 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:50:23] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:55:03,585 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:55:03,594 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:55:13,281 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:55:13,308 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:55:13,322 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:55:13,361 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:55:13,679 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:55:13,680 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:55:56,081 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894556', 'text': ''}
2025-07-30 19:55:56,088 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:55:56] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:56:04,112 - app.core.auth - WARNING - decorated_function:120 - No user ID found in request
2025-07-30 19:56:04,113 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:56:04] "[31m[1mPOST /api/interactions/command HTTP/1.1[0m" 400 -
2025-07-30 19:58:07,815 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:58:07,820 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:58:12,700 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:58:12,717 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:58:12,725 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:58:12,761 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:58:12,969 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:58:12,970 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:58:23,358 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894702', 'text': ''}
2025-07-30 19:58:23,367 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:58:23] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:58:28,644 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 19:58:28,647 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753894704.078049', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277471746325.9212409550592.0a60e5456c1fb4e3f5d9e591b5d60bcb', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753894704.078049', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277471729813/Jx8V6metVuZQSGVdYYnJEFQf', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753894708.141303'}]}
2025-07-30 19:58:29,161 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 19:58:29,161 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 19:58:29,162 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 19:58:29,162 - app.handlers.command_handler - INFO - handle_list_sheets_action:136 - Fetching available sheets...
2025-07-30 19:58:34,801 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:58:34,802 - app.handlers.command_handler - INFO - handle_list_sheets_action:138 - Found 1 sheets
2025-07-30 19:58:34,803 - app.handlers.command_handler - INFO - handle_list_sheets_action:151 - Formatting sheets list...
2025-07-30 19:58:34,803 - app.handlers.command_handler - INFO - handle_list_sheets_action:153 - Formatted 3 blocks
2025-07-30 19:58:34,804 - app.handlers.command_handler - INFO - handle_list_sheets_action:155 - Posting message to channel...
2025-07-30 19:58:36,012 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 19:58:36,012 - app.handlers.command_handler - INFO - handle_list_sheets_action:162 - List sheets action completed successfully
2025-07-30 19:58:36,013 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:58:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:02:00,274 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:02:00,278 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:02:07,514 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:02:07,552 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:02:07,584 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:02:07,605 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:02:07,854 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:02:07,914 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:02:20,877 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894940', 'text': ''}
2025-07-30 20:02:20,880 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:02:20] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:02:26,143 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:02:26,144 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753894941.509449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294208476657.9212409550592.377de2b55b4017c1df3439ce92c68d41', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753894941.509449', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294208321313/EnAxFDdQBUMaOTv9D8YD8NNv', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753894946.165926'}]}
2025-07-30 20:02:26,148 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:02:26,149 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:02:26,149 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:02:27,901 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:02:27,903 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:02:27,903 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:02:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:02:31,437 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:02:31,438 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:02:31,439 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:02:31,440 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:02:31,440 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:02:32,368 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:02:32,369 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:07:07,698 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:07:07,699 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:07:09,028 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:07:09,045 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:07:09,055 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:07:09,092 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:07:09,147 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:07:09,149 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:07:31,758 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753895251', 'text': ''}
2025-07-30 20:07:31,760 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:31] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:07:37,319 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:07:37,320 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895252.373069', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275098243555.9212409550592.71bb8a885b1672e70f3fee635863f9ca', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753895252.373069', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275098243427/VWgLUWAheoLNvRgGJPMvMo0Z', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753895257.310051'}]}
2025-07-30 20:07:37,370 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:07:37,377 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:07:37,378 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:07:38,425 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:38,427 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:07:38,428 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:07:42,241 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:07:42,242 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:07:42,242 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:07:42,243 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:07:42,243 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:07:43,106 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:43,107 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:07:49,155 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:07:49,156 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895263.292229', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9263941303415.9212409550592.e82b48d3318848face711a1d9dbd7abf', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895263.292229', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9263941228455/iFRFuZFS7Vrm31MdGDgax4VX', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753895269.135856'}]}
2025-07-30 20:07:49,158 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:07:49,159 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:203 - Handling get data sheet action
2025-07-30 20:07:49,159 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:07:52,404 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:52,406 - app.handlers.command_handler - INFO - fetch_and_send_data:228 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:07:52,407 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:07:55,903 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:07:55,904 - app.handlers.command_handler - INFO - fetch_and_send_data:230 - Retrieved 5 rows of data
2025-07-30 20:07:55,905 - app.handlers.command_handler - INFO - fetch_and_send_data:241 - Formatting data blocks...
2025-07-30 20:07:55,906 - app.handlers.command_handler - INFO - fetch_and_send_data:243 - Formatted 8 blocks
2025-07-30 20:07:56,796 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:56,797 - app.handlers.command_handler - INFO - fetch_and_send_data:251 - Get data action completed successfully
2025-07-30 20:08:17,205 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:08:17,206 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895276.965449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275101939763.9212409550592.c73ada03e6e6bffdeae9e256805f1f47', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895276.965449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '+67YS', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'xJ3wb'}, {'type': 'section', 'block_id': 'nVv+k', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'JoEPs', 'text': {'type': 'plain_text', 'text': ' | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'i9yRV', 'text': {'type': 'plain_text', 'text': ' | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'HFs0G', 'text': {'type': 'plain_text', 'text': ' | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'csu+2', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'aoUWc', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275101935523/7X3aX6xiHWdgUJExwcjJV7um', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aoUWc', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895297.248717'}]}
2025-07-30 20:08:17,211 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:08:17,212 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:08:17,213 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:08:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:27,739 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:09:27,740 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895276.965449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275979972326.9212409550592.e96de9a7866f2c8279fbe86bdc715ad3', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895276.965449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '+67YS', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'xJ3wb'}, {'type': 'section', 'block_id': 'nVv+k', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'JoEPs', 'text': {'type': 'plain_text', 'text': ' | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'i9yRV', 'text': {'type': 'plain_text', 'text': ' | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'HFs0G', 'text': {'type': 'plain_text', 'text': ' | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'csu+2', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'aoUWc', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275979971302/Ycib0F7vIxjScMayJLqa0kcp', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aoUWc', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895367.782622'}]}
2025-07-30 20:09:27,744 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:09:27,745 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:09:27,746 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:51,913 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753895391', 'text': ''}
2025-07-30 20:09:51,915 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:51] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:09:57,499 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:09:57,500 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895392.520929', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9263953247511.9212409550592.31b771418e25dfaad40f6265c25d643b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753895392.520929', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9263953222263/Sux0IaIup9gSslCeJeTJwPEi', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753895397.543983'}]}
2025-07-30 20:09:57,531 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:09:57,531 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:09:57,532 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:09:58,480 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:09:58,481 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:09:58,482 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:59,202 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:09:59,203 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:09:59,204 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:09:59,205 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:09:59,206 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:10:00,101 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:00,102 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:10:05,051 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:10:05,052 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895400.265109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294256981649.9212409550592.1affaa5f9236689eca039e407824f6d6', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895400.265109', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294256903601/agxP161q6xWDSnu4kpK28lbO', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753895404.992812'}]}
2025-07-30 20:10:05,054 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:10:05,055 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:203 - Handling get data sheet action
2025-07-30 20:10:05,055 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:10:05,996 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:05,998 - app.handlers.command_handler - INFO - fetch_and_send_data:228 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:10:05,999 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:10:05] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:10:07,250 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:10:07,251 - app.handlers.command_handler - INFO - fetch_and_send_data:230 - Retrieved 5 rows of data
2025-07-30 20:10:07,251 - app.handlers.command_handler - INFO - fetch_and_send_data:241 - Formatting data blocks...
2025-07-30 20:10:07,252 - app.handlers.command_handler - INFO - fetch_and_send_data:243 - Formatted 8 blocks
2025-07-30 20:10:08,235 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:08,236 - app.handlers.command_handler - INFO - fetch_and_send_data:251 - Get data action completed successfully
2025-07-30 20:10:57,611 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:10:57,611 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895408.406139', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275117862019.9212409550592.e201dbe0c4501164e5a11eee425ad1e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895408.406139', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'KCNMq', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qOr3x'}, {'type': 'section', 'block_id': 'yZLXs', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '/Rn4y', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'x6w5M', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'V3AGu', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'icBjk', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Bn8q/', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275117810979/uODzAKhVR6ZWlOMxEVjgbYhA', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Bn8q/', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895457.624243'}]}
2025-07-30 20:10:57,616 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:10:57,616 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:10:57,620 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:10:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:08,795 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:30:08,796 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:30:14,487 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:30:14,710 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:30:14,794 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:30:14,809 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:30:14,957 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:30:14,958 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:30:25,254 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753896625', 'text': ''}
2025-07-30 20:30:25,258 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:25] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:30:30,655 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:30,658 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896625.804969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279490980386.9212409550592.2642590d22cb3392b54b190474194374', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753896625.804969', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279490948050/zxQrXPpOwN85UaFidmZDzMVE', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753896630.353252'}]}
2025-07-30 20:30:30,665 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:30,665 - app.handlers.command_handler - INFO - handle_list_sheets_action:131 - Handling list sheets action
2025-07-30 20:30:30,666 - app.handlers.command_handler - INFO - handle_list_sheets_action:135 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:30:31,912 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:31,914 - app.handlers.command_handler - INFO - fetch_and_send_sheets:155 - Fetching available sheets...
2025-07-30 20:30:31,915 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:36,356 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:30:36,357 - app.handlers.command_handler - INFO - fetch_and_send_sheets:157 - Found 1 sheets
2025-07-30 20:30:36,358 - app.handlers.command_handler - INFO - fetch_and_send_sheets:170 - Formatting sheets list...
2025-07-30 20:30:36,358 - app.handlers.command_handler - INFO - fetch_and_send_sheets:172 - Formatted 3 blocks
2025-07-30 20:30:36,359 - app.handlers.command_handler - INFO - fetch_and_send_sheets:174 - Posting message to channel...
2025-07-30 20:30:37,221 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:37,222 - app.handlers.command_handler - INFO - fetch_and_send_sheets:181 - List sheets action completed successfully
2025-07-30 20:30:40,694 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:40,696 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896637.313829', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279492419890.9212409550592.bdfd57bb17b565adbfe6871698043bcd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896637.313829', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279492419730/sCQOGG3oxGToulgvAcZbrkUU', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753896640.640498'}]}
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:209 - Handling get data sheet action
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:214 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:30:42,555 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:42,558 - app.handlers.command_handler - INFO - fetch_and_send_data:234 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:42,559 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:45,716 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:45,717 - app.handlers.command_handler - INFO - fetch_and_send_data:236 - Retrieved 5 rows of data
2025-07-30 20:30:45,717 - app.handlers.command_handler - INFO - fetch_and_send_data:247 - Formatting data blocks...
2025-07-30 20:30:45,718 - app.handlers.command_handler - INFO - fetch_and_send_data:249 - Formatted 8 blocks
2025-07-30 20:30:46,729 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:46,729 - app.handlers.command_handler - INFO - fetch_and_send_data:257 - Get data action completed successfully
2025-07-30 20:30:50,265 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:50,269 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896646.820599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275237634563.9212409550592.a794058ee174c0902c7f58785b08f05d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896646.820599', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275237633923/JTSxZthr4PBSANhjXOAQWWzp', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896650.219271'}]}
2025-07-30 20:30:50,272 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:50,273 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:30:50,274 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:30:51,169 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:51,185 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:52,181 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:53,196 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:25,111 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:31:25,113 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896653.272379', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277667059477.9212409550592.67c5d3141d1c0a1597d47d0d6a346266', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896653.272379', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277667057061/cOpPopGHCzvBusyCm0X7UKHO', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896685.067842'}]}
2025-07-30 20:31:25,117 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:31:25,117 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:31:25,120 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:31:26,071 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:26,101 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:31:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:31:27,323 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:31:28,199 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:38,809 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:31:38,810 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896688.293779', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301441638960.9212409550592.75306552e37f7600d452010b5d05460a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896688.293779', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301441638848/xryJrQYBTAih5YL0atLXNpZG', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896698.762568'}]}
2025-07-30 20:31:38,822 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:31:38,822 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:31:38,828 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:31:39,837 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9301441638960.9212409550592.75306552e37f7600d452010b5d05460a
2025-07-30 20:31:39,839 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:31:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:32:13,331 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:32:13,345 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277671637989.9212409550592.ea672b1ee8a2145765d676f540ca60fe', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:32:13,347 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:32:13,354 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:32:13,355 - app.handlers.command_handler - INFO - handle_view_submission:460 - Unknown modal callback_id: write_sheet_data_modal
2025-07-30 20:32:13,362 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:32:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:33:14,790 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:33:14,792 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:33:18,239 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:33:18,252 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:33:18,260 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:33:18,282 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:33:18,398 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:33:18,399 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:33:51,373 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:33:51,375 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279511359602.9212409550592.f276e9190f52cc7b38fb5559ede4e1f9', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:33:51,378 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:33:51,378 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:33:51,379 - app.handlers.command_handler - INFO - handle_view_submission:460 - Unknown modal callback_id: write_sheet_data_modal
2025-07-30 20:33:51,388 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:33:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:39:08,471 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:39:08,478 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:39:11,462 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:39:11,481 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:39:11,491 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:39:11,524 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:39:11,652 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:39:11,656 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:39:29,241 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:39:29,243 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9294431344881.9212409550592.0af449bc5af065803afe9d8075860f7e', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:39:29,248 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:39:29,249 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:39:29,249 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:39:29,250 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: 1, Value: website
2025-07-30 20:39:29,251 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: 11
2025-07-30 20:39:29,257 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:527 - Error handling write data modal submission: Invalid range format: 11
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 510, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: 11
2025-07-30 20:39:29,287 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:39:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:39:59,558 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:39:59,559 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279543116562.9212409550592.c6d393498704bc655b8bf8fe24edb4cb', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:39:59,573 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:39:59,574 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:39:59,574 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:39:59,575 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: 1, Value: website
2025-07-30 20:39:59,584 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: 12
2025-07-30 20:39:59,585 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:527 - Error handling write data modal submission: Invalid range format: 12
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 510, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: 12
2025-07-30 20:39:59,603 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:39:59] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:43:33,754 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:43:33,755 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:43:37,148 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:43:37,161 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:43:37,168 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:43:37,196 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:43:37,281 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:43:37,285 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:44:03,716 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:03,718 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275314945731.9212409550592.6abc7ea3b5db4df1509ddaf0bc6119f1', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:03,725 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:03,729 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:03,730 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:03,732 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: 1, Value: website
2025-07-30 20:44:09,244 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A1
2025-07-30 20:44:10,712 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:44:10,719 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:10] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:14,542 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:14,543 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9276179008726.9212409550592.700c050b7183e5c7f064d2e7fb032b9d', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': 'a'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:14,551 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:14,552 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:14,552 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:14,553 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: a, Col: 1, Value: website
2025-07-30 20:44:14,554 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:14] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:23,485 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:23,489 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275316995363.9212409550592.5c30fb5ddaa74b5d60ab166ed3f4e1dd', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:23,573 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:23,581 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:23,586 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:23,605 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: 1, Value: website
2025-07-30 20:44:24,670 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A2
2025-07-30 20:44:25,566 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:44:25,568 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:36,684 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:36,685 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896688.293779', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280644621092.9212409550592.f6f6b09a4d272713958f4f577b450d19', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896688.293779', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280644617652/u6DdXiEqPETVLtKUFMffO27s', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897476.580033'}]}
2025-07-30 20:44:36,693 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:44:36,695 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:44:36,696 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:44:37,570 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:44:37,617 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:38,785 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:44:39,778 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:44:47,209 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:47,296 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897479.847799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280643560980.9212409550592.e77453338f557e19156b1fb59cc13154', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897479.847799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSCmb', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'PgJpK'}, {'type': 'section', 'block_id': 'K777D', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'CpS4G', 'text': {'type': 'plain_text', 'text': 'website | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'tZF8d', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'pudql', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'h/AJU', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'YPaUd', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280643554756/Kt3Ry4evqUCYri0yBpKRRjht', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'YPaUd', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897486.669948'}]}
2025-07-30 20:44:47,376 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:44:47,381 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:44:47,433 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:44:48,428 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280643560980.9212409550592.e77453338f557e19156b1fb59cc13154
2025-07-30 20:44:48,430 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:48] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:09,614 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:09,616 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9301512574880.9212409550592.bf064f6ed93467f676fb0c05af938b6a', 'view': {'id': 'V0985MFS7QD', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Mobile'}}}}, 'hash': '1753897488.TzDhtWPe', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0985MFS7QD', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:45:09,642 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:45:09,647 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:45:09,648 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:45:09,658 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: A, Value: Mobile
2025-07-30 20:45:10,797 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A2
2025-07-30 20:45:11,943 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:45:11,959 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:11] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:20,357 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:20,362 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897479.847799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275322960563.9212409550592.a05b3f9f3e25d9cbc522e5aa4b9086d1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897479.847799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSCmb', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'PgJpK'}, {'type': 'section', 'block_id': 'K777D', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'CpS4G', 'text': {'type': 'plain_text', 'text': 'website | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'tZF8d', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'pudql', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'h/AJU', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'YPaUd', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275322954675/ijjG7THNJwRLO9BUNoUqbMIK', 'actions': [{'action_id': 'refresh_data', 'block_id': 'YPaUd', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897520.058584'}]}
2025-07-30 20:45:20,442 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:45:20,451 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:45:20,453 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:45:21,589 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:45:21,608 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:21] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:22,600 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:45:23,538 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:45:38,206 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:38,211 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279571885970.9212409550592.7680172e4edfc5fe9ce2bee4b5ad2329', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279571773106/RhpUpHCOPHxIBfK2dVtSc9Rt', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897538.064843'}]}
2025-07-30 20:45:38,239 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:45:38,240 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:45:38,248 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:45:39,163 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279571885970.9212409550592.7680172e4edfc5fe9ce2bee4b5ad2329
2025-07-30 20:45:39,167 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:55,621 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:55,622 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9294467896433.9212409550592.cac96e9419d70b3813c64ddf29a4ad66', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'a'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:45:55,633 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:45:55,634 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:45:55,636 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:45:55,637 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: a, Value: Tasks
2025-07-30 20:45:55,638 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: a1
2025-07-30 20:45:55,640 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:545 - Error handling write data modal submission: Invalid range format: a1
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 528, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: a1
2025-07-30 20:45:55,659 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:06,323 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:06,331 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277745261109.9212409550592.d82cecac61454d3e4b460fd28f013a7d', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': 'a1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'a'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:46:06,351 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:46:06,356 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:46:06,374 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:46:06,374 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: a1, Col: a, Value: Tasks
2025-07-30 20:46:06,377 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:17,151 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:17,153 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9301519140976.9212409550592.cf9be3fefb62be11d538c157b5ac7454', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:46:17,171 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:46:17,171 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:46:17,181 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:46:17,183 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: A, Value: Tasks
2025-07-30 20:46:18,283 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A1
2025-07-30 20:46:22,232 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:46:22,238 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:22] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:31,288 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:31,290 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264156991959.9212409550592.abaaf4a4484de62e6ad00d3817b90c50', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264156913191/eBYJsG4k5Me89jPFMp1eaLAI', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897590.942709'}]}
2025-07-30 20:46:31,307 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:46:31,309 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:46:31,310 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:46:32,279 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264156991959.9212409550592.abaaf4a4484de62e6ad00d3817b90c50
2025-07-30 20:46:32,282 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:38,680 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:38,681 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279577596546.9212409550592.ebe1ec606bfbeccb510e822995407e4f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279577558818/lY2aYIzEzqc28Tug7Tv8Ym0M', 'actions': [{'action_id': 'refresh_data', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897598.560991'}]}
2025-07-30 20:46:38,701 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:46:38,703 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:46:38,704 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:46:39,648 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:46:39,662 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:40,291 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:46:41,276 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:48:46,985 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:48:46,986 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:48:49,254 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:48:49,268 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:48:49,279 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:48:49,291 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:48:49,380 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:48:49,381 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:49:09,561 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753897749', 'text': ''}
2025-07-30 20:49:09,565 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:09] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:49:15,490 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:49:15,491 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897750.022489', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294485543953.9212409550592.fe47b97cb1eab1275aa300a85a241f73', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753897750.022489', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294485533377/PgmpNFXfzULgjtES2wjXYo3T', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753897755.396636'}]}
2025-07-30 20:49:15,496 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:49:15,496 - app.handlers.command_handler - INFO - handle_list_sheets_action:131 - Handling list sheets action
2025-07-30 20:49:15,497 - app.handlers.command_handler - INFO - handle_list_sheets_action:135 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:49:16,740 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:16,742 - app.handlers.command_handler - INFO - fetch_and_send_sheets:155 - Fetching available sheets...
2025-07-30 20:49:16,743 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:49:20,417 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:49:20,419 - app.handlers.command_handler - INFO - fetch_and_send_sheets:157 - Found 1 sheets
2025-07-30 20:49:20,420 - app.handlers.command_handler - INFO - fetch_and_send_sheets:170 - Formatting sheets list...
2025-07-30 20:49:20,421 - app.handlers.command_handler - INFO - fetch_and_send_sheets:172 - Formatted 3 blocks
2025-07-30 20:49:20,422 - app.handlers.command_handler - INFO - fetch_and_send_sheets:174 - Posting message to channel...
2025-07-30 20:49:21,642 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:21,645 - app.handlers.command_handler - INFO - fetch_and_send_sheets:181 - List sheets action completed successfully
2025-07-30 20:49:25,502 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:49:25,509 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897761.690059', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301535747840.9212409550592.deaa5f24aaff19cd74407e1e72a109de', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897761.690059', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301535724480/KopWRMlKuFmPfglCvarCgoAd', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753897765.324735'}]}
2025-07-30 20:49:25,534 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:49:25,540 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:209 - Handling get data sheet action
2025-07-30 20:49:25,545 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:214 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:49:26,478 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:26,480 - app.handlers.command_handler - INFO - fetch_and_send_data:234 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:49:26,481 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:49:29,804 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:49:29,806 - app.handlers.command_handler - INFO - fetch_and_send_data:236 - Retrieved 5 rows of data
2025-07-30 20:49:29,807 - app.handlers.command_handler - INFO - fetch_and_send_data:247 - Formatting data blocks...
2025-07-30 20:49:29,808 - app.handlers.command_handler - INFO - fetch_and_send_data:249 - Formatted 8 blocks
2025-07-30 20:49:30,756 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:30,759 - app.handlers.command_handler - INFO - fetch_and_send_data:257 - Get data action completed successfully
2025-07-30 20:50:08,147 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:08,148 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280675414500.9212409550592.743e3d01aa6f6b08e308d9d3ce79c519', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280675395252/FL3t5Ar4bZ1lKDLxOCVvkLEo', 'actions': [{'action_id': 'export_data', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897808.000315'}]}
2025-07-30 20:50:08,169 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:50:08,173 - app.handlers.command_handler - INFO - handle_export_data_action:385 - Handling export data action
2025-07-30 20:50:08,175 - app.handlers.command_handler - INFO - handle_export_data_action:395 - Exporting data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:50:09,080 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:50:09,113 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:09] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:50:10,007 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:50:35,295 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:35,297 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294493774561.9212409550592.4f51973bc2fa7fc0440b811f0e590ec1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294493698609/W4q6MAkrqDC0HVmnSSdd2Q9b', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897835.169758'}]}
2025-07-30 20:50:35,303 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:50:35,304 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:50:35,305 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:50:36,617 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9294493774561.9212409550592.4f51973bc2fa7fc0440b811f0e590ec1
2025-07-30 20:50:36,625 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:50:51,525 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:51,535 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275354556051.9212409550592.173d3d436d301cf63c2986f39f86d305', 'view': {'id': 'V097S58JANT', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Completed'}}}}, 'hash': '1753897836.ZzWkbVv3', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097S58JANT', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:50:51,618 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:50:51,636 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:50:51,671 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:50:51,687 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: B, Value: Completed
2025-07-30 20:50:53,033 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range B2
2025-07-30 20:50:53,926 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:50:53,933 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:53] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:51:00,360 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:51:00,361 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277770487045.9212409550592.6e22020886fb69bc95e662273e684d09', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277770482037/RsWr32WyBSNcRH3p0TzD9BDE', 'actions': [{'action_id': 'refresh_data', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897860.209818'}]}
2025-07-30 20:51:00,457 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:51:00,463 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:51:00,464 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:51:01,463 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:51:01,495 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:51:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:51:02,473 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:51:03,373 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:57:29,021 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:57:29,022 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:57:30,640 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:57:30,651 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:57:30,658 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:57:30,679 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:57:30,740 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:57:30,742 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:57:56,901 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:57:56,902 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897863.415549', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276255850918.9212409550592.1f71afc3761a35df45edde95485c5844', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897863.415549', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aGnsH', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'MkaJf'}, {'type': 'section', 'block_id': 'daGmz', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': '/qxhF', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'cLOai', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': '7Z9Xv', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': '7qaA9', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'oi6v9', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276255824598/pLIrNWOfbeJ3l0Zmo628zow5', 'actions': [{'action_id': 'export_data', 'block_id': 'oi6v9', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898276.782113'}]}
2025-07-30 20:57:56,923 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:57:56,924 - app.handlers.command_handler - INFO - handle_export_data_action:385 - Handling export data action
2025-07-30 20:57:56,950 - app.handlers.command_handler - INFO - handle_export_data_action:395 - Exporting data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:57:58,014 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:57:58,022 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:57:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:58:06,450 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:58:07,101 - app.services.google_service - INFO - export_sheet_to_csv:583 - Exported 5 rows to CSV: C:\Users\dell\AppData\Local\Temp\tmpvrs8qbp4.csv
2025-07-30 20:58:08,146 - app.services.slack_service - ERROR - upload_file:824 - Slack API error uploading file: The request to the Slack API failed. (url: https://www.slack.com/api/files.upload)
The server responded with: {'ok': False, 'error': 'method_deprecated'}
2025-07-30 20:58:09,694 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:01:50,650 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:01:50,652 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:01:52,855 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:01:52,876 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:01:52,887 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 21:01:52,926 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:01:53,005 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:01:53,007 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:02:20,278 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753898540', 'text': ''}
2025-07-30 21:02:20,280 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:20] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:02:26,722 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:26,725 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898540.742969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275430982355.9212409550592.95a087100ec1849f17cda01bd7cec2e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753898540.742969', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275430969651/KAMEwTLSgmkpHg6Rc4VNI0j6', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753898546.619546'}]}
2025-07-30 21:02:26,810 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:26,821 - app.handlers.command_handler - INFO - handle_list_sheets_action:130 - Handling list sheets action
2025-07-30 21:02:26,829 - app.handlers.command_handler - INFO - handle_list_sheets_action:134 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:02:28,022 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:28,025 - app.handlers.command_handler - INFO - fetch_and_send_sheets:154 - Fetching available sheets...
2025-07-30 21:02:28,027 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:02:33,102 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 21:02:33,105 - app.handlers.command_handler - INFO - fetch_and_send_sheets:156 - Found 1 sheets
2025-07-30 21:02:33,106 - app.handlers.command_handler - INFO - fetch_and_send_sheets:169 - Formatting sheets list...
2025-07-30 21:02:33,107 - app.handlers.command_handler - INFO - fetch_and_send_sheets:171 - Formatted 3 blocks
2025-07-30 21:02:33,108 - app.handlers.command_handler - INFO - fetch_and_send_sheets:173 - Posting message to channel...
2025-07-30 21:02:34,029 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:34,034 - app.handlers.command_handler - INFO - fetch_and_send_sheets:180 - List sheets action completed successfully
2025-07-30 21:02:37,834 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:37,836 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898554.031069', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276291376598.9212409550592.b6a7ca5342997d8c24d77f012c641796', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898554.031069', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276291350182/XFG8fBvIZTyLbB71YgvNdaKh', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753898557.721738'}]}
2025-07-30 21:02:37,877 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:37,881 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Handling get data sheet action
2025-07-30 21:02:37,901 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:213 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 21:02:40,234 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:40,245 - app.handlers.command_handler - INFO - fetch_and_send_data:233 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:02:40,246 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:02:43,101 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:02:43,104 - app.handlers.command_handler - INFO - fetch_and_send_data:235 - Retrieved 5 rows of data
2025-07-30 21:02:43,106 - app.handlers.command_handler - INFO - fetch_and_send_data:246 - Formatting data blocks...
2025-07-30 21:02:43,108 - app.handlers.command_handler - INFO - fetch_and_send_data:248 - Formatted 8 blocks
2025-07-30 21:02:44,071 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:44,075 - app.handlers.command_handler - INFO - fetch_and_send_data:256 - Get data action completed successfully
2025-07-30 21:02:53,114 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:53,118 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898564.089719', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264256462855.9212409550592.1804d596ccb83727da7b8b578ed874af', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898564.089719', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSySu', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'yoP9/'}, {'type': 'section', 'block_id': 'mA/79', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'ez84V', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'Ns5Xj', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'LIN9L', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'jRfYt', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Yz0gx', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264256459239/9h1CMcGPZ3TLbeHcRpvX3lDN', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'Yz0gx', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898572.377466'}]}
2025-07-30 21:02:53,161 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:53,164 - app.handlers.command_handler - INFO - handle_open_update_modal_action:353 - Handling open update modal action
2025-07-30 21:02:53,166 - app.handlers.command_handler - INFO - handle_open_update_modal_action:363 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:02:54,119 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264256462855.9212409550592.1804d596ccb83727da7b8b578ed874af
2025-07-30 21:02:54,125 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:54] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:08,754 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:03:08,760 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277844023845.9212409550592.8f96d87fa7d1d50f05fd11eb4f392e26', 'view': {'id': 'V09848LH970', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '3'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Completed'}}}}, 'hash': '1753898574.593bSkkD', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09848LH970', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:03:08,816 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 21:03:08,819 - app.handlers.command_handler - INFO - handle_view_submission:386 - Modal submission received
2025-07-30 21:03:08,821 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:405 - Handling write data modal submission
2025-07-30 21:03:08,822 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:418 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 3, Col: B, Value: Completed
2025-07-30 21:03:10,334 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range B3
2025-07-30 21:03:11,213 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:03:11,217 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:03:11] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:28,864 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:03:28,865 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898564.089719', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277846760373.9212409550592.a4aa9862ce251beb0c1e30275933eff0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898564.089719', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSySu', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'yoP9/'}, {'type': 'section', 'block_id': 'mA/79', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'ez84V', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'Ns5Xj', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'LIN9L', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'jRfYt', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Yz0gx', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277846738245/qjjFp5ai9auAPHfsIwHipSu9', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Yz0gx', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898607.593042'}]}
2025-07-30 21:03:28,869 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:03:28,870 - app.handlers.command_handler - INFO - handle_refresh_data_action:284 - Handling refresh data action
2025-07-30 21:03:28,870 - app.handlers.command_handler - INFO - handle_refresh_data_action:294 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:03:29,968 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:03:29,987 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:03:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:30,990 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:03:31,896 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:21:29,711 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:21:29,712 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:22:32,489 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:22:32,489 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:22:34,284 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,003 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,020 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,027 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:22:38,055 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:22:38,111 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:22:38,113 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:23:11,681 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753899791', 'text': ''}
2025-07-30 21:23:11,682 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:11] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:23:18,562 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:23:18,562 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899792.118729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294687279105.9212409550592.45e6564cb57aca4e93edb78d1c5bc7b5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753899792.118729', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294687266529/uq8VFHhQ8dMHnLPRhEVnOy2z', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753899798.386395'}]}
2025-07-30 21:23:18,572 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:23:18,580 - app.handlers.command_handler - INFO - handle_list_sheets_action:220 - Handling list sheets action
2025-07-30 21:23:18,580 - app.handlers.command_handler - INFO - handle_list_sheets_action:224 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:23:18,735 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:23:23,837 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:23,839 - app.handlers.command_handler - INFO - fetch_and_send_sheets:249 - Fetching available sheets...
2025-07-30 21:23:23,840 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:23:27,364 - app.services.google_service - INFO - list_available_sheets:666 - Found 1 Google Sheets
2025-07-30 21:23:27,365 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Found 1 sheets
2025-07-30 21:23:27,367 - app.handlers.command_handler - INFO - fetch_and_send_sheets:264 - Formatting sheets list...
2025-07-30 21:23:27,369 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatted 3 blocks
2025-07-30 21:23:27,372 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Posting message to channel...
2025-07-30 21:23:28,291 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:28,293 - app.handlers.command_handler - INFO - fetch_and_send_sheets:275 - List sheets action completed successfully
2025-07-30 21:23:38,740 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:23:38,754 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899808.282649', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280869390900.9212409550592.23ef9cdae04bd5ea8482c42a7b7048cd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899808.282649', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280869390804/m7OckOg4ylLeXSQoBCy1paAL', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753899818.604108'}]}
2025-07-30 21:23:38,924 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:23:38,926 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:303 - Handling get data sheet action
2025-07-30 21:23:38,927 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:308 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 21:23:39,085 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:23:43,192 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:43,195 - app.handlers.command_handler - INFO - fetch_and_send_data:333 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:23:43,197 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:23:46,722 - app.services.google_service - INFO - read_sheet_data:229 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:23:46,724 - app.handlers.command_handler - INFO - fetch_and_send_data:335 - Retrieved 5 rows of data
2025-07-30 21:23:46,727 - app.handlers.command_handler - INFO - fetch_and_send_data:346 - Formatting data blocks...
2025-07-30 21:23:46,730 - app.handlers.command_handler - INFO - fetch_and_send_data:348 - Formatted 8 blocks
2025-07-30 21:23:47,787 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:47,790 - app.handlers.command_handler - INFO - fetch_and_send_data:356 - Get data action completed successfully
2025-07-30 21:24:05,235 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:24:05,240 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899827.792959', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264369617623.9212409550592.3f7cb3731a54d55ae8644b6cca463ae8', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899827.792959', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'rBOBQ', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'ArVyK'}, {'type': 'section', 'block_id': 'q05GY', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'bTqBc', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'fKCAF', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'hELUL', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'G02qF', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'b9qbr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264369610167/FBGyp9qd8yDq5axnhCdGzMXL', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'b9qbr', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753899843.838657'}]}
2025-07-30 21:24:05,315 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:24:05,319 - app.handlers.command_handler - INFO - handle_open_update_modal_action:458 - Handling open update modal action
2025-07-30 21:24:05,321 - app.handlers.command_handler - INFO - handle_open_update_modal_action:468 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:24:06,350 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264369617623.9212409550592.3f7cb3731a54d55ae8644b6cca463ae8
2025-07-30 21:24:06,352 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:24:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:24:20,955 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:24:20,960 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9264371407063.9212409550592.535e71a7faa7e60837024026959ab888', 'view': {'id': 'V098VMG4L00', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'D'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'post event'}}}}, 'hash': '1753899846.2EVs7qlg', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098VMG4L00', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:24:21,054 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: view_submission
2025-07-30 21:24:21,059 - app.handlers.command_handler - INFO - handle_view_submission:492 - Modal submission received
2025-07-30 21:24:21,060 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:511 - Handling write data modal submission
2025-07-30 21:24:21,075 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:544 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: D, Value: post event
2025-07-30 21:24:21,186 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:24:25,850 - app.services.google_service - INFO - write_sheet_data:279 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range D2
2025-07-30 21:24:26,953 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:24:26,954 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:24:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:25:45,124 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:25:45,127 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899827.792959', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280880221620.9212409550592.9f09b091e606c3c03d311dba60e1aec4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899827.792959', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'rBOBQ', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'ArVyK'}, {'type': 'section', 'block_id': 'q05GY', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'bTqBc', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'fKCAF', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'hELUL', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'G02qF', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'b9qbr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280880221556/vcQVbOexjrvbpFUYrJBa1xe6', 'actions': [{'action_id': 'refresh_data', 'block_id': 'b9qbr', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753899944.926064'}]}
2025-07-30 21:25:45,182 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:25:45,198 - app.handlers.command_handler - INFO - handle_refresh_data_action:384 - Handling refresh data action
2025-07-30 21:25:45,206 - app.handlers.command_handler - INFO - handle_refresh_data_action:394 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:25:45,377 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:25:50,744 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:25:50,802 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:25:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:25:52,074 - app.services.google_service - INFO - read_sheet_data:229 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:25:53,000 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:29:02,456 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:29:02,458 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899792.118729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301756752576.9212409550592.f2275ecb604f752d3eee3f77971f6f4a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753899792.118729', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301756737408/MB69nGuaoH7yjALFWSzv5Qj6', 'actions': [{'action_id': 'get_data_menu', 'block_id': 'IcoAP', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753900142.284507'}]}
2025-07-30 21:29:02,514 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:29:02,516 - app.handlers.command_handler - INFO - handle_block_actions:208 - Unhandled action: get_data_menu
2025-07-30 21:29:02,525 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:29:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:31:55,448 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:31:55,449 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:31:58,143 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,727 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,747 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,756 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:32:02,841 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:32:03,041 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:32:03,153 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:32:04,463 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753900324', 'text': ''}
2025-07-30 21:32:04,467 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:32:04] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:34:33,288 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:34:33,290 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900324.898829', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294755321921.9212409550592.2671ea9b9c710191cb6d8d384502651e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753900324.898829', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'DtM+m', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '8ol4j'}, {'type': 'section', 'block_id': 'pfbtY', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294755283537/9l2gHnZdZlzLZzt1XznYzc8U', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'pfbtY', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753900473.053010'}]}
2025-07-30 21:34:33,294 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:34:33,295 - app.handlers.command_handler - INFO - handle_list_sheets_action:220 - Handling list sheets action
2025-07-30 21:34:33,296 - app.handlers.command_handler - INFO - handle_list_sheets_action:224 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:34:33,486 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:34:38,833 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:38,835 - app.handlers.command_handler - INFO - fetch_and_send_sheets:249 - Fetching available sheets...
2025-07-30 21:34:38,835 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:34:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:34:42,519 - app.services.google_service - INFO - list_available_sheets:666 - Found 2 Google Sheets
2025-07-30 21:34:42,526 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Found 2 sheets
2025-07-30 21:34:42,536 - app.handlers.command_handler - INFO - fetch_and_send_sheets:264 - Formatting sheets list...
2025-07-30 21:34:42,577 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatted 5 blocks
2025-07-30 21:34:42,588 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Posting message to channel...
2025-07-30 21:34:43,527 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:43,528 - app.handlers.command_handler - INFO - fetch_and_send_sheets:275 - List sheets action completed successfully
2025-07-30 21:34:53,691 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:34:53,694 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900483.647229', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264429614423.9212409550592.1a59d3bb97e653cc939e6bc44211e76d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753900483.647229', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'JAGf5', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'Zwe4S'}, {'type': 'section', 'block_id': 'B65wb', 'text': {'type': 'mrkdwn', 'text': '*1. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': '23t9y'}, {'type': 'section', 'block_id': 'Y+nqa', 'text': {'type': 'mrkdwn', 'text': '*2. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264429601047/n88Su1FMrxAOukNlbje2abn9', 'actions': [{'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'block_id': 'B65wb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'type': 'button', 'action_ts': '1753900493.427563'}]}
2025-07-30 21:34:53,722 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:34:53,723 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:303 - Handling get data sheet action
2025-07-30 21:34:53,725 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:308 - Channel ID: D0981PKFR8T, Sheet ID: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, User ID: U0968C1G72L
2025-07-30 21:34:53,803 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:34:57,899 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:57,902 - app.handlers.command_handler - INFO - fetch_and_send_data:333 - Fetching data from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-30 21:34:57,904 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:34:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:35:00,251 - app.services.google_service - INFO - read_sheet_data:229 - Read 2 rows from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-30 21:35:00,254 - app.handlers.command_handler - INFO - fetch_and_send_data:335 - Retrieved 2 rows of data
2025-07-30 21:35:00,255 - app.handlers.command_handler - INFO - fetch_and_send_data:346 - Formatting data blocks...
2025-07-30 21:35:00,258 - app.handlers.command_handler - INFO - fetch_and_send_data:348 - Formatted 5 blocks
2025-07-30 21:35:01,162 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:35:01,164 - app.handlers.command_handler - INFO - fetch_and_send_data:356 - Get data action completed successfully
2025-07-30 21:35:11,012 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:35:11,021 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900501.301459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280939098548.9212409550592.b164abef929f91c4d2a4f1ff13a444a4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753900501.301459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'S+cb4', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'AKZjE'}, {'type': 'section', 'block_id': 'qkLtA', 'text': {'type': 'mrkdwn', 'text': '*`Name | Age | Class`*', 'verbatim': False}}, {'type': 'section', 'block_id': '4oXhT', 'text': {'type': 'plain_text', 'text': 'Million | 11 | 1A', 'emoji': True}}, {'type': 'actions', 'block_id': 'DpChN', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280939049892/6iAcesyAySUaZ8QbDevGNo9H', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'DpChN', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}', 'type': 'button', 'action_ts': '1753900510.844804'}]}
2025-07-30 21:35:11,042 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:35:11,044 - app.handlers.command_handler - INFO - handle_open_update_modal_action:458 - Handling open update modal action
2025-07-30 21:35:11,045 - app.handlers.command_handler - INFO - handle_open_update_modal_action:468 - Opening update modal for source: sheet, params: {'sheet_id': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}
2025-07-30 21:35:12,046 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280939098548.9212409550592.b164abef929f91c4d2a4f1ff13a444a4
2025-07-30 21:35:12,074 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:35:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:35:34,839 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:35:34,844 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275625025507.9212409550592.8f047db580a0d3965d89238bda42bf73', 'view': {'id': 'V0984DZ1SR4', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'mulugeta'}}}}, 'hash': '1753900512.8rriODOu', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0984DZ1SR4', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:35:34,867 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: view_submission
2025-07-30 21:35:34,868 - app.handlers.command_handler - INFO - handle_view_submission:492 - Modal submission received
2025-07-30 21:35:34,869 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:511 - Handling write data modal submission
2025-07-30 21:35:34,870 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:544 - Modal values - Sheet ID: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, Row: 2, Col: A, Value: mulugeta
2025-07-30 21:35:34,972 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:35:39,258 - app.services.google_service - INFO - write_sheet_data:279 - Wrote data to sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0 at range A2
2025-07-30 21:35:40,230 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:35:40,231 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:35:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:51:46,410 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:51:46,411 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:51:48,525 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,691 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,772 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,776 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:53:31,377 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:53:31,378 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:53:34,311 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,751 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,763 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,767 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:53:37,794 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:53:37,986 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:53:37,987 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:53:51,074 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901630', 'text': ''}
2025-07-30 21:53:51,075 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:53:51] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:53:56,508 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:53:56,509 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901631.432289', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9278108121925.9212409550592.0ac27a05bc522baabe5e39b4f61bdab4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901631.432289', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9278108117909/dfyw1FYCl0zaIEHXmqbkyrXh', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901636.223142'}]}
2025-07-30 21:53:56,517 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:53:56,518 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:53:56,518 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9278108121925.9212409550592.0ac27a05bc522baabe5e39b4f61bdab4
2025-07-30 21:53:56,608 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:54:00,923 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:54:00,958 - app.handlers.command_handler - ERROR - handle_create_sheet_action:328 - Error handling create sheet action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 323, in handle_create_sheet_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:54:01,205 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:54:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:55:22,566 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:55:22,567 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:55:23,771 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,038 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,048 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,052 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:55:29,080 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:55:29,113 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:55:29,115 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:55:39,460 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901739', 'text': ''}
2025-07-30 21:55:39,540 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:45,923 - app.services.google_service - INFO - list_available_sheets:666 - Found 2 Google Sheets
2025-07-30 21:55:45,924 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:55:45] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:55:56,218 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901755', 'text': ''}
2025-07-30 21:55:56,219 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:55:56] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:56:08,851 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:56:08,852 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276586116182.9212409550592.a50ea795ae9c823033f37f4555c11a46', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276586026726/AZhMxYVt4ZqcGCjOG7YQR9uy', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901767.984224'}]}
2025-07-30 21:56:08,856 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:56:08,856 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:56:08,857 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9276586116182.9212409550592.a50ea795ae9c823033f37f4555c11a46
2025-07-30 21:56:26,122 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:56:26,124 - app.handlers.command_handler - ERROR - handle_create_sheet_action:321 - Error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:56:28,477 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:56:28,479 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:56:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:58:55,571 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:58:55,572 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:58:56,473 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,283 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,291 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,294 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:59:00,309 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:59:00,325 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:59:00,328 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:59:05,800 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:59:05,833 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294888925025/rvKxub30uIEF7JZki9u9WVIP', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901944.929015'}]}
2025-07-30 21:59:05,886 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:59:05,909 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:59:05,918 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25
2025-07-30 21:59:07,083 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25
2025-07-30 21:59:07,084 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:59:07] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:59:36,596 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:59:36,597 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279969351826.9212409550592.ac8f32a474d15ceadb289bcf22d1409d', 'view': {'id': 'V0983N6SW91', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'slack3'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753901946.z4vmVrCx', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0983N6SW91', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:59:36,606 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-30 21:59:36,607 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-30 21:59:36,613 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-30 21:59:36,616 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: slack3, Template: inventory
2025-07-30 21:59:36,703 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:44,013 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-30 21:59:44,013 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 21:59:44,014 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 21:59:44,016 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:59:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 22:50:52,048 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 22:50:52,049 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 22:50:54,491 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,961 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,979 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,987 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 22:50:58,022 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 22:50:58,093 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 22:50:58,094 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 22:51:30,150 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 22:51:30,153 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281345047540/R7ofgHoGfmKNZjz0WKcerlMQ', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753905089.551821'}]}
2025-07-30 22:51:30,160 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 22:51:30,160 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 22:51:30,161 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af
2025-07-30 22:51:31,840 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af
2025-07-30 22:51:32,098 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 22:51:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 22:51:48,340 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 22:51:48,341 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9276047240771.9212409550592.886fb866f735a7df11812b5d8e9e4e05', 'view': {'id': 'V0989A4HQ68', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'abc'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753905091.cQKrXTed', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0989A4HQ68', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 22:51:48,352 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-30 22:51:48,354 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-30 22:51:48,355 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-30 22:51:48,356 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: abc, Template: inventory
2025-07-30 22:51:48,545 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:51:56,718 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-30 22:51:56,725 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 22:51:56,743 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 22:51:56,749 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 22:51:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:14:31,671 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 07:14:31,674 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 07:14:41,389 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,473 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,529 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,547 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 07:14:48,594 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 07:14:48,859 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 07:14:48,886 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 07:25:57,823 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:25:58,419 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9278763776774.9212409550592.6841bf82f183d480333a43cadb00b635', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9278763754118/fRjc1L3MfVuaRbeGQjZqmiuw', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753935954.974910'}]}
2025-07-31 07:25:58,422 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:25:58,423 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:25:58,424 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9278763776774.9212409550592.6841bf82f183d480333a43cadb00b635
2025-07-31 07:26:01,845 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-31 07:26:02,020 - app.handlers.command_handler - ERROR - handle_create_sheet_action:321 - Error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-31 07:26:04,341 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 07:26:04,952 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:04] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:26:43,980 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753936004', 'text': ''}
2025-07-31 07:26:44,025 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:44] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 07:26:51,281 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:26:51,294 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753936005.123549', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753936005.123549', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283150596484/qREbmSdj25FWZzpgD7vpoctt', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753936011.325925'}]}
2025-07-31 07:26:51,316 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:26:51,316 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:26:51,317 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b
2025-07-31 07:26:52,303 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b
2025-07-31 07:26:52,337 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:27:12,405 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:27:12,413 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277977301315.9212409550592.d8a656fba3bdc01d8d42d7d7f113128c', 'view': {'id': 'V098B4FD17W', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opil'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753936012.nBbgFkrP', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098B4FD17W', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 07:27:12,435 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 07:27:12,452 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 07:27:12,470 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 07:27:12,472 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opil, Template: inventory
2025-07-31 07:27:13,772 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:27:31,610 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 07:27:31,682 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:27:31,684 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:27:31,688 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:27:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:55:49,306 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 07:55:49,308 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 07:55:54,996 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,689 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,759 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,763 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 07:55:58,777 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 07:55:58,913 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 07:55:58,914 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 07:57:52,156 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753937872', 'text': ''}
2025-07-31 07:57:52,165 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:57:52] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 07:57:56,229 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:57:56,230 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753937872.899629', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753937872.899629', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9303994596096/yy5Y9gTYNbBSIUwfCPlTj88O', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753937876.384222'}]}
2025-07-31 07:57:56,246 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:57:56,254 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:57:56,257 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39
2025-07-31 07:57:57,454 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39
2025-07-31 07:57:57,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:57:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:58:09,552 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:58:09,553 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9297142563969.9212409550592.cda48835f1bcc76a4820e040adc182dd', 'view': {'id': 'V09886R8Z9B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opi'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753937877.Fw1EyhZX', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09886R8Z9B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 07:58:09,637 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 07:58:09,638 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 07:58:09,653 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 07:58:09,654 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opi, Template: task_tracker
2025-07-31 07:58:09,832 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:58:16,851 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 07:58:16,854 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:58:16,947 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:58:16,954 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:58:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 08:07:32,187 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 08:07:32,190 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 08:07:37,886 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,781 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,798 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,802 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 08:07:43,820 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 08:07:43,885 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 08:07:43,887 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 08:08:12,132 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753938491', 'text': ''}
2025-07-31 08:08:12,136 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:12] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 08:08:16,939 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 08:08:16,941 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753938492.791599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753938492.791599', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280266012245/QymvHwQK5Dzj1uMz7PGMNBtR', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753938497.086612'}]}
2025-07-31 08:08:16,956 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 08:08:16,957 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 08:08:16,958 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c
2025-07-31 08:08:17,988 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c
2025-07-31 08:08:17,991 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 08:08:30,548 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 08:08:30,550 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9304030568608.9212409550592.5af9b4659ad33a5f7a69d8111dd2876f', 'view': {'id': 'V09887TSZ1B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opn'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753938498.dZhmvgh9', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09887TSZ1B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 08:08:30,601 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 08:08:30,602 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 08:08:30,604 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 08:08:30,605 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opn, Template: task_tracker
2025-07-31 08:08:30,865 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:08:39,525 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 08:08:39,526 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 08:08:39,535 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 08:08:39,543 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:13:46,671 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:13:46,673 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:13:48,306 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:13:48,314 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:13:48,327 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:13:48,337 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:13:48,358 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:13:48,445 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:13:48,445 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:14:10,866 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:14:10,866 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283511670708.9212409550592.9847713017d6e24fdc4b8431dd001bca', 'view': {'id': 'V09887TSZ1B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opn'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753938498.dZhmvgh9', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09887TSZ1B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:14:10,869 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:14:10,869 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:14:10,870 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 09:14:10,870 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opn, Template: task_tracker
2025-07-31 09:14:11,087 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:14:17,273 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU at range A1
2025-07-31 09:14:19,599 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: opn (ID: 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU)
2025-07-31 09:14:20,474 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:14:20,477 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:14:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:14:51,538 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:14:51,539 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753938492.791599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282293222818.9212409550592.194f60a42f6d4a8f4ea159fc5914412a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753938492.791599', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282293216674/z5yKP6Fs6nRDBAnBwjgyb6fC', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '9DgNb', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753942491.238232'}]}
2025-07-31 09:14:51,548 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:14:51,549 - app.handlers.command_handler - INFO - handle_list_sheets_action:222 - Handling list sheets action
2025-07-31 09:14:51,550 - app.handlers.command_handler - INFO - handle_list_sheets_action:226 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-31 09:14:51,607 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:14:55,555 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:14:55,557 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Fetching available sheets...
2025-07-31 09:14:55,558 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:14:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:14:56,126 - app.services.google_service - INFO - list_available_sheets:740 - Found 7 Google Sheets
2025-07-31 09:14:56,127 - app.handlers.command_handler - INFO - fetch_and_send_sheets:253 - Found 7 sheets
2025-07-31 09:14:56,127 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatting sheets list...
2025-07-31 09:14:56,128 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Formatted 15 blocks
2025-07-31 09:14:56,128 - app.handlers.command_handler - INFO - fetch_and_send_sheets:270 - Posting message to channel...
2025-07-31 09:14:57,322 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:14:57,322 - app.handlers.command_handler - INFO - fetch_and_send_sheets:277 - List sheets action completed successfully
2025-07-31 09:21:23,427 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:21:23,428 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:21:24,438 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:21:24,445 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:21:24,458 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:21:24,483 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:21:24,505 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:21:24,588 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:21:24,591 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:21:42,365 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753942902', 'text': ''}
2025-07-31 09:21:42,367 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:21:42] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:21:48,487 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:21:48,488 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753942902.805869', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279165562406.9212409550592.821b3033518d50924615115f18d39838', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753942902.805869', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279165544214/zAVLgHGia6uzC0ggZr3z3HmL', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753942908.160951'}]}
2025-07-31 09:21:48,495 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:21:48,496 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:21:48,500 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9279165562406.9212409550592.821b3033518d50924615115f18d39838
2025-07-31 09:21:49,536 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279165562406.9212409550592.821b3033518d50924615115f18d39838
2025-07-31 09:21:49,537 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:21:49] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:22:02,966 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:22:02,967 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9282319926162.9212409550592.678e594fcb402f1d95288af014732a51', 'view': {'id': 'V097V2W4Q4X', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'projects'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753942909.NpZpO5tx', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V2W4Q4X', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:22:02,977 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:22:02,978 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:22:02,979 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:689 - Handling create sheet modal submission
2025-07-31 09:22:02,980 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:697 - Modal values - Title: projects, Template: task_tracker
2025-07-31 09:22:03,122 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:22:09,133 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE at range A1
2025-07-31 09:22:11,598 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: projects (ID: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE)
2025-07-31 09:22:12,385 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:22:12,389 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:22:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:19,476 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:28:19,476 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:28:23,386 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:28:23,402 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:23,418 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:23,450 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:28:23,486 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:28:23,585 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:28:23,586 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:28:36,051 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753943315', 'text': ''}
2025-07-31 09:28:36,054 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:36] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:28:41,241 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:28:41,243 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943316.444899', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943316.444899', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267125220327/z9r9tqmbl1wLpBK570iIqTJr', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943320.878256'}]}
2025-07-31 09:28:41,246 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:28:41,247 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:28:41,248 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258
2025-07-31 09:28:42,150 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258
2025-07-31 09:28:42,152 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:53,082 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:28:53,083 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9267126025287.9212409550592.18acd3f847a8b601811e9ae8b4ef6ae5', 'view': {'id': 'V097V3NQEB1', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'uuuuuu'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}}}}}, 'hash': '1753943322.xllTaieS', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V3NQEB1', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:28:53,088 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:28:53,089 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:28:53,089 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:706 - Handling create sheet modal submission
2025-07-31 09:28:53,090 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:714 - Modal values - Title: uuuuuu, Template: empty
2025-07-31 09:28:53,188 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:56,291 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:57,987 - app.services.google_service - ERROR - create_new_sheet:406 - Error creating new sheet: <HttpError 503 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The service is currently unavailable.". Details: "The service is currently unavailable.">
2025-07-31 09:28:57,988 - app.handlers.command_handler - ERROR - create_sheet_async:753 - Error in async sheet creation: <HttpError 503 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The service is currently unavailable.". Details: "The service is currently unavailable.">
2025-07-31 09:28:58,761 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:31:51,081 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:31:51,082 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:31:52,825 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:31:52,831 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:31:52,842 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:31:52,849 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:31:52,874 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:31:52,942 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:31:52,943 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:32:46,467 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753943565', 'text': ''}
2025-07-31 09:32:46,472 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:32:46] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:32:51,548 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:32:51,549 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943566.872559', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943566.872559', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267144642199/1W5pwdgEmJBguGkCFJFAkukr', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943571.282061'}]}
2025-07-31 09:32:51,557 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:32:51,560 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:32:51,565 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482
2025-07-31 09:32:52,460 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482
2025-07-31 09:32:52,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:32:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:01,326 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:01,327 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280554826197.9212409550592.09ecb857a646e8c7b9903ce869c2c39d', 'view': {'id': 'V098RE8AJKB', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'mmm'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753943572.nxhFdlBo', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098RE8AJKB', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:33:01,333 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:33:01,336 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:33:01,338 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:705 - Handling create sheet modal submission
2025-07-31 09:33:01,339 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:713 - Modal values - Title: mmm, Template: task_tracker
2025-07-31 09:33:01,340 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:01,407 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:07,732 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0 at range A1
2025-07-31 09:33:10,152 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: mmm (ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0)
2025-07-31 09:33:10,914 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:33:21,652 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:21,653 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943566.872559', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280556931973.9212409550592.5e772fb717f2ecbc4195cecfc7f7f27b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943566.872559', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280556931925/HBawJhh4aToiWfHt47oHd4jr', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '9DgNb', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943601.350782'}]}
2025-07-31 09:33:21,657 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:21,657 - app.handlers.command_handler - INFO - handle_list_sheets_action:222 - Handling list sheets action
2025-07-31 09:33:21,658 - app.handlers.command_handler - INFO - handle_list_sheets_action:226 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-31 09:33:21,720 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:25,795 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:25,797 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Fetching available sheets...
2025-07-31 09:33:25,797 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:25,798 - app.services.google_service - INFO - list_available_sheets:734 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 09:33:26,290 - app.services.google_service - INFO - list_available_sheets:746 - Found 5 Google Sheets in folder
2025-07-31 09:33:26,291 - app.handlers.command_handler - INFO - fetch_and_send_sheets:253 - Found 5 sheets
2025-07-31 09:33:26,292 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatting sheets list...
2025-07-31 09:33:26,292 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Formatted 11 blocks
2025-07-31 09:33:26,293 - app.handlers.command_handler - INFO - fetch_and_send_sheets:270 - Posting message to channel...
2025-07-31 09:33:27,090 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:27,090 - app.handlers.command_handler - INFO - fetch_and_send_sheets:277 - List sheets action completed successfully
2025-07-31 09:33:39,650 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:39,651 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943607.112189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304316608864.9212409550592.328ef8ee5428429a7ede7dc2532f3f17', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943607.112189', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304316595920/rZUxTHJRrTegsFmf4O8MvaoF', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': '+GPZw', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753943619.329956'}]}
2025-07-31 09:33:39,658 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:39,658 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:341 - Handling get data sheet action
2025-07-31 09:33:39,659 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:346 - Channel ID: D0981PKFR8T, Sheet ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, User ID: U0968C1G72L
2025-07-31 09:33:39,729 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:43,695 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:43,696 - app.handlers.command_handler - INFO - fetch_and_send_data:371 - Fetching data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:33:43,697 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:44,293 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:33:44,294 - app.handlers.command_handler - INFO - fetch_and_send_data:373 - Retrieved 2 rows of data
2025-07-31 09:33:44,295 - app.handlers.command_handler - INFO - fetch_and_send_data:384 - Formatting data blocks...
2025-07-31 09:33:44,295 - app.handlers.command_handler - INFO - fetch_and_send_data:386 - Formatted 5 blocks
2025-07-31 09:33:45,150 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:45,151 - app.handlers.command_handler - INFO - fetch_and_send_data:394 - Get data action completed successfully
2025-07-31 09:33:49,782 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:49,785 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943625.171159', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282366742146.9212409550592.3c23b381941a2614d8d6ebfc3a08a184', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943625.171159', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'JX+wz', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'VRYyf'}, {'type': 'section', 'block_id': 'mPIdx', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'N0V82', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'riLNK', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282366736866/nxCmllM7PDcIGOZWFaxaoZMB', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'riLNK', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753943629.210429'}]}
2025-07-31 09:33:49,800 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:49,801 - app.handlers.command_handler - INFO - handle_open_update_modal_action:496 - Handling open update modal action
2025-07-31 09:33:49,801 - app.handlers.command_handler - INFO - handle_open_update_modal_action:506 - Opening update modal for source: sheet, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 09:33:50,683 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9282366742146.9212409550592.3c23b381941a2614d8d6ebfc3a08a184
2025-07-31 09:33:50,685 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:06,204 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:34:06,205 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9304317998448.9212409550592.e3fd0c123d2fe423b9f9d101f70c46ae', 'view': {'id': 'V097V4DT955', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'new'}}}}, 'hash': '1753943630.89vQbthh', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V4DT955', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:34:06,217 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:34:06,217 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:34:06,218 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:551 - Handling write data modal submission
2025-07-31 09:34:06,219 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:584 - Modal values - Sheet ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, Row: 1, Col: A, Value: new
2025-07-31 09:34:06,220 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:34:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:06,293 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:34:09,694 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0 at range A1
2025-07-31 09:34:10,562 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:34:15,574 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:34:15,575 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943625.171159', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279217744230.9212409550592.313c4456123841f7566e6b6217cb6595', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943625.171159', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'JX+wz', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'VRYyf'}, {'type': 'section', 'block_id': 'mPIdx', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'N0V82', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'riLNK', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279217744134/zgLu6nRfH5tzyxXsuioZTuGU', 'actions': [{'action_id': 'refresh_data', 'block_id': 'riLNK', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753943655.462366'}]}
2025-07-31 09:34:15,590 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:34:15,603 - app.handlers.command_handler - INFO - handle_refresh_data_action:422 - Handling refresh data action
2025-07-31 09:34:15,606 - app.handlers.command_handler - INFO - handle_refresh_data_action:432 - Refreshing data for source: sheet, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 09:34:15,691 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:34:19,460 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:34:19,480 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:34:19] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:19,919 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:34:20,684 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:57:45,678 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:57:45,679 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:57:48,305 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:57:48,305 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 10:42:06,843 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 10:42:06,850 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 10:42:08,607 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 10:42:08,607 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
