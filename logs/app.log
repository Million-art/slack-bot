2025-07-30 16:45:28,421 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 16:45:28,422 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 16:45:29,954 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:45:29,998 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:45:30,039 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 16:47:02,428 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 16:47:02,429 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 16:47:03,531 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:47:03,540 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 16:47:03,544 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 16:47:03,561 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 16:47:03,628 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 16:47:03,632 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:05:58,483 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:05:58,484 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:05:59,874 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:05:59,887 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:05:59,892 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:05:59,900 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:05:59,987 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:05:59,990 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:13:18,649 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:13:18] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:17:51,508 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:17:51,509 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:17:52,575 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:17:52,585 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:17:52,594 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:17:52,601 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:17:52,665 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:17:52,667 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:18:21,172 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:21] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:18:57,349 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:57] "[33mGET /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:18:58,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:18:58] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-07-30 17:19:14,821 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:19:14,822 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:19:15,639 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:19:15,649 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:19:15,654 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:19:15,660 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:19:15,726 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:19:15,727 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:19:36,995 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:19:36] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:19:58,547 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:19:58] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:21:05,586 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:21:05] "[33mPOST /slac/command HTTP/1.1[0m" 404 -
2025-07-30 17:23:23,021 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:23:23] "[33mPOST /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:23:40,253 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:23:40,254 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:23:41,694 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:23:41,707 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:23:41,713 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:23:41,738 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:23:41,816 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:23:41,822 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:24:06,666 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:24:06] "[33mPOST /slack/command HTTP/1.1[0m" 404 -
2025-07-30 17:26:38,518 - app.core.auth - WARNING - verify_slack_request:61 - Invalid Slack signature from 127.0.0.1
2025-07-30 17:26:38,518 - app.core.auth - WARNING - decorated_function:107 - Invalid request signature from 127.0.0.1
2025-07-30 17:26:38,521 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:26:38] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 403 -
2025-07-30 17:28:14,147 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:28:14,148 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:28:15,138 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:28:15,148 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:28:15,153 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:28:15,170 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:28:15,238 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:28:15,244 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:28:25,228 - app.core.auth - WARNING - check_user_permission:89 - Unauthorized access attempt by user: U0968C1G72L
2025-07-30 17:28:25,229 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:28:25] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 403 -
2025-07-30 17:29:59,555 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:29:59,555 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:30:00,410 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:00,418 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:00,423 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:30:00,444 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:30:00,494 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:30:00,496 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:30:08,104 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885808', 'text': ''}
2025-07-30 17:30:08,105 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:30:08,120 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:30:08,124 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:30:08] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:30:27,069 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:30:27,070 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:30:27,852 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:27,860 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:30:27,864 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:30:27,879 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:30:28,022 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:30:28,038 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:30:32,023 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885832', 'text': ''}
2025-07-30 17:30:32,024 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:30:32,038 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:30:32,041 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:30:32] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:32:34,580 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:32:34,581 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:32:35,517 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:32:35,525 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:32:35,529 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:32:35,542 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:32:35,593 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:32:35,598 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:32:40,251 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753885960', 'text': ''}
2025-07-30 17:32:40,253 - main - ERROR - log_exception:1414 - Exception on /api/slack/command [POST]
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1487, in full_dispatch_request
    return self.finalize_request(rv)
           ~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1506, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\flask\app.py", line 1851, in make_response
    rv.status_code = status
    ^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 149, in status_code
    self.status = code  # type: ignore
    ^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 158, in status
    self._status, self._status_code = self._clean_status(value)
                                      ~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\werkzeug\sansio\response.py", line 164, in _clean_status
    value = value.strip()
            ^^^^^^^^^^^
AttributeError: 'Response' object has no attribute 'strip'
2025-07-30 17:32:40,348 - main - ERROR - internal_error:57 - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-07-30 17:32:40,402 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:32:40] "[35m[1mPOST /api/slack/command HTTP/1.1[0m" 500 -
2025-07-30 17:34:01,607 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:34:01,608 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:34:02,420 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:34:02,429 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:34:02,434 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:34:02,445 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:34:02,499 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:34:02,503 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:34:08,567 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886049', 'text': ''}
2025-07-30 17:34:08,569 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:34:08] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 17:35:06,284 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:35:06,286 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:35:07,167 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:35:07,176 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:35:07,181 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:35:07,201 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:35:07,295 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:35:07,311 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:35:19,185 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886119', 'text': ''}
2025-07-30 17:35:19,186 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:35:19] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 17:41:56,676 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 17:41:56,677 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 17:41:57,940 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:41:57,981 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 17:41:58,005 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 17:41:58,012 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 17:41:58,095 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 17:41:58,096 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 17:43:07,953 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/getdata', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753886588', 'text': ''}
2025-07-30 17:43:12,041 - app.services.google_service - ERROR - read_sheet_data:91 - Error reading sheet data: <HttpError 404 when requesting https://sheets.googleapis.com/v4/spreadsheets/your-sheet-id/values/A1%3AB10?alt=json returned "Requested entity was not found.". Details: "Requested entity was not found.">
2025-07-30 17:43:12,068 - app.handlers.command_handler - ERROR - handle_get_sheet_data:139 - Error getting sheet data: <HttpError 404 when requesting https://sheets.googleapis.com/v4/spreadsheets/your-sheet-id/values/A1%3AB10?alt=json returned "Requested entity was not found.". Details: "Requested entity was not found.">
2025-07-30 17:43:12,082 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 17:43:12] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:03:34,112 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:03:34,130 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:03:43,454 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:03:43,471 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:03:43,491 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:03:43,518 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:03:43,737 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:03:43,738 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:08:43,198 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:08:43,199 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:08:47,057 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:08:47,072 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:08:47,079 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:08:47,106 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:08:47,235 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:08:47,235 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:12:05,109 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/getdata', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753891924', 'text': 'source=sheet sheet_id=1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c range=A1:B10'}
2025-07-30 19:12:16,403 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 19:12:18,962 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 19:12:19,032 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:12:19] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:31:06,412 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893066', 'text': ''}
2025-07-30 19:31:06,446 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:31:06] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:31:59,308 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893114', 'text': ''}
2025-07-30 19:31:59,310 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:31:59] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:32:22,844 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:32:22,845 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:32:24,382 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:32:24,392 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:32:24,397 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:32:24,417 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:32:24,496 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:32:24,503 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:32:31,931 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893152', 'text': ''}
2025-07-30 19:32:35,200 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:32:35,202 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:32:35] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:33:35,477 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893214', 'text': ''}
2025-07-30 19:33:36,322 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:33:36,323 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:33:36] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:39:24,546 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:39:24,547 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:39:25,840 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,854 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,862 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:39:25,983 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,994 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:39:25,998 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:39:26,013 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:39:26,085 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:39:26,087 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:40:37,405 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753893637', 'text': ''}
2025-07-30 19:40:37,407 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:40:37] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:46:40,708 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:46:40,709 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:46:41,563 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,572 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,576 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:46:41,663 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,671 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:46:41,675 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:46:41,702 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:46:41,746 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:46:41,748 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:47:18,388 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894038', 'text': ''}
2025-07-30 19:47:18,390 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:47:18] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:47:25,752 - app.core.auth - WARNING - decorated_function:120 - No user ID found in request
2025-07-30 19:47:25,753 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:47:25] "[31m[1mPOST /api/slack/command HTTP/1.1[0m" 400 -
2025-07-30 19:49:13,349 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:49:13,350 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:49:14,358 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,366 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,371 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:49:14,444 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,453 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:49:14,457 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:49:14,475 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:49:14,512 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:49:14,513 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:49:25,595 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:25] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:49:35,983 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894176', 'text': ''}
2025-07-30 19:49:35,988 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:35] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:49:41,701 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:49:41] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:50:16,207 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894216', 'text': ''}
2025-07-30 19:50:16,210 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:50:16] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:50:23,007 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:50:23] "[33mPOST /api/interactions/command HTTP/1.1[0m" 404 -
2025-07-30 19:55:03,585 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:55:03,594 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:55:13,281 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:55:13,308 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:55:13,322 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:55:13,361 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:55:13,679 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:55:13,680 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:55:56,081 - app.core.auth - INFO - log_request:154 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894556', 'text': ''}
2025-07-30 19:55:56,088 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:55:56] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:56:04,112 - app.core.auth - WARNING - decorated_function:120 - No user ID found in request
2025-07-30 19:56:04,113 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:56:04] "[31m[1mPOST /api/interactions/command HTTP/1.1[0m" 400 -
2025-07-30 19:58:07,815 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 19:58:07,820 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 19:58:12,700 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:58:12,717 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 19:58:12,725 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 19:58:12,761 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 19:58:12,969 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 19:58:12,970 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 19:58:23,358 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894702', 'text': ''}
2025-07-30 19:58:23,367 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:58:23] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 19:58:28,644 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 19:58:28,647 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753894704.078049', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277471746325.9212409550592.0a60e5456c1fb4e3f5d9e591b5d60bcb', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753894704.078049', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277471729813/Jx8V6metVuZQSGVdYYnJEFQf', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753894708.141303'}]}
2025-07-30 19:58:29,161 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 19:58:29,161 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 19:58:29,162 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 19:58:29,162 - app.handlers.command_handler - INFO - handle_list_sheets_action:136 - Fetching available sheets...
2025-07-30 19:58:34,801 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 19:58:34,802 - app.handlers.command_handler - INFO - handle_list_sheets_action:138 - Found 1 sheets
2025-07-30 19:58:34,803 - app.handlers.command_handler - INFO - handle_list_sheets_action:151 - Formatting sheets list...
2025-07-30 19:58:34,803 - app.handlers.command_handler - INFO - handle_list_sheets_action:153 - Formatted 3 blocks
2025-07-30 19:58:34,804 - app.handlers.command_handler - INFO - handle_list_sheets_action:155 - Posting message to channel...
2025-07-30 19:58:36,012 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 19:58:36,012 - app.handlers.command_handler - INFO - handle_list_sheets_action:162 - List sheets action completed successfully
2025-07-30 19:58:36,013 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 19:58:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:02:00,274 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:02:00,278 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:02:07,514 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:02:07,552 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:02:07,584 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:02:07,605 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:02:07,854 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:02:07,914 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:02:20,877 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753894940', 'text': ''}
2025-07-30 20:02:20,880 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:02:20] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:02:26,143 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:02:26,144 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753894941.509449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294208476657.9212409550592.377de2b55b4017c1df3439ce92c68d41', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753894941.509449', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294208321313/EnAxFDdQBUMaOTv9D8YD8NNv', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753894946.165926'}]}
2025-07-30 20:02:26,148 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:02:26,149 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:02:26,149 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:02:27,901 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:02:27,903 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:02:27,903 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:02:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:02:31,437 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:02:31,438 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:02:31,439 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:02:31,440 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:02:31,440 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:02:32,368 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:02:32,369 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:07:07,698 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:07:07,699 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:07:09,028 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:07:09,045 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:07:09,055 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:07:09,092 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:07:09,147 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:07:09,149 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:07:31,758 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753895251', 'text': ''}
2025-07-30 20:07:31,760 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:31] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:07:37,319 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:07:37,320 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895252.373069', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275098243555.9212409550592.71bb8a885b1672e70f3fee635863f9ca', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753895252.373069', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275098243427/VWgLUWAheoLNvRgGJPMvMo0Z', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753895257.310051'}]}
2025-07-30 20:07:37,370 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:07:37,377 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:07:37,378 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:07:38,425 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:38,427 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:07:38,428 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:07:42,241 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:07:42,242 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:07:42,242 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:07:42,243 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:07:42,243 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:07:43,106 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:43,107 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:07:49,155 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:07:49,156 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895263.292229', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9263941303415.9212409550592.e82b48d3318848face711a1d9dbd7abf', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895263.292229', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9263941228455/iFRFuZFS7Vrm31MdGDgax4VX', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753895269.135856'}]}
2025-07-30 20:07:49,158 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:07:49,159 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:203 - Handling get data sheet action
2025-07-30 20:07:49,159 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:07:52,404 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:52,406 - app.handlers.command_handler - INFO - fetch_and_send_data:228 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:07:52,407 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:07:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:07:55,903 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:07:55,904 - app.handlers.command_handler - INFO - fetch_and_send_data:230 - Retrieved 5 rows of data
2025-07-30 20:07:55,905 - app.handlers.command_handler - INFO - fetch_and_send_data:241 - Formatting data blocks...
2025-07-30 20:07:55,906 - app.handlers.command_handler - INFO - fetch_and_send_data:243 - Formatted 8 blocks
2025-07-30 20:07:56,796 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:07:56,797 - app.handlers.command_handler - INFO - fetch_and_send_data:251 - Get data action completed successfully
2025-07-30 20:08:17,205 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:08:17,206 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895276.965449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275101939763.9212409550592.c73ada03e6e6bffdeae9e256805f1f47', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895276.965449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '+67YS', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'xJ3wb'}, {'type': 'section', 'block_id': 'nVv+k', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'JoEPs', 'text': {'type': 'plain_text', 'text': ' | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'i9yRV', 'text': {'type': 'plain_text', 'text': ' | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'HFs0G', 'text': {'type': 'plain_text', 'text': ' | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'csu+2', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'aoUWc', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275101935523/7X3aX6xiHWdgUJExwcjJV7um', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aoUWc', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895297.248717'}]}
2025-07-30 20:08:17,211 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:08:17,212 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:08:17,213 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:08:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:27,739 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:09:27,740 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895276.965449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275979972326.9212409550592.e96de9a7866f2c8279fbe86bdc715ad3', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895276.965449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '+67YS', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'xJ3wb'}, {'type': 'section', 'block_id': 'nVv+k', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'JoEPs', 'text': {'type': 'plain_text', 'text': ' | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'i9yRV', 'text': {'type': 'plain_text', 'text': ' | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'HFs0G', 'text': {'type': 'plain_text', 'text': ' | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'csu+2', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'aoUWc', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275979971302/Ycib0F7vIxjScMayJLqa0kcp', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aoUWc', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895367.782622'}]}
2025-07-30 20:09:27,744 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:09:27,745 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:09:27,746 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:51,913 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753895391', 'text': ''}
2025-07-30 20:09:51,915 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:51] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:09:57,499 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:09:57,500 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895392.520929', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9263953247511.9212409550592.31b771418e25dfaad40f6265c25d643b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753895392.520929', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9263953222263/Sux0IaIup9gSslCeJeTJwPEi', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753895397.543983'}]}
2025-07-30 20:09:57,531 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:09:57,531 - app.handlers.command_handler - INFO - handle_list_sheets_action:125 - Handling list sheets action
2025-07-30 20:09:57,532 - app.handlers.command_handler - INFO - handle_list_sheets_action:129 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:09:58,480 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:09:58,481 - app.handlers.command_handler - INFO - fetch_and_send_sheets:149 - Fetching available sheets...
2025-07-30 20:09:58,482 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:09:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:09:59,202 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:09:59,203 - app.handlers.command_handler - INFO - fetch_and_send_sheets:151 - Found 1 sheets
2025-07-30 20:09:59,204 - app.handlers.command_handler - INFO - fetch_and_send_sheets:164 - Formatting sheets list...
2025-07-30 20:09:59,205 - app.handlers.command_handler - INFO - fetch_and_send_sheets:166 - Formatted 3 blocks
2025-07-30 20:09:59,206 - app.handlers.command_handler - INFO - fetch_and_send_sheets:168 - Posting message to channel...
2025-07-30 20:10:00,101 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:00,102 - app.handlers.command_handler - INFO - fetch_and_send_sheets:175 - List sheets action completed successfully
2025-07-30 20:10:05,051 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:10:05,052 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895400.265109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294256981649.9212409550592.1affaa5f9236689eca039e407824f6d6', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895400.265109', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294256903601/agxP161q6xWDSnu4kpK28lbO', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753895404.992812'}]}
2025-07-30 20:10:05,054 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:10:05,055 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:203 - Handling get data sheet action
2025-07-30 20:10:05,055 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:10:05,996 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:05,998 - app.handlers.command_handler - INFO - fetch_and_send_data:228 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:10:05,999 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:10:05] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:10:07,250 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:10:07,251 - app.handlers.command_handler - INFO - fetch_and_send_data:230 - Retrieved 5 rows of data
2025-07-30 20:10:07,251 - app.handlers.command_handler - INFO - fetch_and_send_data:241 - Formatting data blocks...
2025-07-30 20:10:07,252 - app.handlers.command_handler - INFO - fetch_and_send_data:243 - Formatted 8 blocks
2025-07-30 20:10:08,235 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:10:08,236 - app.handlers.command_handler - INFO - fetch_and_send_data:251 - Get data action completed successfully
2025-07-30 20:10:57,611 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:10:57,611 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753895408.406139', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275117862019.9212409550592.e201dbe0c4501164e5a11eee425ad1e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753895408.406139', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'KCNMq', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qOr3x'}, {'type': 'section', 'block_id': 'yZLXs', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '/Rn4y', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'x6w5M', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'V3AGu', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'icBjk', 'text': {'type': 'plain_text', 'text': ' | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Bn8q/', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275117810979/uODzAKhVR6ZWlOMxEVjgbYhA', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Bn8q/', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753895457.624243'}]}
2025-07-30 20:10:57,616 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:10:57,616 - app.handlers.command_handler - INFO - handle_block_actions:113 - Unhandled action: refresh_data
2025-07-30 20:10:57,620 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:10:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:08,795 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:30:08,796 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:30:14,487 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:30:14,710 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:30:14,794 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:30:14,809 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:30:14,957 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:30:14,958 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:30:25,254 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753896625', 'text': ''}
2025-07-30 20:30:25,258 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:25] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:30:30,655 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:30,658 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896625.804969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279490980386.9212409550592.2642590d22cb3392b54b190474194374', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753896625.804969', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279490948050/zxQrXPpOwN85UaFidmZDzMVE', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753896630.353252'}]}
2025-07-30 20:30:30,665 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:30,665 - app.handlers.command_handler - INFO - handle_list_sheets_action:131 - Handling list sheets action
2025-07-30 20:30:30,666 - app.handlers.command_handler - INFO - handle_list_sheets_action:135 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:30:31,912 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:31,914 - app.handlers.command_handler - INFO - fetch_and_send_sheets:155 - Fetching available sheets...
2025-07-30 20:30:31,915 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:36,356 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:30:36,357 - app.handlers.command_handler - INFO - fetch_and_send_sheets:157 - Found 1 sheets
2025-07-30 20:30:36,358 - app.handlers.command_handler - INFO - fetch_and_send_sheets:170 - Formatting sheets list...
2025-07-30 20:30:36,358 - app.handlers.command_handler - INFO - fetch_and_send_sheets:172 - Formatted 3 blocks
2025-07-30 20:30:36,359 - app.handlers.command_handler - INFO - fetch_and_send_sheets:174 - Posting message to channel...
2025-07-30 20:30:37,221 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:37,222 - app.handlers.command_handler - INFO - fetch_and_send_sheets:181 - List sheets action completed successfully
2025-07-30 20:30:40,694 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:40,696 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896637.313829', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279492419890.9212409550592.bdfd57bb17b565adbfe6871698043bcd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896637.313829', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279492419730/sCQOGG3oxGToulgvAcZbrkUU', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753896640.640498'}]}
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:209 - Handling get data sheet action
2025-07-30 20:30:40,701 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:214 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:30:42,555 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:42,558 - app.handlers.command_handler - INFO - fetch_and_send_data:234 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:42,559 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:45,716 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:45,717 - app.handlers.command_handler - INFO - fetch_and_send_data:236 - Retrieved 5 rows of data
2025-07-30 20:30:45,717 - app.handlers.command_handler - INFO - fetch_and_send_data:247 - Formatting data blocks...
2025-07-30 20:30:45,718 - app.handlers.command_handler - INFO - fetch_and_send_data:249 - Formatted 8 blocks
2025-07-30 20:30:46,729 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:46,729 - app.handlers.command_handler - INFO - fetch_and_send_data:257 - Get data action completed successfully
2025-07-30 20:30:50,265 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:30:50,269 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896646.820599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275237634563.9212409550592.a794058ee174c0902c7f58785b08f05d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896646.820599', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275237633923/JTSxZthr4PBSANhjXOAQWWzp', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896650.219271'}]}
2025-07-30 20:30:50,272 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:30:50,273 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:30:50,274 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:30:51,169 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:30:51,185 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:30:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:30:52,181 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:30:53,196 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:25,111 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:31:25,113 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896653.272379', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277667059477.9212409550592.67c5d3141d1c0a1597d47d0d6a346266', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896653.272379', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277667057061/cOpPopGHCzvBusyCm0X7UKHO', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896685.067842'}]}
2025-07-30 20:31:25,117 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:31:25,117 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:31:25,120 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:31:26,071 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:26,101 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:31:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:31:27,323 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:31:28,199 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:31:38,809 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:31:38,810 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896688.293779', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301441638960.9212409550592.75306552e37f7600d452010b5d05460a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896688.293779', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301441638848/xryJrQYBTAih5YL0atLXNpZG', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753896698.762568'}]}
2025-07-30 20:31:38,822 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:31:38,822 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:31:38,828 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:31:39,837 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9301441638960.9212409550592.75306552e37f7600d452010b5d05460a
2025-07-30 20:31:39,839 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:31:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:32:13,331 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:32:13,345 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277671637989.9212409550592.ea672b1ee8a2145765d676f540ca60fe', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:32:13,347 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:32:13,354 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:32:13,355 - app.handlers.command_handler - INFO - handle_view_submission:460 - Unknown modal callback_id: write_sheet_data_modal
2025-07-30 20:32:13,362 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:32:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:33:14,790 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:33:14,792 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:33:18,239 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:33:18,252 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:33:18,260 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:33:18,282 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:33:18,398 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:33:18,399 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:33:51,373 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:33:51,375 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279511359602.9212409550592.f276e9190f52cc7b38fb5559ede4e1f9', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:33:51,378 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:33:51,378 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:33:51,379 - app.handlers.command_handler - INFO - handle_view_submission:460 - Unknown modal callback_id: write_sheet_data_modal
2025-07-30 20:33:51,388 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:33:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:39:08,471 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:39:08,478 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:39:11,462 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:39:11,481 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:39:11,491 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:39:11,524 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:39:11,652 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:39:11,656 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:39:29,241 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:39:29,243 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9294431344881.9212409550592.0af449bc5af065803afe9d8075860f7e', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:39:29,248 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:39:29,249 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:39:29,249 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:39:29,250 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: 1, Value: website
2025-07-30 20:39:29,251 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: 11
2025-07-30 20:39:29,257 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:527 - Error handling write data modal submission: Invalid range format: 11
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 510, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: 11
2025-07-30 20:39:29,287 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:39:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:39:59,558 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:39:59,559 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279543116562.9212409550592.c6d393498704bc655b8bf8fe24edb4cb', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:39:59,573 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:39:59,574 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:39:59,574 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:39:59,575 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: 1, Value: website
2025-07-30 20:39:59,584 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: 12
2025-07-30 20:39:59,585 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:527 - Error handling write data modal submission: Invalid range format: 12
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 510, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: 12
2025-07-30 20:39:59,603 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:39:59] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:43:33,754 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:43:33,755 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:43:37,148 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:43:37,161 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:43:37,168 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:43:37,196 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:43:37,281 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:43:37,285 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:44:03,716 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:03,718 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275314945731.9212409550592.6abc7ea3b5db4df1509ddaf0bc6119f1', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:03,725 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:03,729 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:03,730 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:03,732 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: 1, Value: website
2025-07-30 20:44:09,244 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A1
2025-07-30 20:44:10,712 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:44:10,719 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:10] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:14,542 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:14,543 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9276179008726.9212409550592.700c050b7183e5c7f064d2e7fb032b9d', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': 'a'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:14,551 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:14,552 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:14,552 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:14,553 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: a, Col: 1, Value: website
2025-07-30 20:44:14,554 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:14] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:23,485 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:23,489 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275316995363.9212409550592.5c30fb5ddaa74b5d60ab166ed3f4e1dd', 'view': {'id': 'V0987EP9ZEE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': '1'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'website'}}}}, 'hash': '1753896699.szfv5x3R', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987EP9ZEE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:44:23,573 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:44:23,581 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:44:23,586 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:44:23,605 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: 1, Value: website
2025-07-30 20:44:24,670 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A2
2025-07-30 20:44:25,566 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:44:25,568 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:36,684 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:36,685 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753896688.293779', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280644621092.9212409550592.f6f6b09a4d272713958f4f577b450d19', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753896688.293779', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'dzcAg', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Fb19U'}, {'type': 'section', 'block_id': '2PwtB', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': '9Fa4v', 'text': {'type': 'plain_text', 'text': 'web | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'DDIR8', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'e4E4v', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': '+0HYl', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'zikMi', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280644617652/u6DdXiEqPETVLtKUFMffO27s', 'actions': [{'action_id': 'refresh_data', 'block_id': 'zikMi', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897476.580033'}]}
2025-07-30 20:44:36,693 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:44:36,695 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:44:36,696 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:44:37,570 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:44:37,617 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:44:38,785 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:44:39,778 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:44:47,209 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:44:47,296 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897479.847799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280643560980.9212409550592.e77453338f557e19156b1fb59cc13154', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897479.847799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSCmb', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'PgJpK'}, {'type': 'section', 'block_id': 'K777D', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'CpS4G', 'text': {'type': 'plain_text', 'text': 'website | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'tZF8d', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'pudql', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'h/AJU', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'YPaUd', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280643554756/Kt3Ry4evqUCYri0yBpKRRjht', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'YPaUd', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897486.669948'}]}
2025-07-30 20:44:47,376 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:44:47,381 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:44:47,433 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:44:48,428 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280643560980.9212409550592.e77453338f557e19156b1fb59cc13154
2025-07-30 20:44:48,430 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:44:48] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:09,614 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:09,616 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9301512574880.9212409550592.bf064f6ed93467f676fb0c05af938b6a', 'view': {'id': 'V0985MFS7QD', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Mobile'}}}}, 'hash': '1753897488.TzDhtWPe', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0985MFS7QD', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:45:09,642 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:45:09,647 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:45:09,648 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:45:09,658 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: A, Value: Mobile
2025-07-30 20:45:10,797 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A2
2025-07-30 20:45:11,943 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:45:11,959 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:11] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:20,357 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:20,362 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897479.847799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275322960563.9212409550592.a05b3f9f3e25d9cbc522e5aa4b9086d1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897479.847799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSCmb', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'PgJpK'}, {'type': 'section', 'block_id': 'K777D', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'CpS4G', 'text': {'type': 'plain_text', 'text': 'website | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'tZF8d', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': 'pudql', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'h/AJU', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'YPaUd', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275322954675/ijjG7THNJwRLO9BUNoUqbMIK', 'actions': [{'action_id': 'refresh_data', 'block_id': 'YPaUd', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897520.058584'}]}
2025-07-30 20:45:20,442 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:45:20,451 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:45:20,453 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:45:21,589 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:45:21,608 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:21] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:22,600 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:45:23,538 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:45:38,206 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:38,211 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279571885970.9212409550592.7680172e4edfc5fe9ce2bee4b5ad2329', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279571773106/RhpUpHCOPHxIBfK2dVtSc9Rt', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897538.064843'}]}
2025-07-30 20:45:38,239 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:45:38,240 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:45:38,248 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:45:39,163 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279571885970.9212409550592.7680172e4edfc5fe9ce2bee4b5ad2329
2025-07-30 20:45:39,167 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:45:55,621 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:45:55,622 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9294467896433.9212409550592.cac96e9419d70b3813c64ddf29a4ad66', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'a'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:45:55,633 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:45:55,634 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:45:55,636 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:45:55,637 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: a, Value: Tasks
2025-07-30 20:45:55,638 - app.services.google_service - ERROR - write_sheet_data:140 - Error writing sheet data: Invalid range format: a1
2025-07-30 20:45:55,640 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:545 - Error handling write data modal submission: Invalid range format: a1
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 528, in handle_write_data_modal_submission
    google_service.write_sheet_data(sheet_id, range_name, value=value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 117, in write_sheet_data
    self._validate_range(range_name)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\google_service.py", line 459, in _validate_range
    raise ValueError(f"Invalid range format: {range_name}")
ValueError: Invalid range format: a1
2025-07-30 20:45:55,659 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:45:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:06,323 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:06,331 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277745261109.9212409550592.d82cecac61454d3e4b460fd28f013a7d', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': 'a1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'a'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:46:06,351 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:46:06,356 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:46:06,374 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:46:06,374 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: a1, Col: a, Value: Tasks
2025-07-30 20:46:06,377 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:17,151 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:17,153 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9301519140976.9212409550592.cf9be3fefb62be11d538c157b5ac7454', 'view': {'id': 'V0988K56BHS', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Tasks'}}}}, 'hash': '1753897539.7CNAre0y', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988K56BHS', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:46:17,171 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:46:17,171 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:46:17,181 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:46:17,183 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: A, Value: Tasks
2025-07-30 20:46:18,283 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A1
2025-07-30 20:46:22,232 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:46:22,238 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:22] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:31,288 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:31,290 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264156991959.9212409550592.abaaf4a4484de62e6ad00d3817b90c50', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264156913191/eBYJsG4k5Me89jPFMp1eaLAI', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897590.942709'}]}
2025-07-30 20:46:31,307 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:46:31,309 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:46:31,310 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:46:32,279 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264156991959.9212409550592.abaaf4a4484de62e6ad00d3817b90c50
2025-07-30 20:46:32,282 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:38,680 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:46:38,681 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897523.593539', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279577596546.9212409550592.ebe1ec606bfbeccb510e822995407e4f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897523.593539', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'z889s', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'Gj0BS'}, {'type': 'section', 'block_id': 'uXR26', 'text': {'type': 'mrkdwn', 'text': '*`website | Status`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Hgv4O', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started', 'emoji': True}}, {'type': 'section', 'block_id': 'u65ZE', 'text': {'type': 'plain_text', 'text': 'app | In progress', 'emoji': True}}, {'type': 'section', 'block_id': '719hN', 'text': {'type': 'plain_text', 'text': 'bot | Blocked', 'emoji': True}}, {'type': 'section', 'block_id': 'yjHcC', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'QXtEM', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279577558818/lY2aYIzEzqc28Tug7Tv8Ym0M', 'actions': [{'action_id': 'refresh_data', 'block_id': 'QXtEM', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897598.560991'}]}
2025-07-30 20:46:38,701 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:46:38,703 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:46:38,704 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:46:39,648 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:46:39,662 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:46:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:46:40,291 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:46:41,276 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:48:46,985 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:48:46,986 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:48:49,254 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:48:49,268 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:48:49,279 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:48:49,291 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:48:49,380 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:48:49,381 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:49:09,561 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753897749', 'text': ''}
2025-07-30 20:49:09,565 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:09] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 20:49:15,490 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:49:15,491 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897750.022489', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294485543953.9212409550592.fe47b97cb1eab1275aa300a85a241f73', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753897750.022489', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294485533377/PgmpNFXfzULgjtES2wjXYo3T', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753897755.396636'}]}
2025-07-30 20:49:15,496 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:49:15,496 - app.handlers.command_handler - INFO - handle_list_sheets_action:131 - Handling list sheets action
2025-07-30 20:49:15,497 - app.handlers.command_handler - INFO - handle_list_sheets_action:135 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 20:49:16,740 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:16,742 - app.handlers.command_handler - INFO - fetch_and_send_sheets:155 - Fetching available sheets...
2025-07-30 20:49:16,743 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:49:20,417 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 20:49:20,419 - app.handlers.command_handler - INFO - fetch_and_send_sheets:157 - Found 1 sheets
2025-07-30 20:49:20,420 - app.handlers.command_handler - INFO - fetch_and_send_sheets:170 - Formatting sheets list...
2025-07-30 20:49:20,421 - app.handlers.command_handler - INFO - fetch_and_send_sheets:172 - Formatted 3 blocks
2025-07-30 20:49:20,422 - app.handlers.command_handler - INFO - fetch_and_send_sheets:174 - Posting message to channel...
2025-07-30 20:49:21,642 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:21,645 - app.handlers.command_handler - INFO - fetch_and_send_sheets:181 - List sheets action completed successfully
2025-07-30 20:49:25,502 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:49:25,509 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897761.690059', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301535747840.9212409550592.deaa5f24aaff19cd74407e1e72a109de', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897761.690059', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301535724480/KopWRMlKuFmPfglCvarCgoAd', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753897765.324735'}]}
2025-07-30 20:49:25,534 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:49:25,540 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:209 - Handling get data sheet action
2025-07-30 20:49:25,545 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:214 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 20:49:26,478 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:26,480 - app.handlers.command_handler - INFO - fetch_and_send_data:234 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:49:26,481 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:49:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:49:29,804 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:49:29,806 - app.handlers.command_handler - INFO - fetch_and_send_data:236 - Retrieved 5 rows of data
2025-07-30 20:49:29,807 - app.handlers.command_handler - INFO - fetch_and_send_data:247 - Formatting data blocks...
2025-07-30 20:49:29,808 - app.handlers.command_handler - INFO - fetch_and_send_data:249 - Formatted 8 blocks
2025-07-30 20:49:30,756 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:49:30,759 - app.handlers.command_handler - INFO - fetch_and_send_data:257 - Get data action completed successfully
2025-07-30 20:50:08,147 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:08,148 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280675414500.9212409550592.743e3d01aa6f6b08e308d9d3ce79c519', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280675395252/FL3t5Ar4bZ1lKDLxOCVvkLEo', 'actions': [{'action_id': 'export_data', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897808.000315'}]}
2025-07-30 20:50:08,169 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:50:08,173 - app.handlers.command_handler - INFO - handle_export_data_action:385 - Handling export data action
2025-07-30 20:50:08,175 - app.handlers.command_handler - INFO - handle_export_data_action:395 - Exporting data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:50:09,080 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:50:09,113 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:09] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:50:10,007 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:50:35,295 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:35,297 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294493774561.9212409550592.4f51973bc2fa7fc0440b811f0e590ec1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294493698609/W4q6MAkrqDC0HVmnSSdd2Q9b', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897835.169758'}]}
2025-07-30 20:50:35,303 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:50:35,304 - app.handlers.command_handler - INFO - handle_open_update_modal_action:354 - Handling open update modal action
2025-07-30 20:50:35,305 - app.handlers.command_handler - INFO - handle_open_update_modal_action:364 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:50:36,617 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9294493774561.9212409550592.4f51973bc2fa7fc0440b811f0e590ec1
2025-07-30 20:50:36,625 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:50:51,525 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:50:51,535 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275354556051.9212409550592.173d3d436d301cf63c2986f39f86d305', 'view': {'id': 'V097S58JANT', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Completed'}}}}, 'hash': '1753897836.ZzWkbVv3', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097S58JANT', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 20:50:51,618 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 20:50:51,636 - app.handlers.command_handler - INFO - handle_view_submission:453 - Modal submission received
2025-07-30 20:50:51,671 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:472 - Handling write data modal submission
2025-07-30 20:50:51,687 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:485 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: B, Value: Completed
2025-07-30 20:50:53,033 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range B2
2025-07-30 20:50:53,926 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 20:50:53,933 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:50:53] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:51:00,360 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:51:00,361 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897770.801879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277770487045.9212409550592.6e22020886fb69bc95e662273e684d09', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897770.801879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Nf7n', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'pjH9F'}, {'type': 'section', 'block_id': '5qSzq', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'SH5HX', 'text': {'type': 'plain_text', 'text': 'Mobile | Not started | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'udjwa', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'vA/9n', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'vbQ4M', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'NENvJ', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277770482037/RsWr32WyBSNcRH3p0TzD9BDE', 'actions': [{'action_id': 'refresh_data', 'block_id': 'NENvJ', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753897860.209818'}]}
2025-07-30 20:51:00,457 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:51:00,463 - app.handlers.command_handler - INFO - handle_refresh_data_action:285 - Handling refresh data action
2025-07-30 20:51:00,464 - app.handlers.command_handler - INFO - handle_refresh_data_action:295 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:51:01,463 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:51:01,495 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:51:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:51:02,473 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:51:03,373 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:57:29,021 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 20:57:29,022 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 20:57:30,640 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:57:30,651 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 20:57:30,658 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 20:57:30,679 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 20:57:30,740 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 20:57:30,742 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 20:57:56,901 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 20:57:56,902 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753897863.415549', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276255850918.9212409550592.1f71afc3761a35df45edde95485c5844', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753897863.415549', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Refreshed data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aGnsH', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'MkaJf'}, {'type': 'section', 'block_id': 'daGmz', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': '/qxhF', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'cLOai', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': '7Z9Xv', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': '7qaA9', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'oi6v9', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'export_data', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276255824598/pLIrNWOfbeJ3l0Zmo628zow5', 'actions': [{'action_id': 'export_data', 'block_id': 'oi6v9', 'text': {'type': 'plain_text', 'text': ':bar_chart: Export', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898276.782113'}]}
2025-07-30 20:57:56,923 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 20:57:56,924 - app.handlers.command_handler - INFO - handle_export_data_action:385 - Handling export data action
2025-07-30 20:57:56,950 - app.handlers.command_handler - INFO - handle_export_data_action:395 - Exporting data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 20:57:58,014 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 20:57:58,022 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 20:57:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 20:58:06,450 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 20:58:07,101 - app.services.google_service - INFO - export_sheet_to_csv:583 - Exported 5 rows to CSV: C:\Users\dell\AppData\Local\Temp\tmpvrs8qbp4.csv
2025-07-30 20:58:08,146 - app.services.slack_service - ERROR - upload_file:824 - Slack API error uploading file: The request to the Slack API failed. (url: https://www.slack.com/api/files.upload)
The server responded with: {'ok': False, 'error': 'method_deprecated'}
2025-07-30 20:58:09,694 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:01:50,650 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:01:50,652 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:01:52,855 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:01:52,876 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:01:52,887 - app.services.google_service - INFO - _init_google_clients:54 - Google API clients initialized successfully
2025-07-30 21:01:52,926 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:01:53,005 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:01:53,007 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:02:20,278 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753898540', 'text': ''}
2025-07-30 21:02:20,280 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:20] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:02:26,722 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:26,725 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898540.742969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9275430982355.9212409550592.95a087100ec1849f17cda01bd7cec2e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753898540.742969', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9275430969651/KAMEwTLSgmkpHg6Rc4VNI0j6', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753898546.619546'}]}
2025-07-30 21:02:26,810 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:26,821 - app.handlers.command_handler - INFO - handle_list_sheets_action:130 - Handling list sheets action
2025-07-30 21:02:26,829 - app.handlers.command_handler - INFO - handle_list_sheets_action:134 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:02:28,022 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:28,025 - app.handlers.command_handler - INFO - fetch_and_send_sheets:154 - Fetching available sheets...
2025-07-30 21:02:28,027 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:02:33,102 - app.services.google_service - INFO - list_available_sheets:523 - Found 1 Google Sheets
2025-07-30 21:02:33,105 - app.handlers.command_handler - INFO - fetch_and_send_sheets:156 - Found 1 sheets
2025-07-30 21:02:33,106 - app.handlers.command_handler - INFO - fetch_and_send_sheets:169 - Formatting sheets list...
2025-07-30 21:02:33,107 - app.handlers.command_handler - INFO - fetch_and_send_sheets:171 - Formatted 3 blocks
2025-07-30 21:02:33,108 - app.handlers.command_handler - INFO - fetch_and_send_sheets:173 - Posting message to channel...
2025-07-30 21:02:34,029 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:34,034 - app.handlers.command_handler - INFO - fetch_and_send_sheets:180 - List sheets action completed successfully
2025-07-30 21:02:37,834 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:37,836 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898554.031069', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276291376598.9212409550592.b6a7ca5342997d8c24d77f012c641796', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898554.031069', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276291350182/XFG8fBvIZTyLbB71YgvNdaKh', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753898557.721738'}]}
2025-07-30 21:02:37,877 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:37,881 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:208 - Handling get data sheet action
2025-07-30 21:02:37,901 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:213 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 21:02:40,234 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:40,245 - app.handlers.command_handler - INFO - fetch_and_send_data:233 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:02:40,246 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:02:43,101 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:02:43,104 - app.handlers.command_handler - INFO - fetch_and_send_data:235 - Retrieved 5 rows of data
2025-07-30 21:02:43,106 - app.handlers.command_handler - INFO - fetch_and_send_data:246 - Formatting data blocks...
2025-07-30 21:02:43,108 - app.handlers.command_handler - INFO - fetch_and_send_data:248 - Formatted 8 blocks
2025-07-30 21:02:44,071 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:02:44,075 - app.handlers.command_handler - INFO - fetch_and_send_data:256 - Get data action completed successfully
2025-07-30 21:02:53,114 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:02:53,118 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898564.089719', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264256462855.9212409550592.1804d596ccb83727da7b8b578ed874af', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898564.089719', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSySu', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'yoP9/'}, {'type': 'section', 'block_id': 'mA/79', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'ez84V', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'Ns5Xj', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'LIN9L', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'jRfYt', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Yz0gx', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264256459239/9h1CMcGPZ3TLbeHcRpvX3lDN', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'Yz0gx', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898572.377466'}]}
2025-07-30 21:02:53,161 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:02:53,164 - app.handlers.command_handler - INFO - handle_open_update_modal_action:353 - Handling open update modal action
2025-07-30 21:02:53,166 - app.handlers.command_handler - INFO - handle_open_update_modal_action:363 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:02:54,119 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264256462855.9212409550592.1804d596ccb83727da7b8b578ed874af
2025-07-30 21:02:54,125 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:02:54] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:08,754 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:03:08,760 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277844023845.9212409550592.8f96d87fa7d1d50f05fd11eb4f392e26', 'view': {'id': 'V09848LH970', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '3'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'Completed'}}}}, 'hash': '1753898574.593bSkkD', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09848LH970', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:03:08,816 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: view_submission
2025-07-30 21:03:08,819 - app.handlers.command_handler - INFO - handle_view_submission:386 - Modal submission received
2025-07-30 21:03:08,821 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:405 - Handling write data modal submission
2025-07-30 21:03:08,822 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:418 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 3, Col: B, Value: Completed
2025-07-30 21:03:10,334 - app.services.google_service - INFO - write_sheet_data:136 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range B3
2025-07-30 21:03:11,213 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:03:11,217 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:03:11] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:28,864 - app.handlers.command_handler - INFO - handle_interaction:77 - Interaction received
2025-07-30 21:03:28,865 - app.handlers.command_handler - INFO - handle_interaction:79 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753898564.089719', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9277846760373.9212409550592.a4aa9862ce251beb0c1e30275933eff0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753898564.089719', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'eSySu', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'yoP9/'}, {'type': 'section', 'block_id': 'mA/79', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'ez84V', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'Ns5Xj', 'text': {'type': 'plain_text', 'text': 'app | In progress | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'LIN9L', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'jRfYt', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'Yz0gx', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9277846738245/qjjFp5ai9auAPHfsIwHipSu9', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Yz0gx', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753898607.593042'}]}
2025-07-30 21:03:28,869 - app.handlers.command_handler - INFO - handle_interaction:82 - Interaction type: block_actions
2025-07-30 21:03:28,870 - app.handlers.command_handler - INFO - handle_refresh_data_action:284 - Handling refresh data action
2025-07-30 21:03:28,870 - app.handlers.command_handler - INFO - handle_refresh_data_action:294 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:03:29,968 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:03:29,987 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:03:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:03:30,990 - app.services.google_service - INFO - read_sheet_data:86 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:03:31,896 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:21:29,711 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:21:29,712 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:22:32,489 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:22:32,489 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:22:34,284 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,003 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,020 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:22:38,027 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:22:38,055 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:22:38,111 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:22:38,113 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:23:11,681 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753899791', 'text': ''}
2025-07-30 21:23:11,682 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:11] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:23:18,562 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:23:18,562 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899792.118729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294687279105.9212409550592.45e6564cb57aca4e93edb78d1c5bc7b5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753899792.118729', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294687266529/uq8VFHhQ8dMHnLPRhEVnOy2z', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'fkzLy', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753899798.386395'}]}
2025-07-30 21:23:18,572 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:23:18,580 - app.handlers.command_handler - INFO - handle_list_sheets_action:220 - Handling list sheets action
2025-07-30 21:23:18,580 - app.handlers.command_handler - INFO - handle_list_sheets_action:224 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:23:18,735 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:23:23,837 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:23,839 - app.handlers.command_handler - INFO - fetch_and_send_sheets:249 - Fetching available sheets...
2025-07-30 21:23:23,840 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:23:27,364 - app.services.google_service - INFO - list_available_sheets:666 - Found 1 Google Sheets
2025-07-30 21:23:27,365 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Found 1 sheets
2025-07-30 21:23:27,367 - app.handlers.command_handler - INFO - fetch_and_send_sheets:264 - Formatting sheets list...
2025-07-30 21:23:27,369 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatted 3 blocks
2025-07-30 21:23:27,372 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Posting message to channel...
2025-07-30 21:23:28,291 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:28,293 - app.handlers.command_handler - INFO - fetch_and_send_sheets:275 - List sheets action completed successfully
2025-07-30 21:23:38,740 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:23:38,754 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899808.282649', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280869390900.9212409550592.23ef9cdae04bd5ea8482c42a7b7048cd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899808.282649', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'PH7xy', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '3gqp1'}, {'type': 'section', 'block_id': 'dWN6R', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280869390804/m7OckOg4ylLeXSQoBCy1paAL', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'dWN6R', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753899818.604108'}]}
2025-07-30 21:23:38,924 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:23:38,926 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:303 - Handling get data sheet action
2025-07-30 21:23:38,927 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:308 - Channel ID: D0981PKFR8T, Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, User ID: U0968C1G72L
2025-07-30 21:23:39,085 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:23:43,192 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:43,195 - app.handlers.command_handler - INFO - fetch_and_send_data:333 - Fetching data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:23:43,197 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:23:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:23:46,722 - app.services.google_service - INFO - read_sheet_data:229 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:23:46,724 - app.handlers.command_handler - INFO - fetch_and_send_data:335 - Retrieved 5 rows of data
2025-07-30 21:23:46,727 - app.handlers.command_handler - INFO - fetch_and_send_data:346 - Formatting data blocks...
2025-07-30 21:23:46,730 - app.handlers.command_handler - INFO - fetch_and_send_data:348 - Formatted 8 blocks
2025-07-30 21:23:47,787 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:23:47,790 - app.handlers.command_handler - INFO - fetch_and_send_data:356 - Get data action completed successfully
2025-07-30 21:24:05,235 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:24:05,240 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899827.792959', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264369617623.9212409550592.3f7cb3731a54d55ae8644b6cca463ae8', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899827.792959', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'rBOBQ', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'ArVyK'}, {'type': 'section', 'block_id': 'q05GY', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'bTqBc', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'fKCAF', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'hELUL', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'G02qF', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'b9qbr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264369610167/FBGyp9qd8yDq5axnhCdGzMXL', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'b9qbr', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753899843.838657'}]}
2025-07-30 21:24:05,315 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:24:05,319 - app.handlers.command_handler - INFO - handle_open_update_modal_action:458 - Handling open update modal action
2025-07-30 21:24:05,321 - app.handlers.command_handler - INFO - handle_open_update_modal_action:468 - Opening update modal for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:24:06,350 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9264369617623.9212409550592.3f7cb3731a54d55ae8644b6cca463ae8
2025-07-30 21:24:06,352 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:24:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:24:20,955 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:24:20,960 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9264371407063.9212409550592.535e71a7faa7e60837024026959ab888', 'view': {'id': 'V098VMG4L00', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'D'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'post event'}}}}, 'hash': '1753899846.2EVs7qlg', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098VMG4L00', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:24:21,054 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: view_submission
2025-07-30 21:24:21,059 - app.handlers.command_handler - INFO - handle_view_submission:492 - Modal submission received
2025-07-30 21:24:21,060 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:511 - Handling write data modal submission
2025-07-30 21:24:21,075 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:544 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 2, Col: D, Value: post event
2025-07-30 21:24:21,186 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:24:25,850 - app.services.google_service - INFO - write_sheet_data:279 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range D2
2025-07-30 21:24:26,953 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:24:26,954 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:24:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:25:45,124 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:25:45,127 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899827.792959', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280880221620.9212409550592.9f09b091e606c3c03d311dba60e1aec4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753899827.792959', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'rBOBQ', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'ArVyK'}, {'type': 'section', 'block_id': 'q05GY', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'bTqBc', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | Pre-event', 'emoji': True}}, {'type': 'section', 'block_id': 'fKCAF', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'hELUL', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'G02qF', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'b9qbr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280880221556/vcQVbOexjrvbpFUYrJBa1xe6', 'actions': [{'action_id': 'refresh_data', 'block_id': 'b9qbr', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753899944.926064'}]}
2025-07-30 21:25:45,182 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:25:45,198 - app.handlers.command_handler - INFO - handle_refresh_data_action:384 - Handling refresh data action
2025-07-30 21:25:45,206 - app.handlers.command_handler - INFO - handle_refresh_data_action:394 - Refreshing data for source: sheet, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-30 21:25:45,377 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:25:50,744 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:25:50,802 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:25:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:25:52,074 - app.services.google_service - INFO - read_sheet_data:229 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-30 21:25:53,000 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:29:02,456 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:29:02,458 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753899792.118729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9301756752576.9212409550592.f2275ecb604f752d3eee3f77971f6f4a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753899792.118729', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'za/el', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'C79dR'}, {'type': 'section', 'block_id': 'fkzLy', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'IcoAP', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: Get Data*\nRetrieve information from Google Sheets, CSV, or Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}}}, {'type': 'section', 'block_id': 'HMCyZ', 'text': {'type': 'mrkdwn', 'text': '*:pencil2: Write Data*\nUpdate cells in existing files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'write_data_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Write Data', 'emoji': True}}}, {'type': 'section', 'block_id': '/pQz0', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New File*\nGenerate new files with templates', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_file_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create File', 'emoji': True}}}, {'type': 'section', 'block_id': 'q8jiy', 'text': {'type': 'mrkdwn', 'text': '*:gear: Settings*\nManage your preferences and permissions', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'settings_menu', 'text': {'type': 'plain_text', 'text': 'Settings', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9301756737408/MB69nGuaoH7yjALFWSzv5Qj6', 'actions': [{'action_id': 'get_data_menu', 'block_id': 'IcoAP', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753900142.284507'}]}
2025-07-30 21:29:02,514 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:29:02,516 - app.handlers.command_handler - INFO - handle_block_actions:208 - Unhandled action: get_data_menu
2025-07-30 21:29:02,525 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:29:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:31:55,448 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:31:55,449 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:31:58,143 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,727 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,747 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:32:02,756 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:32:02,841 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:32:03,041 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:32:03,153 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:32:04,463 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753900324', 'text': ''}
2025-07-30 21:32:04,467 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:32:04] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:34:33,288 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:34:33,290 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900324.898829', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294755321921.9212409550592.2671ea9b9c710191cb6d8d384502651e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753900324.898829', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'DtM+m', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '8ol4j'}, {'type': 'section', 'block_id': 'pfbtY', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294755283537/9l2gHnZdZlzLZzt1XznYzc8U', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'pfbtY', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753900473.053010'}]}
2025-07-30 21:34:33,294 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:34:33,295 - app.handlers.command_handler - INFO - handle_list_sheets_action:220 - Handling list sheets action
2025-07-30 21:34:33,296 - app.handlers.command_handler - INFO - handle_list_sheets_action:224 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-30 21:34:33,486 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:34:38,833 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:38,835 - app.handlers.command_handler - INFO - fetch_and_send_sheets:249 - Fetching available sheets...
2025-07-30 21:34:38,835 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:34:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:34:42,519 - app.services.google_service - INFO - list_available_sheets:666 - Found 2 Google Sheets
2025-07-30 21:34:42,526 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Found 2 sheets
2025-07-30 21:34:42,536 - app.handlers.command_handler - INFO - fetch_and_send_sheets:264 - Formatting sheets list...
2025-07-30 21:34:42,577 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatted 5 blocks
2025-07-30 21:34:42,588 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Posting message to channel...
2025-07-30 21:34:43,527 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:43,528 - app.handlers.command_handler - INFO - fetch_and_send_sheets:275 - List sheets action completed successfully
2025-07-30 21:34:53,691 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:34:53,694 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900483.647229', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9264429614423.9212409550592.1a59d3bb97e653cc939e6bc44211e76d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753900483.647229', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'JAGf5', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'Zwe4S'}, {'type': 'section', 'block_id': 'B65wb', 'text': {'type': 'mrkdwn', 'text': '*1. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': '23t9y'}, {'type': 'section', 'block_id': 'Y+nqa', 'text': {'type': 'mrkdwn', 'text': '*2. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9264429601047/n88Su1FMrxAOukNlbje2abn9', 'actions': [{'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'block_id': 'B65wb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'type': 'button', 'action_ts': '1753900493.427563'}]}
2025-07-30 21:34:53,722 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:34:53,723 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:303 - Handling get data sheet action
2025-07-30 21:34:53,725 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:308 - Channel ID: D0981PKFR8T, Sheet ID: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, User ID: U0968C1G72L
2025-07-30 21:34:53,803 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:34:57,899 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:34:57,902 - app.handlers.command_handler - INFO - fetch_and_send_data:333 - Fetching data from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-30 21:34:57,904 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:34:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:35:00,251 - app.services.google_service - INFO - read_sheet_data:229 - Read 2 rows from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-30 21:35:00,254 - app.handlers.command_handler - INFO - fetch_and_send_data:335 - Retrieved 2 rows of data
2025-07-30 21:35:00,255 - app.handlers.command_handler - INFO - fetch_and_send_data:346 - Formatting data blocks...
2025-07-30 21:35:00,258 - app.handlers.command_handler - INFO - fetch_and_send_data:348 - Formatted 5 blocks
2025-07-30 21:35:01,162 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-30 21:35:01,164 - app.handlers.command_handler - INFO - fetch_and_send_data:356 - Get data action completed successfully
2025-07-30 21:35:11,012 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:35:11,021 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753900501.301459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280939098548.9212409550592.b164abef929f91c4d2a4f1ff13a444a4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753900501.301459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'S+cb4', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'AKZjE'}, {'type': 'section', 'block_id': 'qkLtA', 'text': {'type': 'mrkdwn', 'text': '*`Name | Age | Class`*', 'verbatim': False}}, {'type': 'section', 'block_id': '4oXhT', 'text': {'type': 'plain_text', 'text': 'Million | 11 | 1A', 'emoji': True}}, {'type': 'actions', 'block_id': 'DpChN', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280939049892/6iAcesyAySUaZ8QbDevGNo9H', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'DpChN', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}', 'type': 'button', 'action_ts': '1753900510.844804'}]}
2025-07-30 21:35:11,042 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: block_actions
2025-07-30 21:35:11,044 - app.handlers.command_handler - INFO - handle_open_update_modal_action:458 - Handling open update modal action
2025-07-30 21:35:11,045 - app.handlers.command_handler - INFO - handle_open_update_modal_action:468 - Opening update modal for source: sheet, params: {'sheet_id': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}
2025-07-30 21:35:12,046 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280939098548.9212409550592.b164abef929f91c4d2a4f1ff13a444a4
2025-07-30 21:35:12,074 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:35:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:35:34,839 - app.handlers.command_handler - INFO - handle_interaction:167 - Interaction received
2025-07-30 21:35:34,844 - app.handlers.command_handler - INFO - handle_interaction:169 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9275625025507.9212409550592.8f047db580a0d3965d89238bda42bf73', 'view': {'id': 'V0984DZ1SR4', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'mulugeta'}}}}, 'hash': '1753900512.8rriODOu', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0984DZ1SR4', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:35:34,867 - app.handlers.command_handler - INFO - handle_interaction:172 - Interaction type: view_submission
2025-07-30 21:35:34,868 - app.handlers.command_handler - INFO - handle_view_submission:492 - Modal submission received
2025-07-30 21:35:34,869 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:511 - Handling write data modal submission
2025-07-30 21:35:34,870 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:544 - Modal values - Sheet ID: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, Row: 2, Col: A, Value: mulugeta
2025-07-30 21:35:34,972 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:35:39,258 - app.services.google_service - INFO - write_sheet_data:279 - Wrote data to sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0 at range A2
2025-07-30 21:35:40,230 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:35:40,231 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:35:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:51:46,410 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:51:46,411 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:51:48,525 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,691 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,772 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:51:52,776 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:53:31,377 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:53:31,378 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:53:34,311 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,751 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,763 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:53:37,767 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:53:37,794 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:53:37,986 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:53:37,987 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:53:51,074 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901630', 'text': ''}
2025-07-30 21:53:51,075 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:53:51] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:53:56,508 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:53:56,509 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901631.432289', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9278108121925.9212409550592.0ac27a05bc522baabe5e39b4f61bdab4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901631.432289', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9278108117909/dfyw1FYCl0zaIEHXmqbkyrXh', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901636.223142'}]}
2025-07-30 21:53:56,517 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:53:56,518 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:53:56,518 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9278108121925.9212409550592.0ac27a05bc522baabe5e39b4f61bdab4
2025-07-30 21:53:56,608 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:54:00,923 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:54:00,958 - app.handlers.command_handler - ERROR - handle_create_sheet_action:328 - Error handling create sheet action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 323, in handle_create_sheet_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:54:01,205 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:54:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:55:22,566 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:55:22,567 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:55:23,771 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,038 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,048 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:29,052 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:55:29,080 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:55:29,113 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:55:29,115 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:55:39,460 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/sheets', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901739', 'text': ''}
2025-07-30 21:55:39,540 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:55:45,923 - app.services.google_service - INFO - list_available_sheets:666 - Found 2 Google Sheets
2025-07-30 21:55:45,924 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:55:45] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:55:56,218 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753901755', 'text': ''}
2025-07-30 21:55:56,219 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:55:56] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-30 21:56:08,851 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:56:08,852 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9276586116182.9212409550592.a50ea795ae9c823033f37f4555c11a46', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9276586026726/AZhMxYVt4ZqcGCjOG7YQR9uy', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901767.984224'}]}
2025-07-30 21:56:08,856 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:56:08,856 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:56:08,857 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9276586116182.9212409550592.a50ea795ae9c823033f37f4555c11a46
2025-07-30 21:56:26,122 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:56:26,124 - app.handlers.command_handler - ERROR - handle_create_sheet_action:321 - Error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-30 21:56:28,477 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-30 21:56:28,479 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:56:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:58:55,571 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 21:58:55,572 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 21:58:56,473 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,283 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,291 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:00,294 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 21:59:00,309 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 21:59:00,325 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 21:59:00,328 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 21:59:05,800 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:59:05,833 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9294888925025/rvKxub30uIEF7JZki9u9WVIP', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753901944.929015'}]}
2025-07-30 21:59:05,886 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 21:59:05,909 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 21:59:05,918 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25
2025-07-30 21:59:07,083 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9294888952785.9212409550592.e0ff1c60d0ae5ce7ad2a1e96b31f3c25
2025-07-30 21:59:07,084 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:59:07] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 21:59:36,596 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 21:59:36,597 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279969351826.9212409550592.ac8f32a474d15ceadb289bcf22d1409d', 'view': {'id': 'V0983N6SW91', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'slack3'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753901946.z4vmVrCx', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0983N6SW91', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 21:59:36,606 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-30 21:59:36,607 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-30 21:59:36,613 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-30 21:59:36,616 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: slack3, Template: inventory
2025-07-30 21:59:36,703 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 21:59:44,013 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-30 21:59:44,013 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 21:59:44,014 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 21:59:44,016 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 21:59:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 22:50:52,048 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-30 22:50:52,049 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-30 22:50:54,491 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,961 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,979 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:50:57,987 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-30 22:50:58,022 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-30 22:50:58,093 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-30 22:50:58,094 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-30 22:51:30,150 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 22:51:30,153 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281345047540/R7ofgHoGfmKNZjz0WKcerlMQ', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753905089.551821'}]}
2025-07-30 22:51:30,160 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-30 22:51:30,160 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-30 22:51:30,161 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af
2025-07-30 22:51:31,840 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9281345062820.9212409550592.160cf4961433ba6a9ceb9cd83c1840af
2025-07-30 22:51:32,098 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 22:51:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-30 22:51:48,340 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-30 22:51:48,341 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9276047240771.9212409550592.886fb866f735a7df11812b5d8e9e4e05', 'view': {'id': 'V0989A4HQ68', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'abc'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753905091.cQKrXTed', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0989A4HQ68', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-30 22:51:48,352 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-30 22:51:48,354 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-30 22:51:48,355 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-30 22:51:48,356 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: abc, Template: inventory
2025-07-30 22:51:48,545 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-30 22:51:56,718 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-30 22:51:56,725 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 22:51:56,743 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-30 22:51:56,749 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [30/Jul/2025 22:51:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:14:31,671 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 07:14:31,674 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 07:14:41,389 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,473 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,529 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:14:48,547 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 07:14:48,594 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 07:14:48,859 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 07:14:48,886 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 07:25:57,823 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:25:58,419 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753901757.188799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9278763776774.9212409550592.6841bf82f183d480333a43cadb00b635', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753901757.188799', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9278763754118/fRjc1L3MfVuaRbeGQjZqmiuw', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753935954.974910'}]}
2025-07-31 07:25:58,422 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:25:58,423 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:25:58,424 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9278763776774.9212409550592.6841bf82f183d480333a43cadb00b635
2025-07-31 07:26:01,845 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-31 07:26:02,020 - app.handlers.command_handler - ERROR - handle_create_sheet_action:321 - Error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'expired_trigger_id'}
2025-07-31 07:26:04,341 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 07:26:04,952 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:04] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:26:43,980 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753936004', 'text': ''}
2025-07-31 07:26:44,025 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:44] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 07:26:51,281 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:26:51,294 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753936005.123549', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753936005.123549', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283150596484/qREbmSdj25FWZzpgD7vpoctt', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753936011.325925'}]}
2025-07-31 07:26:51,316 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:26:51,316 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:26:51,317 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b
2025-07-31 07:26:52,303 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283150603940.9212409550592.54774314a7da5d2829e7b5273ea7486b
2025-07-31 07:26:52,337 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:26:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:27:12,405 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:27:12,413 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9277977301315.9212409550592.d8a656fba3bdc01d8d42d7d7f113128c', 'view': {'id': 'V098B4FD17W', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opil'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}}}}}, 'hash': '1753936012.nBbgFkrP', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098B4FD17W', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 07:27:12,435 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 07:27:12,452 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 07:27:12,470 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 07:27:12,472 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opil, Template: inventory
2025-07-31 07:27:13,772 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:27:31,610 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 07:27:31,682 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:27:31,684 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:27:31,688 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:27:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:55:49,306 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 07:55:49,308 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 07:55:54,996 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,689 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,759 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:55:58,763 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 07:55:58,777 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 07:55:58,913 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 07:55:58,914 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 07:57:52,156 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753937872', 'text': ''}
2025-07-31 07:57:52,165 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:57:52] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 07:57:56,229 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:57:56,230 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753937872.899629', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753937872.899629', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9303994596096/yy5Y9gTYNbBSIUwfCPlTj88O', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753937876.384222'}]}
2025-07-31 07:57:56,246 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 07:57:56,254 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 07:57:56,257 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39
2025-07-31 07:57:57,454 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9303994682064.9212409550592.f2829633aa420b37d937dcc9847a2d39
2025-07-31 07:57:57,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:57:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 07:58:09,552 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 07:58:09,553 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9297142563969.9212409550592.cda48835f1bcc76a4820e040adc182dd', 'view': {'id': 'V09886R8Z9B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opi'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753937877.Fw1EyhZX', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09886R8Z9B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 07:58:09,637 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 07:58:09,638 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 07:58:09,653 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 07:58:09,654 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opi, Template: task_tracker
2025-07-31 07:58:09,832 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 07:58:16,851 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 07:58:16,854 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:58:16,947 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 07:58:16,954 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 07:58:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 08:07:32,187 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 08:07:32,190 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 08:07:37,886 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,781 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,798 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:07:43,802 - app.services.google_service - INFO - _init_google_clients:197 - Google API clients initialized successfully
2025-07-31 08:07:43,820 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 08:07:43,885 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 08:07:43,887 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 08:08:12,132 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753938491', 'text': ''}
2025-07-31 08:08:12,136 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:12] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 08:08:16,939 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 08:08:16,941 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753938492.791599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753938492.791599', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280266012245/QymvHwQK5Dzj1uMz7PGMNBtR', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753938497.086612'}]}
2025-07-31 08:08:16,956 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 08:08:16,957 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 08:08:16,958 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c
2025-07-31 08:08:17,988 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280266015477.9212409550592.d3378f138e9ee7d156411c75a527f55c
2025-07-31 08:08:17,991 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 08:08:30,548 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 08:08:30,550 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9304030568608.9212409550592.5af9b4659ad33a5f7a69d8111dd2876f', 'view': {'id': 'V09887TSZ1B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opn'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753938498.dZhmvgh9', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09887TSZ1B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 08:08:30,601 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 08:08:30,602 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 08:08:30,604 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 08:08:30,605 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opn, Template: task_tracker
2025-07-31 08:08:30,865 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 08:08:39,525 - googleapiclient.http - WARNING - _should_retry_response:140 - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2025-07-31 08:08:39,526 - app.services.google_service - ERROR - create_new_sheet:332 - Error creating new sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 08:08:39,535 - app.handlers.command_handler - ERROR - handle_create_sheet_modal_submission:732 - Error creating sheet: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The caller does not have permission". Details: "The caller does not have permission">
2025-07-31 08:08:39,543 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 08:08:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:13:46,671 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:13:46,673 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:13:48,306 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:13:48,314 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:13:48,327 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:13:48,337 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:13:48,358 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:13:48,445 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:13:48,445 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:14:10,866 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:14:10,866 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283511670708.9212409550592.9847713017d6e24fdc4b8431dd001bca', 'view': {'id': 'V09887TSZ1B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'opn'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753938498.dZhmvgh9', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09887TSZ1B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:14:10,869 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:14:10,869 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:14:10,870 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:680 - Handling create sheet modal submission
2025-07-31 09:14:10,870 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:688 - Modal values - Title: opn, Template: task_tracker
2025-07-31 09:14:11,087 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:14:17,273 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU at range A1
2025-07-31 09:14:19,599 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: opn (ID: 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU)
2025-07-31 09:14:20,474 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:14:20,477 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:14:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:14:51,538 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:14:51,539 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753938492.791599', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282293222818.9212409550592.194f60a42f6d4a8f4ea159fc5914412a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753938492.791599', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282293216674/z5yKP6Fs6nRDBAnBwjgyb6fC', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '9DgNb', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753942491.238232'}]}
2025-07-31 09:14:51,548 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:14:51,549 - app.handlers.command_handler - INFO - handle_list_sheets_action:222 - Handling list sheets action
2025-07-31 09:14:51,550 - app.handlers.command_handler - INFO - handle_list_sheets_action:226 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-31 09:14:51,607 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:14:55,555 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:14:55,557 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Fetching available sheets...
2025-07-31 09:14:55,558 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:14:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:14:56,126 - app.services.google_service - INFO - list_available_sheets:740 - Found 7 Google Sheets
2025-07-31 09:14:56,127 - app.handlers.command_handler - INFO - fetch_and_send_sheets:253 - Found 7 sheets
2025-07-31 09:14:56,127 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatting sheets list...
2025-07-31 09:14:56,128 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Formatted 15 blocks
2025-07-31 09:14:56,128 - app.handlers.command_handler - INFO - fetch_and_send_sheets:270 - Posting message to channel...
2025-07-31 09:14:57,322 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:14:57,322 - app.handlers.command_handler - INFO - fetch_and_send_sheets:277 - List sheets action completed successfully
2025-07-31 09:21:23,427 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:21:23,428 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:21:24,438 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:21:24,445 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:21:24,458 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:21:24,483 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:21:24,505 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:21:24,588 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:21:24,591 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:21:42,365 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753942902', 'text': ''}
2025-07-31 09:21:42,367 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:21:42] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:21:48,487 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:21:48,488 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753942902.805869', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279165562406.9212409550592.821b3033518d50924615115f18d39838', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753942902.805869', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279165544214/zAVLgHGia6uzC0ggZr3z3HmL', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753942908.160951'}]}
2025-07-31 09:21:48,495 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:21:48,496 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:21:48,500 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9279165562406.9212409550592.821b3033518d50924615115f18d39838
2025-07-31 09:21:49,536 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279165562406.9212409550592.821b3033518d50924615115f18d39838
2025-07-31 09:21:49,537 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:21:49] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:22:02,966 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:22:02,967 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9282319926162.9212409550592.678e594fcb402f1d95288af014732a51', 'view': {'id': 'V097V2W4Q4X', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'projects'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753942909.NpZpO5tx', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V2W4Q4X', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:22:02,977 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:22:02,978 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:22:02,979 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:689 - Handling create sheet modal submission
2025-07-31 09:22:02,980 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:697 - Modal values - Title: projects, Template: task_tracker
2025-07-31 09:22:03,122 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:22:09,133 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE at range A1
2025-07-31 09:22:11,598 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: projects (ID: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE)
2025-07-31 09:22:12,385 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:22:12,389 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:22:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:19,476 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:28:19,476 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:28:23,386 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:28:23,402 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:23,418 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:23,450 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:28:23,486 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:28:23,585 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:28:23,586 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:28:36,051 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753943315', 'text': ''}
2025-07-31 09:28:36,054 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:36] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:28:41,241 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:28:41,243 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943316.444899', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943316.444899', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267125220327/z9r9tqmbl1wLpBK570iIqTJr', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943320.878256'}]}
2025-07-31 09:28:41,246 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:28:41,247 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:28:41,248 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258
2025-07-31 09:28:42,150 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267125221831.9212409550592.d2ac2ec957970cc32fe4139bf521a258
2025-07-31 09:28:42,152 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:53,082 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:28:53,083 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9267126025287.9212409550592.18acd3f847a8b601811e9ae8b4ef6ae5', 'view': {'id': 'V097V3NQEB1', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'uuuuuu'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}}}}}, 'hash': '1753943322.xllTaieS', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V3NQEB1', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:28:53,088 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:28:53,089 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:28:53,089 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:706 - Handling create sheet modal submission
2025-07-31 09:28:53,090 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:714 - Modal values - Title: uuuuuu, Template: empty
2025-07-31 09:28:53,188 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:28:56,291 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:28:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:28:57,987 - app.services.google_service - ERROR - create_new_sheet:406 - Error creating new sheet: <HttpError 503 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The service is currently unavailable.". Details: "The service is currently unavailable.">
2025-07-31 09:28:57,988 - app.handlers.command_handler - ERROR - create_sheet_async:753 - Error in async sheet creation: <HttpError 503 when requesting https://sheets.googleapis.com/v4/spreadsheets?alt=json returned "The service is currently unavailable.". Details: "The service is currently unavailable.">
2025-07-31 09:28:58,761 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:31:51,081 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:31:51,082 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:31:52,825 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 09:31:52,831 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:31:52,842 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:31:52,849 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 09:31:52,874 - main - INFO - main:72 - Starting Slack Data Manager Bot on 0.0.0.0:5000
2025-07-31 09:31:52,942 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 09:31:52,943 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 09:32:46,467 - app.core.auth - INFO - log_request:161 - AUDIT: {'user_id': 'U0968C1G72L', 'action': 'slash_command_/start', 'ip_address': '127.0.0.1', 'user_agent': 'Slackbot 1.0 (+https://api.slack.com/robots)', 'timestamp': '1753943565', 'text': ''}
2025-07-31 09:32:46,472 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:32:46] "POST /api/slack/command HTTP/1.1" 200 -
2025-07-31 09:32:51,548 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:32:51,549 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943566.872559', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943566.872559', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267144642199/1W5pwdgEmJBguGkCFJFAkukr', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': 'Kz/Ar', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943571.282061'}]}
2025-07-31 09:32:51,557 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:32:51,560 - app.handlers.command_handler - INFO - handle_create_sheet_action:305 - Handling create sheet action
2025-07-31 09:32:51,565 - app.handlers.command_handler - INFO - handle_create_sheet_action:310 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482
2025-07-31 09:32:52,460 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267144642887.9212409550592.a6ee25448e0678c49e9dac84f3481482
2025-07-31 09:32:52,463 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:32:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:01,326 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:01,327 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280554826197.9212409550592.09ecb857a646e8c7b9903ce869c2c39d', 'view': {'id': 'V098RE8AJKB', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'Sheet Title', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter sheet title (e.g., Project Tracker)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template (Optional)', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty Sheet', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales_report'}, {'text': {'type': 'plain_text', 'text': 'Inventory List', 'emoji': True}, 'value': 'inventory'}]}}], 'private_metadata': '', 'callback_id': 'create_sheet_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'mmm'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Task Tracker', 'emoji': True}, 'value': 'task_tracker'}}}}}, 'hash': '1753943572.nxhFdlBo', 'title': {'type': 'plain_text', 'text': 'Create New Google Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098RE8AJKB', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:33:01,333 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:33:01,336 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:33:01,338 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:705 - Handling create sheet modal submission
2025-07-31 09:33:01,339 - app.handlers.command_handler - INFO - handle_create_sheet_modal_submission:713 - Modal values - Title: mmm, Template: task_tracker
2025-07-31 09:33:01,340 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:01,407 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:07,732 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0 at range A1
2025-07-31 09:33:10,152 - app.services.google_service - INFO - create_new_sheet:397 - Created new sheet: mmm (ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0)
2025-07-31 09:33:10,914 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:33:21,652 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:21,653 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943566.872559', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280556931973.9212409550592.5e772fb717f2ecbc4195cecfc7f7f27b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753943566.872559', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'kgJyw', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'StAIz'}, {'type': 'section', 'block_id': '9DgNb', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': 'Kz/Ar', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280556931925/HBawJhh4aToiWfHt47oHd4jr', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '9DgNb', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753943601.350782'}]}
2025-07-31 09:33:21,657 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:21,657 - app.handlers.command_handler - INFO - handle_list_sheets_action:222 - Handling list sheets action
2025-07-31 09:33:21,658 - app.handlers.command_handler - INFO - handle_list_sheets_action:226 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L
2025-07-31 09:33:21,720 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:25,795 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:25,797 - app.handlers.command_handler - INFO - fetch_and_send_sheets:251 - Fetching available sheets...
2025-07-31 09:33:25,797 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:25,798 - app.services.google_service - INFO - list_available_sheets:734 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 09:33:26,290 - app.services.google_service - INFO - list_available_sheets:746 - Found 5 Google Sheets in folder
2025-07-31 09:33:26,291 - app.handlers.command_handler - INFO - fetch_and_send_sheets:253 - Found 5 sheets
2025-07-31 09:33:26,292 - app.handlers.command_handler - INFO - fetch_and_send_sheets:266 - Formatting sheets list...
2025-07-31 09:33:26,292 - app.handlers.command_handler - INFO - fetch_and_send_sheets:268 - Formatted 11 blocks
2025-07-31 09:33:26,293 - app.handlers.command_handler - INFO - fetch_and_send_sheets:270 - Posting message to channel...
2025-07-31 09:33:27,090 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:27,090 - app.handlers.command_handler - INFO - fetch_and_send_sheets:277 - List sheets action completed successfully
2025-07-31 09:33:39,650 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:39,651 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943607.112189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304316608864.9212409550592.328ef8ee5428429a7ede7dc2532f3f17', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943607.112189', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Available Google Sheets:', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304316595920/rZUxTHJRrTegsFmf4O8MvaoF', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': '+GPZw', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753943619.329956'}]}
2025-07-31 09:33:39,658 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:39,658 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:341 - Handling get data sheet action
2025-07-31 09:33:39,659 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:346 - Channel ID: D0981PKFR8T, Sheet ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, User ID: U0968C1G72L
2025-07-31 09:33:39,729 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:33:43,695 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:43,696 - app.handlers.command_handler - INFO - fetch_and_send_data:371 - Fetching data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:33:43,697 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:33:44,293 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:33:44,294 - app.handlers.command_handler - INFO - fetch_and_send_data:373 - Retrieved 2 rows of data
2025-07-31 09:33:44,295 - app.handlers.command_handler - INFO - fetch_and_send_data:384 - Formatting data blocks...
2025-07-31 09:33:44,295 - app.handlers.command_handler - INFO - fetch_and_send_data:386 - Formatted 5 blocks
2025-07-31 09:33:45,150 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:33:45,151 - app.handlers.command_handler - INFO - fetch_and_send_data:394 - Get data action completed successfully
2025-07-31 09:33:49,782 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:33:49,785 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943625.171159', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282366742146.9212409550592.3c23b381941a2614d8d6ebfc3a08a184', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943625.171159', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'JX+wz', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'VRYyf'}, {'type': 'section', 'block_id': 'mPIdx', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'N0V82', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'riLNK', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282366736866/nxCmllM7PDcIGOZWFaxaoZMB', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'riLNK', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753943629.210429'}]}
2025-07-31 09:33:49,800 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:33:49,801 - app.handlers.command_handler - INFO - handle_open_update_modal_action:496 - Handling open update modal action
2025-07-31 09:33:49,801 - app.handlers.command_handler - INFO - handle_open_update_modal_action:506 - Opening update modal for source: sheet, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 09:33:50,683 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9282366742146.9212409550592.3c23b381941a2614d8d6ebfc3a08a184
2025-07-31 09:33:50,685 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:33:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:06,204 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:34:06,205 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9304317998448.9212409550592.e3fd0c123d2fe423b9f9d101f70c46ae', 'view': {'id': 'V097V4DT955', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'new'}}}}, 'hash': '1753943630.89vQbthh', 'title': {'type': 'plain_text', 'text': 'Write SHEET Data', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097V4DT955', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 09:34:06,217 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: view_submission
2025-07-31 09:34:06,217 - app.handlers.command_handler - INFO - handle_view_submission:530 - Modal submission received
2025-07-31 09:34:06,218 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:551 - Handling write data modal submission
2025-07-31 09:34:06,219 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:584 - Modal values - Sheet ID: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, Row: 1, Col: A, Value: new
2025-07-31 09:34:06,220 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:34:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:06,293 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:34:09,694 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0 at range A1
2025-07-31 09:34:10,562 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 09:34:15,574 - app.handlers.command_handler - INFO - handle_interaction:168 - Interaction received
2025-07-31 09:34:15,575 - app.handlers.command_handler - INFO - handle_interaction:170 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753943625.171159', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279217744230.9212409550592.313c4456123841f7566e6b6217cb6595', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753943625.171159', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': ':bar_chart: Data from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'JX+wz', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'VRYyf'}, {'type': 'section', 'block_id': 'mPIdx', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'N0V82', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'riLNK', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279217744134/zgLu6nRfH5tzyxXsuioZTuGU', 'actions': [{'action_id': 'refresh_data', 'block_id': 'riLNK', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753943655.462366'}]}
2025-07-31 09:34:15,590 - app.handlers.command_handler - INFO - handle_interaction:173 - Interaction type: block_actions
2025-07-31 09:34:15,603 - app.handlers.command_handler - INFO - handle_refresh_data_action:422 - Handling refresh data action
2025-07-31 09:34:15,606 - app.handlers.command_handler - INFO - handle_refresh_data_action:432 - Refreshing data for source: sheet, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 09:34:15,691 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 09:34:19,460 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:34:19,480 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 09:34:19] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 09:34:19,919 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 09:34:20,684 - app.services.slack_service - INFO - post_message:75 - Posted message to channel D0981PKFR8T
2025-07-31 09:57:45,678 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:57:45,679 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 09:57:48,305 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 09:57:48,305 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 10:42:06,843 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 10:42:06,850 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 10:42:08,607 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 10:42:08,607 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 10:59:26,831 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 10:59:26,832 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:00:49,532 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:00:49,534 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:00:54,011 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:00:55,473 - app.services.google_service - INFO - _get_oauth_credentials:63 - Refreshed OAuth2 token
2025-07-31 11:00:55,474 - app.services.google_service - INFO - _get_oauth_credentials:88 - Saved OAuth2 token to file
2025-07-31 11:00:55,484 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:00:55,513 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:00:55,525 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:00:55,549 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:00:55,551 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:01:57,635 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:01:57,635 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:01:59,337 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:01:59,344 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:01:59,354 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:01:59,359 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:01:59,588 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 11:01:59,589 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 11:01:59,593 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:02:00,317 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:02:00,318 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:02:01,539 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:02:01,545 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:02:01,557 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:02:01,566 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:02:01,714 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:02:01,753 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:03:32,055 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:03:32] "[33mPOST /api/slack/command HTTP/1.1[0m" 404 -
2025-07-31 11:03:58,094 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:03:58,334 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:03:59,259 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:03:59,260 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:04:01,005 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:04:01,011 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:04:01,021 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:04:01,027 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:04:01,167 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:04:01,174 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:06:36,942 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:06:36,978 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:06:36] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:06:53,859 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:06:53,860 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267604059831.9212409550592.d308225f08a227b5583b5b1013ffd1f5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267604058407/euP1rgePs4Jup1AVHkt0Jtsd', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'onA1j', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949213.137576'}]}
2025-07-31 11:06:53,899 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:06:53,915 - app.handlers.command_handler - INFO - handle_list_excel_action:406 - Handling list Excel action
2025-07-31 11:06:53,927 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:06:53] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:06:54,357 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:06:58,877 - app.services.google_service - INFO - list_available_excel_files:775 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:07:00,583 - app.services.google_service - INFO - list_available_excel_files:787 - Found 0 Excel files in folder
2025-07-31 11:07:02,176 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:07:09,379 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:07:09,384 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267605172471.9212409550592.eb3558611400dd2e20d9897d1b9b00e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267605146311/YENhH1w3MwjC3rI6nviBGjCL', 'actions': [{'action_id': 'create_excel_menu', 'block_id': 'Od+FJ', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949229.016896'}]}
2025-07-31 11:07:09,404 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:07:09,413 - app.handlers.command_handler - INFO - handle_create_excel_action:468 - Handling create Excel action
2025-07-31 11:07:10,306 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267605172471.9212409550592.eb3558611400dd2e20d9897d1b9b00e5
2025-07-31 11:07:10,308 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:07:10] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:07:26,704 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:07:26,705 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9267606731159.9212409550592.2dfdf1cd3f1496de3b174780d53e9f30', 'view': {'id': 'V098YM7CK0Q', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'File Name', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter file name (e.g., Sales Report)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}, {'text': {'type': 'plain_text', 'text': 'Inventory', 'emoji': True}, 'value': 'inventory'}, {'text': {'type': 'plain_text', 'text': 'Project Tracker', 'emoji': True}, 'value': 'project'}]}}], 'private_metadata': '', 'callback_id': 'create_excel_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'sales report'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}}}}}, 'hash': '1753949230.egHTfsVu', 'title': {'type': 'plain_text', 'text': 'Create Excel File', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098YM7CK0Q', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 11:07:26,717 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 11:07:26,718 - app.handlers.command_handler - INFO - handle_view_submission:576 - Modal submission received
2025-07-31 11:07:26,718 - app.handlers.command_handler - INFO - handle_create_excel_modal_submission:826 - Handling create Excel modal submission
2025-07-31 11:07:26,719 - app.handlers.command_handler - INFO - handle_create_excel_modal_submission:834 - Modal values - Title: sales report, Template: sales
2025-07-31 11:07:26,721 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:07:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:07:26,919 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:07:32,761 - app.services.google_service - INFO - write_excel_to_drive:588 - Created new Excel file: sales report.xlsx (ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb)
2025-07-31 11:07:32,904 - app.services.google_service - ERROR - write_excel_to_drive:610 - Error writing Excel to Drive: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp7vxo76o8.xlsx'
2025-07-31 11:07:33,074 - app.handlers.command_handler - ERROR - create_excel_async:883 - Error in async Excel creation: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp7vxo76o8.xlsx'
2025-07-31 11:07:33,903 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:09:11,321 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:09:12,207 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:09:16,353 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:09:16,369 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:09:18,983 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:09:18,993 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:09:19,011 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:09:19,042 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:09:19,233 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:09:19,249 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:09:33,550 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:09:33,551 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279672109062.9212409550592.18a355ac8b0d7e868887f60495d6306b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279672109030/cMJ8p2rHvck8Weygtf5maF97', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'onA1j', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949373.184368'}]}
2025-07-31 11:09:33,643 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:09:33,685 - app.handlers.command_handler - INFO - handle_list_excel_action:406 - Handling list Excel action
2025-07-31 11:09:33,700 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:09:33] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:09:33,827 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:09:36,743 - app.services.google_service - INFO - list_available_excel_files:782 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:09:38,501 - app.services.google_service - INFO - list_available_excel_files:794 - Found 1 Excel files in folder
2025-07-31 11:09:39,378 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:10:13,359 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:10:13,360 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280981164005.9212409550592.223af1bba130cb3d00bff245e37fcc04', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280981151525/3uPaHBROs8ednNFtEqijDDZs', 'actions': [{'action_id': 'list_csv_menu', 'block_id': 'xJHJT', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949413.018903'}]}
2025-07-31 11:10:13,372 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:10:13,374 - app.handlers.command_handler - INFO - handle_list_csv_action:491 - Handling list CSV action
2025-07-31 11:10:13,376 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:10:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:10:13,575 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:10:16,822 - app.services.google_service - INFO - list_available_csv_files:823 - Searching for CSV files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:10:17,382 - app.services.google_service - INFO - list_available_csv_files:835 - Found 0 CSV files in folder
2025-07-31 11:10:18,185 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:10:23,679 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:10:23,680 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282801531154.9212409550592.74235dd0c2d152ae5d999225b549b4ae', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282801531042/KSyOQQkFnvjJv7aGwyUFuo1E', 'actions': [{'action_id': 'create_csv_menu', 'block_id': '5OKIG', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949423.346940'}]}
2025-07-31 11:10:23,688 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:10:23,689 - app.handlers.command_handler - INFO - handle_create_csv_action:553 - Handling create CSV action
2025-07-31 11:10:24,631 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9282801531154.9212409550592.74235dd0c2d152ae5d999225b549b4ae
2025-07-31 11:10:24,632 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:10:24] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:10:42,867 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:10:42,867 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284046597108.9212409550592.81a07af17ebd2edad18ca37216e4232b', 'view': {'id': 'V098C1AMX1S', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'File Name', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter file name (e.g., Sales Data)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}, {'text': {'type': 'plain_text', 'text': 'Inventory', 'emoji': True}, 'value': 'inventory'}, {'text': {'type': 'plain_text', 'text': 'Project Tracker', 'emoji': True}, 'value': 'project'}]}}], 'private_metadata': '', 'callback_id': 'create_csv_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'sales data'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}}}}}, 'hash': '1753949424.BJAmjV7c', 'title': {'type': 'plain_text', 'text': 'Create CSV File', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098C1AMX1S', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 11:10:42,870 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 11:10:42,871 - app.handlers.command_handler - INFO - handle_view_submission:576 - Modal submission received
2025-07-31 11:10:42,871 - app.handlers.command_handler - INFO - handle_create_csv_modal_submission:916 - Handling create CSV modal submission
2025-07-31 11:10:42,872 - app.handlers.command_handler - INFO - handle_create_csv_modal_submission:924 - Modal values - Title: sales data, Template: sales
2025-07-31 11:10:42,874 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:10:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:10:42,989 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:10:48,181 - app.services.google_service - INFO - write_csv_to_drive:477 - Created new CSV file: sales data.csv (ID: 19fleNBSfueW7oyr7VGf__CpmasYMNdkV)
2025-07-31 11:10:48,182 - app.services.google_service - ERROR - write_csv_to_drive:497 - Error writing CSV to Drive: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpx9mbtm9i.csv'
2025-07-31 11:10:48,183 - app.handlers.command_handler - ERROR - create_csv_async:973 - Error in async CSV creation: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpx9mbtm9i.csv'
2025-07-31 11:10:49,103 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:11:14,512 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:11:14,693 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:11:16,573 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:11:16,574 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:11:17,732 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:11:17,737 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:11:17,746 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:11:17,749 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:11:17,793 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:11:17,800 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:11:46,770 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:11:47,778 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:11:50,460 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:11:50,461 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:11:52,950 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:11:52,955 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:11:52,964 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:11:52,968 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:11:53,014 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:11:53,021 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:12:00,783 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:12:01,269 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:12:02,151 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:12:02,152 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:12:03,443 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:12:03,448 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:12:03,457 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:12:03,460 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:12:03,520 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:12:03,531 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:12:29,447 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:12:29,447 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279686031238.9212409550592.c7873aabdc746a71c1ce9c530a5bce3f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279686024950/lqVctzsMKQP1ZKaMG1gip7oM', 'actions': [{'action_id': 'create_csv_menu', 'block_id': '5OKIG', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949549.094716'}]}
2025-07-31 11:12:29,467 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:12:29,468 - app.handlers.command_handler - INFO - handle_create_csv_action:553 - Handling create CSV action
2025-07-31 11:12:30,420 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279686031238.9212409550592.c7873aabdc746a71c1ce9c530a5bce3f
2025-07-31 11:12:30,421 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:12:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:12:41,003 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:12:41,004 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9297949484433.9212409550592.9982484f475f82324552befdd6cd3af2', 'view': {'id': 'V098RTWNRSM', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'File Name', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter file name (e.g., Sales Data)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}, {'text': {'type': 'plain_text', 'text': 'Inventory', 'emoji': True}, 'value': 'inventory'}, {'text': {'type': 'plain_text', 'text': 'Project Tracker', 'emoji': True}, 'value': 'project'}]}}], 'private_metadata': '', 'callback_id': 'create_csv_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'sales data'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}}}}}, 'hash': '1753949550.pkNFRLdo', 'title': {'type': 'plain_text', 'text': 'Create CSV File', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098RTWNRSM', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 11:12:41,008 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 11:12:41,009 - app.handlers.command_handler - INFO - handle_view_submission:576 - Modal submission received
2025-07-31 11:12:41,010 - app.handlers.command_handler - INFO - handle_create_csv_modal_submission:916 - Handling create CSV modal submission
2025-07-31 11:12:41,011 - app.handlers.command_handler - INFO - handle_create_csv_modal_submission:924 - Modal values - Title: sales data, Template: sales
2025-07-31 11:12:41,017 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:12:41] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:12:41,137 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:12:47,300 - app.services.google_service - INFO - write_csv_to_drive:484 - Created new CSV file: sales data.csv (ID: 1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq)
2025-07-31 11:12:47,301 - app.services.google_service - WARNING - write_csv_to_drive:508 - Could not delete temp file C:\Users\dell\AppData\Local\Temp\tmpv8hxrkce.csv: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpv8hxrkce.csv'
2025-07-31 11:12:48,102 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:12:57,952 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:12:57,953 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304747072864.9212409550592.6057c085171fd1b2bd173c6346adb5c2', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304747068112/ZfyXkSugqxZp08v8Aw5KWLaL', 'actions': [{'action_id': 'list_csv_menu', 'block_id': 'xJHJT', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949577.804847'}]}
2025-07-31 11:12:57,967 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:12:57,968 - app.handlers.command_handler - INFO - handle_list_csv_action:491 - Handling list CSV action
2025-07-31 11:12:57,969 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:12:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:12:58,076 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:13:01,343 - app.services.google_service - INFO - list_available_csv_files:833 - Searching for CSV files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:13:01,892 - app.services.google_service - INFO - list_available_csv_files:845 - Found 2 CSV files in folder
2025-07-31 11:13:02,643 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:13:43,060 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:13:43,062 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949197.433359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9278936063427.9212409550592.444803338c021d8815a0b5df0c9f1309', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949197.433359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9278936063347/GOyZ8ajE7j62ziY9Qn7Ldubc', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949622.885999'}]}
2025-07-31 11:13:43,069 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:13:43,070 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:13:43,074 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:13:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:13:43,211 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:13:46,059 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:13:46,660 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:13:47,861 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:15:22,873 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:15:22,875 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:15:22] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:15:28,206 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:15:28,209 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949723.296269', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282824960674.9212409550592.59c41ec2bdbfc5002e75578c090a22df', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753949723.296269', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282824907650/MDcaptJh6VMCgocFthwtTL4T', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753949727.785880'}]}
2025-07-31 11:15:28,214 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:15:28,214 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:15:28,215 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:15:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:15:28,512 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:15:31,587 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:15:32,120 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:15:32,941 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:15:39,490 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:15:39,491 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949732.959399', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304760073552.9212409550592.e2c8a4e2ab0b6a0d3e737c93236085d8', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753949732.959399', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'Mp+46', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'NLHsY'}, {'type': 'section', 'block_id': 'tDQVv', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'zJWx9'}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304760071280/OYefoAHrTE7CjGLmtdKa6Wph', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': 'tDQVv', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753949738.596082'}]}
2025-07-31 11:15:39,508 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:15:39,523 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:15:39,524 - app.handlers.command_handler - ERROR - handle_get_data_sheet_action:243 - Failed to parse sheet info from action value
2025-07-31 11:15:39,616 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:15:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:15:50,345 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:15:50,346 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949732.959399', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267649431559.9212409550592.6c034c7d86704ce1e9b10937822e445d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753949732.959399', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'Mp+46', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'NLHsY'}, {'type': 'section', 'block_id': 'tDQVv', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'zJWx9'}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267649426711/n6mpCHA5TKnO74g7u0WMgWcq', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': 'tDQVv', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753949750.199632'}]}
2025-07-31 11:15:50,350 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:15:50,351 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:15:50,355 - app.handlers.command_handler - ERROR - handle_get_data_sheet_action:243 - Failed to parse sheet info from action value
2025-07-31 11:15:50,356 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:15:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:16:10,711 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:16:10,711 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:16:12,322 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:16:12,328 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:16:12,342 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:16:12,351 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:16:12,476 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 11:16:12,478 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 11:16:12,481 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:16:13,459 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:16:13,460 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:16:15,062 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:16:15,070 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:16:15,083 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:16:15,092 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:16:15,185 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:16:15,197 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:17:28,119 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:17:28,120 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753949732.959399', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281015302261.9212409550592.37e84646850a95ea4d1a2be2ff3891b7', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753949732.959399', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'Mp+46', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'NLHsY'}, {'type': 'section', 'block_id': 'tDQVv', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'zJWx9'}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281015293269/oLELZ5Xi4Wc8eR0ZA8tiHM4J', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': 'tDQVv', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753949847.999710'}]}
2025-07-31 11:17:28,123 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:17:28,124 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:17:28,125 - app.handlers.command_handler - ERROR - handle_get_data_sheet_action:243 - Failed to parse sheet info from action value
2025-07-31 11:17:28,129 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:17:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:18:48,855 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:18:49,363 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:18:51,482 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:18:51,484 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:18:52,530 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:18:52,538 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:18:52,554 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:18:52,557 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:18:52,651 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:18:52,661 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:19:28,858 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:19:29,357 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:19:32,275 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:19:32,275 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:19:33,841 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:19:33,848 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:19:33,881 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:19:33,922 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:19:33,996 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:19:34,002 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:19:43,280 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:19:43,990 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:19:46,609 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:19:46,610 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:19:47,606 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:19:47,611 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:19:47,619 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:19:47,623 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:19:47,700 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:19:47,706 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:20:16,924 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:20:16,925 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:20:17,939 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:20:17,944 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:17,957 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:17,968 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:20:18,193 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 11:20:18,194 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 11:20:18,198 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:20:19,122 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:20:19,123 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:20:20,506 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:20:20,513 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:20,525 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:20,531 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:20:20,636 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:20:20,642 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:20:36,980 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:20:37,223 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:20:38,279 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:20:38,280 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:20:40,027 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:20:40,032 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:40,046 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:40,052 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:20:40,135 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:20:40,143 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:20:40,244 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:20:40,245 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:20:40] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:20:46,797 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:20:46,798 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950040.659669', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282850550098.9212409550592.516236368b6f74493d807f6ce8826d61', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950040.659669', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282850542674/JLoAD8JzXWuPe8VDqR4RPtst', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950046.682545'}]}
2025-07-31 11:20:46,802 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:20:46,869 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:20:46,871 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:20:46] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:20:46,988 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:20:50,297 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:20:51,657 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:20:52,658 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:20:56,280 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:20:56,281 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950052.569209', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304784844240.9212409550592.b1aee3c4a61418d29e9b42e4035b4581', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950052.569209', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'Mp+46', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'NLHsY'}, {'type': 'section', 'block_id': 'tDQVv', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'zJWx9'}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304784844176/4VLiIMD08ZwgqG8AkmWkoUnm', 'actions': [{'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'block_id': 'tDQVv', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'type': 'button', 'action_ts': '1753950056.151435'}]}
2025-07-31 11:20:56,293 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:20:56,294 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:20:56,304 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:20:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:20:56,423 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:21:01,576 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0
2025-07-31 11:21:02,379 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:21:11,196 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:21:11,197 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950062.399519', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9297991140177.9212409550592.d651ebe5974fc9c4a8553dfdd4439a2c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950062.399519', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'kyb9h', 'text': {'type': 'mrkdwn', 'text': '*Data from 1SLTVNQRIPALV28AE2S_PISNELICZJV9B_RKEJCLXDW0*', 'verbatim': False}}, {'type': 'divider', 'block_id': '8JQii'}, {'type': 'section', 'block_id': 'k2j/g', 'text': {'type': 'mrkdwn', 'text': '*`new | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'atLLF', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'G3fkR', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9297991109201/Sxb4kC2KFgz2gHgsnN8EoK3s', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'G3fkR', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753950071.088268'}]}
2025-07-31 11:21:11,207 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:21:11,208 - app.handlers.command_handler - INFO - handle_open_update_modal_action:373 - Handling open update modal action
2025-07-31 11:21:11,208 - app.handlers.command_handler - INFO - handle_open_update_modal_action:383 - Opening update modal for source: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 11:21:11,978 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:21:11,981 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:397 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 392, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:21:12,297 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:21:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:21:24,903 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:21:24,904 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950062.399519', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284101421636.9212409550592.82949414f465beef2722f7c08ce8efd0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950062.399519', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'kyb9h', 'text': {'type': 'mrkdwn', 'text': '*Data from 1SLTVNQRIPALV28AE2S_PISNELICZJV9B_RKEJCLXDW0*', 'verbatim': False}}, {'type': 'divider', 'block_id': '8JQii'}, {'type': 'section', 'block_id': 'k2j/g', 'text': {'type': 'mrkdwn', 'text': '*`new | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'atLLF', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'G3fkR', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284101418644/FYUsAbA9zKlIaF6vRS0Uc1mq', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'G3fkR', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0", "params": {"sheet_id": "1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0"}}', 'type': 'button', 'action_ts': '1753950084.775386'}]}
2025-07-31 11:21:24,912 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:21:24,913 - app.handlers.command_handler - INFO - handle_open_update_modal_action:373 - Handling open update modal action
2025-07-31 11:21:24,914 - app.handlers.command_handler - INFO - handle_open_update_modal_action:383 - Opening update modal for source: 1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0, params: {'sheet_id': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}
2025-07-31 11:21:25,657 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:21:25,659 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:397 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 392, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:21:25,703 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:21:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:21:32,883 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:21:32,884 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950040.659669', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267679723895.9212409550592.69163cf7764709ba398ba345a9bd5b72', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950040.659669', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267679708455/ubRqvIuNANCV9AcssFzMnFeI', 'actions': [{'action_id': 'create_sheet_menu', 'block_id': '0+XgR', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950092.760985'}]}
2025-07-31 11:21:32,893 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:21:32,895 - app.handlers.command_handler - INFO - handle_create_sheet_action:204 - Handling create sheet action
2025-07-31 11:21:32,903 - app.handlers.command_handler - INFO - handle_create_sheet_action:209 - Channel ID: D0981PKFR8T, User ID: U0968C1G72L, Trigger ID: 9267679723895.9212409550592.69163cf7764709ba398ba345a9bd5b72
2025-07-31 11:21:33,706 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9267679723895.9212409550592.69163cf7764709ba398ba345a9bd5b72
2025-07-31 11:21:33,708 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:21:33] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:21:47,064 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:21:47,246 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:21:48,036 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:21:48,037 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:21:49,209 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:21:49,219 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:21:49,239 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:21:49,251 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:21:49,374 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:21:49,389 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:25:44,278 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:25:44,310 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:25:47,402 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:25:47,416 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:25:47,442 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:25:47,453 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:25:47,640 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 11:25:47,655 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 11:25:47,668 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:25:50,708 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:25:50,717 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:25:55,907 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:25:55,918 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:25:55,941 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:25:55,946 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:25:56,084 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:25:56,114 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:25:57,694 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:25:57,695 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:25:57] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:26:03,912 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:26:03,915 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950358.100039', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282874161362.9212409550592.6010886688814acc424dc04ebe448036', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950358.100039', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282874154002/LSGCN4ofMleDuYFieo5uveY7', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950363.791401'}]}
2025-07-31 11:26:03,921 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:26:03,921 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:26:03,923 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:26:03] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:26:04,089 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:26:08,336 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:26:10,494 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:26:11,417 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:26:57,537 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:26:58,305 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:27:01,009 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:27:01,010 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:27:02,119 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:27:02,124 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:27:02,137 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:27:02,150 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:27:02,250 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:27:02,259 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:27:22,476 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:27:22,546 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950358.100039', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279007299475.9212409550592.2e50fd3682fd0fad55523b0f67d6a61c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950358.100039', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279007275075/r4ctk96s41HAvKRGa5seocPx', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950442.263396'}]}
2025-07-31 11:27:22,714 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:27:22,768 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:27:22,804 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:27:22] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:27:23,005 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:27:26,854 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:27:28,334 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:27:29,187 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:27:37,717 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:27:37,717 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950449.213389', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279763055814.9212409550592.21bae7bab71220a03c6b5023003d9b3f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950449.213389', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279763015446/9uI6gIg9dLipnUXdvpgQPTQo', 'actions': [{'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'block_id': 'fNJLb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'type': 'button', 'action_ts': '1753950457.615166'}]}
2025-07-31 11:27:37,727 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:27:37,729 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:27:37,731 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:27:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:27:37,832 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:27:42,937 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 11:27:43,748 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:27:53,519 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:27:53,520 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950463.723169', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267710667623.9212409550592.3e309d433644fb6068b070befc2216ed', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950463.723169', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'oXDma', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': '8Me2v'}, {'type': 'section', 'block_id': '43OX+', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'gefYD', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'bU3m1', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267710666039/OapOgKHJvKLG0ev94W26jVwA', 'actions': [{'action_id': 'refresh_data', 'block_id': 'bU3m1', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753950473.421109'}]}
2025-07-31 11:27:53,523 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:27:53,524 - app.handlers.command_handler - INFO - handle_refresh_data_action:302 - Handling refresh data action
2025-07-31 11:27:53,528 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:27:53] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:27:53,618 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:27:57,613 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:27:57,614 - app.handlers.command_handler - ERROR - refresh_data:350 - Error refreshing sheet data: 'NoneType' object has no attribute 'upper'
2025-07-31 11:27:58,374 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:29:04,914 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:29:05,684 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:29:07,937 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:29:07,938 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:29:09,043 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:29:09,048 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:09,057 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:09,074 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:29:09,432 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:29:09,448 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:29:27,183 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:29:28,262 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:29:30,188 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:29:30,190 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:29:32,015 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:29:32,021 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:32,032 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:32,054 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:29:32,272 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:29:32,287 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:29:44,798 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:29:44,973 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:29:45,922 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:29:45,923 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:29:47,593 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:29:47,607 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:47,629 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:47,647 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:29:48,043 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:29:48,053 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:29:50,093 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:29:50,094 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950463.723169', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284141820820.9212409550592.14dc3e26a901a725b6057dcba7834d38', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950463.723169', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'oXDma', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': '8Me2v'}, {'type': 'section', 'block_id': '43OX+', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'gefYD', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'bU3m1', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284141820660/8kYem1zjh1F4JSR3MN01Wsvq', 'actions': [{'action_id': 'refresh_data', 'block_id': 'bU3m1', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753950589.971468'}]}
2025-07-31 11:29:50,105 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:29:50,105 - app.handlers.command_handler - INFO - handle_refresh_data_action:302 - Handling refresh data action
2025-07-31 11:29:50,107 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:29:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:29:50,284 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:29:57,333 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:29:58,183 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:30:18,658 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:30:18,659 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:30:18] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:30:24,742 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:30:24,742 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950619.049479', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304830509344.9212409550592.7a65f978e6d01f105aa9a90a09ebbb88', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950619.049479', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304830437728/HcZ6Ue0rpjbW3RsBtAK9iRLj', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950624.580123'}]}
2025-07-31 11:30:24,745 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:30:24,745 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:30:24,746 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:30:24] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:30:24,840 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:30:27,853 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:30:29,386 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:30:30,238 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:30:34,103 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:30:34,104 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950630.251639', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284147724372.9212409550592.25d547845792b94b6898976431cc61c6', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950630.251639', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284147675444/kgFbHSieNdgTp6NA1xcAWWTM', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'xyZAT', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753950633.987237'}]}
2025-07-31 11:30:34,154 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:30:34,155 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:30:34,169 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:30:34] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:30:34,304 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:30:38,333 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:30:39,110 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:30:50,638 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:30:50,638 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950630.251639', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267729953191.9212409550592.445f6b044b3bae692c065a35bc5ac41d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950630.251639', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267729952999/W0UHOFqETW7AtRNx4RgqnxJj', 'actions': [{'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'block_id': 'zdN7N', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'type': 'button', 'action_ts': '1753950650.503047'}]}
2025-07-31 11:30:50,651 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:30:50,652 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:30:50,654 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:30:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:30:50,795 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:30:54,739 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU
2025-07-31 11:30:55,586 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:31:02,701 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:31:02,703 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950655.609119', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282901551442.9212409550592.1dc8c921bd53024991740411a07fc329', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950655.609119', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'HOtBG', 'text': {'type': 'mrkdwn', 'text': '*Data from 16R2RVVVGSBXFQWUY-4CLH25PZVIH5HWV7AFMCTCNMOU*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'q4Zde'}, {'type': 'section', 'block_id': 'RD8pm', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'g5QJb', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'Uem6I', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282901510098/lfRCaroE1GVSG1iEIycB5AdF', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Uem6I', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}', 'type': 'button', 'action_ts': '1753950662.584071'}]}
2025-07-31 11:31:02,707 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:31:02,707 - app.handlers.command_handler - INFO - handle_refresh_data_action:302 - Handling refresh data action
2025-07-31 11:31:02,709 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:31:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:31:02,805 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:31:06,375 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:31:07,211 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:32:32,043 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:32:32,432 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:32:34,105 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:32:34,110 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:32:35,426 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:32:35,431 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:35,440 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:35,448 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:32:35,534 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:32:35,544 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:32:42,412 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:32:42,880 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:32:43,994 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:32:43,995 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:32:45,832 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:32:45,838 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:45,849 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:45,853 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:32:45,943 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:32:45,957 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:32:47,207 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:32:47,359 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:32:48,027 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:32:48,028 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:32:49,056 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:32:49,061 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:49,070 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:32:49,074 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:32:49,344 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:32:49,361 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:33:03,867 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:33:03,871 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:33:03] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:33:09,939 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:33:09,939 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950784.261279', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267742843127.9212409550592.2f103b9520f5a55c3656a7878799556c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753950784.261279', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267742837735/L9f2eKYosJCDG9z044Vz38gu', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753950789.816577'}]}
2025-07-31 11:33:09,947 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:33:09,952 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:33:09,953 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:33:09] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:33:10,055 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:33:13,220 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:33:14,699 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:33:15,621 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:33:21,299 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:33:21,300 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950795.619819', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281090649893.9212409550592.cff9d23d4e2f2bafe39bf8e82cba2785', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950795.619819', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281090630533/97uH5RkMYDso2BSaMVD9AeOb', 'actions': [{'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'block_id': 'zdN7N', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'type': 'button', 'action_ts': '1753950800.790628'}]}
2025-07-31 11:33:21,381 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:33:21,382 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:33:21,397 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:33:21] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:33:21,541 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:33:27,056 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU
2025-07-31 11:33:27,900 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:33:31,473 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:33:31,474 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950807.908269', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279795786486.9212409550592.f15d50d79dcebd616b1ef8f4bcd5da0c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950807.908269', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'HOtBG', 'text': {'type': 'mrkdwn', 'text': '*Data from 16R2RVVVGSBXFQWUY-4CLH25PZVIH5HWV7AFMCTCNMOU*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'q4Zde'}, {'type': 'section', 'block_id': 'RD8pm', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'g5QJb', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'Uem6I', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279795780726/PfYPjaHcN6TAWOwNGaUjsCWa', 'actions': [{'action_id': 'refresh_data', 'block_id': 'Uem6I', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}', 'type': 'button', 'action_ts': '1753950811.297518'}]}
2025-07-31 11:33:31,553 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:33:31,564 - app.handlers.command_handler - INFO - handle_refresh_data_action:302 - Handling refresh data action
2025-07-31 11:33:31,578 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:33:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:33:31,738 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:33:35,212 - app.services.google_service - INFO - read_sheet_data:303 - Read 2 rows from sheet 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU
2025-07-31 11:33:36,012 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:33:55,710 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:33:55,711 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950816.036379', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9282915815906.9212409550592.063caf5657be33754abb00328da3e793', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950816.036379', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'HOtBG', 'text': {'type': 'mrkdwn', 'text': '*Data from 16R2RVVVGSBXFQWUY-4CLH25PZVIH5HWV7AFMCTCNMOU*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'q4Zde'}, {'type': 'section', 'block_id': 'RD8pm', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'g5QJb', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'Uem6I', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9282915601874/PNGVIVaNjvEg8P0V5hEMuY8V', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'Uem6I', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}', 'type': 'button', 'action_ts': '1753950835.594591'}]}
2025-07-31 11:33:55,716 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:33:55,717 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:33:55,724 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU, params: {'sheet_id': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}
2025-07-31 11:33:56,492 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:33:56,496 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:398 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 393, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:33:56,593 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:33:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:35:49,924 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:35:51,375 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:35:53,031 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:35:53,031 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:35:54,491 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:35:54,498 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:35:54,507 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:35:54,520 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:35:54,615 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:35:54,622 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:36:35,121 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:36:35,665 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:36:36,461 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:36:36,463 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:36:37,647 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:36:37,653 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:36:37,667 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:36:37,681 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:36:37,747 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:36:37,756 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:36:51,117 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:36:51,118 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753950816.036379', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281106544101.9212409550592.8601dfaf7f7923eba62406339f6bb2dc', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753950816.036379', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'HOtBG', 'text': {'type': 'mrkdwn', 'text': '*Data from 16R2RVVVGSBXFQWUY-4CLH25PZVIH5HWV7AFMCTCNMOU*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'q4Zde'}, {'type': 'section', 'block_id': 'RD8pm', 'text': {'type': 'mrkdwn', 'text': '*`Task | Status | Assignee | Due Date | Priority`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'g5QJb', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'Uem6I', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281106543045/0go1vkQiyZwanBZkrAh6l7Fw', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'Uem6I', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU", "params": {"sheet_id": "16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU"}}', 'type': 'button', 'action_ts': '1753951010.826166'}]}
2025-07-31 11:36:51,126 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:36:51,127 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:36:51,127 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU, params: {'sheet_id': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}
2025-07-31 11:36:52,051 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:36:52,053 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:398 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 393, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:36:52,143 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:36:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:37:10,091 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:37:10,093 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:37:10] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:37:17,176 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:37:17,177 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951030.504339', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279063648883.9212409550592.142e3ec37633fdf54f0be0f039a7b76e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753951030.504339', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279063641443/wIzkbnaoWpAsmz7eU0l0sJeY', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': 'RXHsf', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753951036.881893'}]}
2025-07-31 11:37:17,193 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:37:17,194 - app.handlers.command_handler - INFO - handle_list_sheets_action:141 - Handling list sheets action
2025-07-31 11:37:17,195 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:37:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:37:17,311 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:37:20,330 - app.services.google_service - INFO - list_available_sheets:751 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:37:21,769 - app.services.google_service - INFO - list_available_sheets:763 - Found 5 Google Sheets in folder
2025-07-31 11:37:22,691 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:37:26,458 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:37:26,459 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951042.660779', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304864498592.9212409550592.ac29966064e345b2bd37815f584e8026', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951042.660779', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'fJ0u/', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': '6E71x'}, {'type': 'section', 'block_id': '+GPZw', 'text': {'type': 'mrkdwn', 'text': '*1. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': '5TQKU'}, {'type': 'section', 'block_id': 'fNJLb', 'text': {'type': 'mrkdwn', 'text': '*2. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'L6NV8'}, {'type': 'section', 'block_id': 'zdN7N', 'text': {'type': 'mrkdwn', 'text': '*3. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'zyKoW'}, {'type': 'section', 'block_id': 'drNYM', 'text': {'type': 'mrkdwn', 'text': '*4. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'On92I'}, {'type': 'section', 'block_id': 'xyZAT', 'text': {'type': 'mrkdwn', 'text': '*5. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304864498512/8G6GfNzB7lW5R0cIsHccvT2v', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'xyZAT', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753951046.145305'}]}
2025-07-31 11:37:26,486 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:37:26,487 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:230 - Handling get data sheet action
2025-07-31 11:37:26,499 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:37:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:37:26,630 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:37:31,815 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:37:32,561 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:37:36,220 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:37:36,221 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279816577670.9212409550592.cce04e64736688102040ea1198a2e273', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279816577510/fL3lJni2TjcNhYIthF86VPvo', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951055.755727'}]}
2025-07-31 11:37:36,224 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:37:36,225 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:37:36,225 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-31 11:37:37,010 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:37:37,014 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:398 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 393, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:37:37,076 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:37:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:38:19,184 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:38:20,061 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:38:21,331 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:38:21,332 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:38:22,785 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:38:22,791 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:38:22,799 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:38:22,815 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:38:22,896 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:38:22,908 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:38:40,583 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:38:40,583 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279069257219.9212409550592.ccb52ba528181970d101b7c02b07322b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279069246979/57DSc0laGt5BWPQIfnfSzS0B', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951120.309655'}]}
2025-07-31 11:38:40,598 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:38:40,599 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:38:40,601 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-31 11:38:41,543 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:38:41,545 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:398 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 393, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:38:41,600 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:38:41] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:38:57,705 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:38:57,706 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:38:58,703 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:38:58,708 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:38:58,718 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:38:58,727 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:38:58,844 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 11:38:58,845 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 11:38:58,847 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:38:59,580 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:38:59,580 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:39:01,220 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:39:01,226 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:39:01,242 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:39:01,248 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:39:01,401 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:39:01,446 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:39:02,280 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:39:02,284 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298084775393.9212409550592.d984bdbd1aebe28837d200259e3eddb2', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298084769681/0CLwvGIOr55GFTxQIvj8z3XX', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951141.997539'}]}
2025-07-31 11:39:02,360 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:39:02,362 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:39:02,378 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-31 11:39:03,291 - app.services.slack_service - ERROR - open_modal:144 - Slack API error opening modal: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:39:03,295 - app.handlers.command_handler - ERROR - handle_open_update_modal_action:398 - Error handling open update modal action: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\slack-bot\app\handlers\command_handler.py", line 393, in handle_open_update_modal_action
    slack_service.open_modal(trigger_id, modal)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\app\services\slack_service.py", line 135, in open_modal
    response = self.client.views_open(
        trigger_id=trigger_id,
        view=modal
    )
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\client.py", line 4606, in views_open
    return self.api_call("views.open", json=kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 156, in api_call
    return self._sync_send(api_url=api_url, req_args=req_args)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 187, in _sync_send
    return self._urllib_api_call(
           ~~~~~~~~~~~~~~~~~~~~~^
        token=token,
        ^^^^^^^^^^^^
    ...<5 lines>...
        additional_headers=headers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\base_client.py", line 317, in _urllib_api_call
    ).validate()
      ~~~~~~~~^^
  File "C:\Users\dell\Desktop\slack-bot\.venv\Lib\site-packages\slack_sdk\web\slack_response.py", line 199, in validate
    raise e.SlackApiError(message=msg, response=self)
slack_sdk.errors.SlackApiError: The request to the Slack API failed. (url: https://www.slack.com/api/views.open)
The server responded with: {'ok': False, 'error': 'invalid_arguments', 'response_metadata': {'messages': ['[ERROR] failed to match all allowed schemas [json-pointer:/view]', '[ERROR] failed to match all allowed schemas [json-pointer:/view/title]', '[ERROR] must be less than 25 characters [json-pointer:/view/title/text]']}}
2025-07-31 11:39:03,377 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:39:03] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:39:51,593 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:39:52,256 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:39:53,795 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:39:53,796 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:39:55,012 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:39:55,018 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:39:55,026 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:39:55,034 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:39:55,114 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:39:55,123 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:40:02,853 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:40:03,064 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:40:03,915 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:40:03,917 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:40:05,934 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:40:05,940 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:40:05,953 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:40:05,959 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:40:06,042 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:40:06,058 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:40:10,446 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:40:10,448 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279828927622.9212409550592.eb1f757f168b365731a8690b925e4025', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279828851878/oFZdvGZfcH9WBshTZCHcMWCv', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951210.347445'}]}
2025-07-31 11:40:10,456 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:40:10,456 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:40:10,457 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-31 11:40:12,064 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279828927622.9212409550592.eb1f757f168b365731a8690b925e4025
2025-07-31 11:40:12,068 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:40:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:40:28,016 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:40:28,016 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298091308833.9212409550592.9256630901b5125c85f88a5efddc9b06', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298091231473/J7X5AqKUXTmnzlhyBGAli88A', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951227.582905'}]}
2025-07-31 11:40:28,026 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:40:28,027 - app.handlers.command_handler - INFO - handle_open_update_modal_action:374 - Handling open update modal action
2025-07-31 11:40:28,028 - app.handlers.command_handler - INFO - handle_open_update_modal_action:384 - Opening update modal for source: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, params: {'sheet_id': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}
2025-07-31 11:40:28,811 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9298091308833.9212409550592.9256630901b5125c85f88a5efddc9b06
2025-07-31 11:40:28,812 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:40:28] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:40:42,725 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:40:42,727 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279831875974.9212409550592.0d59718dfd8fd679cafdcb78114ce919', 'view': {'id': 'V098ATTP482', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'task'}}}}, 'hash': '1753951228.L1OJkoNe', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098ATTP482', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 11:40:42,731 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 11:40:42,732 - app.handlers.command_handler - INFO - handle_view_submission:577 - Modal submission received
2025-07-31 11:40:42,733 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:602 - Handling write data modal submission
2025-07-31 11:40:42,735 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:635 - Modal values - Sheet ID: 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c, Row: 1, Col: A, Value: task
2025-07-31 11:40:42,753 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:40:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:40:42,867 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:40:48,217 - app.services.google_service - INFO - write_sheet_data:353 - Wrote data to sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c at range A1
2025-07-31 11:40:49,049 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:40:54,424 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:40:54,425 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951052.596449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281125012373.9212409550592.c2d884168a37ed58663bd15a0e2ab4e0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753951052.596449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'nK/MQ', 'text': {'type': 'mrkdwn', 'text': '*Data from 1H-GXLBQ4TD2F-7QT4OZACXWDP8F5PABVXEZBBDE0M_C*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'buvKU'}, {'type': 'section', 'block_id': 'Qo7OK', 'text': {'type': 'mrkdwn', 'text': '*`Tasks | Status | Owner | Stage | Due date | Notes`*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Lk9Yp', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'mjuW1', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'Y5yMP', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'CnQVP', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'vh9FX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281124970709/TvbddSY5Vs3eU5GBpAivCyKS', 'actions': [{'action_id': 'refresh_data', 'block_id': 'vh9FX', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c", "params": {"sheet_id": "1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c"}}', 'type': 'button', 'action_ts': '1753951254.322544'}]}
2025-07-31 11:40:54,438 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:40:54,438 - app.handlers.command_handler - INFO - handle_refresh_data_action:302 - Handling refresh data action
2025-07-31 11:40:54,455 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:40:54] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:40:54,595 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:40:58,207 - app.services.google_service - INFO - read_sheet_data:303 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 11:40:59,057 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:41:18,442 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:41:18,443 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:41:18] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:41:31,053 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:41:31,055 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753951278.846329', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304883187136.9212409550592.86a4f8e1fd482f918395c6cb57b488c1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753951278.846329', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304883161728/0UkUDy7xqQjEBnEtFBaT5WVC', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'onA1j', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753951290.954283'}]}
2025-07-31 11:41:31,071 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:41:31,072 - app.handlers.command_handler - INFO - handle_list_excel_action:407 - Handling list Excel action
2025-07-31 11:41:31,078 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:41:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:41:31,152 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:41:34,317 - app.services.google_service - INFO - list_available_excel_files:792 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:41:35,767 - app.services.google_service - INFO - list_available_excel_files:804 - Found 1 Excel files in folder
2025-07-31 11:41:36,651 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:42:52,013 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:42:52,954 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:42:56,200 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:42:56,201 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:42:57,695 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:42:57,702 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:42:57,713 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:42:57,725 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:42:57,875 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:42:57,885 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:43:27,403 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:43:27,677 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:43:29,027 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:43:29,028 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:43:30,689 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:43:30,694 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:43:30,704 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:43:30,708 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:43:30,784 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:43:30,791 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:43:54,291 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:43:54,910 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:43:56,741 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:43:56,753 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:43:58,010 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:43:58,015 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:43:58,031 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:43:58,036 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:43:58,105 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:43:58,117 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:45:27,533 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:45:27,709 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:45:28,711 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:45:28,712 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:45:32,794 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:45:32,799 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:45:32,810 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:45:32,817 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:45:32,914 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:45:32,929 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:45:44,529 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:45:45,034 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:45:46,973 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:45:46,974 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:45:48,013 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:45:48,018 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:45:48,027 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:45:48,031 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:45:48,130 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:45:48,144 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:46:09,408 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:46:09,787 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:46:11,917 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:46:11,918 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:46:13,317 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:46:13,323 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:46:13,331 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:46:13,350 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:46:13,420 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:46:13,429 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:47:23,954 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:47:24,185 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:47:25,085 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:47:25,088 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:47:26,538 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:47:26,555 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:47:26,603 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:47:26,630 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:47:26,750 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:47:26,763 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:49:34,712 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:49:35,098 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:49:36,883 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:49:36,980 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:49:40,141 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:49:40,147 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:49:40,158 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:49:40,168 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:49:40,247 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:49:40,261 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:51:56,353 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:51:56,942 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:51:58,208 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:51:58,208 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:51:59,200 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:51:59,208 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:51:59,218 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:51:59,224 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:51:59,358 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:51:59,365 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:52:17,591 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:52:18,000 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:52:20,695 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:52:20,696 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:52:21,874 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:52:21,879 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:52:21,890 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:52:21,894 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:52:21,999 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:52:22,007 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:53:07,582 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:53:08,915 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:53:10,609 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:53:10,610 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:53:11,628 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:53:11,634 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:53:11,644 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:53:11,651 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:53:11,798 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:53:11,814 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:53:41,549 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:53:41,781 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:53:43,771 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:53:43,772 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:53:44,750 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:53:44,756 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:53:44,767 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:53:44,776 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:53:44,898 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:53:44,911 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:54:15,569 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 11:54:15,570 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:54:15] "POST /api/command HTTP/1.1" 200 -
2025-07-31 11:54:21,841 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:54:21,843 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952055.984189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281185514581.9212409550592.428749ee6389c2a8b0ca60cc44ec95fc', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952055.984189', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281185484005/v87sAenyAJNxl15ElWod8Bpz', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'onA1j', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952061.577671'}]}
2025-07-31 11:54:21,866 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:54:21,869 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 11:54:21,946 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:54:21] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:54:22,078 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:54:25,141 - app.services.google_service - INFO - list_available_excel_files:857 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:54:26,637 - app.services.google_service - INFO - list_available_excel_files:869 - Found 1 Excel files in folder
2025-07-31 11:54:27,531 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:54:30,951 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:54:30,952 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952067.538839', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284268431012.9212409550592.4c35668491042e402ecc6facb72437f6', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952067.538839', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'sXElQ', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': '0xhHh'}, {'type': 'section', 'block_id': 'tkU7G', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284268410820/JzeF16EsDI0kAQelsQ20yjvD', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'tkU7G', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753952070.685173'}]}
2025-07-31 11:54:30,958 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:54:30,959 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 11:54:30,962 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:54:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:54:31,085 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:54:37,004 - app.services.google_service - ERROR - read_excel_by_file_id:610 - Error reading Excel from Drive by file ID: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 11:54:37,007 - app.handlers.command_handler - ERROR - fetch_and_send_excel_data:355 - Error fetching Excel data: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 11:54:37,775 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:55:31,534 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:55:32,613 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:55:37,344 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:55:37,346 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:55:44,205 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:55:44,222 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:55:44,248 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:55:44,269 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:55:44,455 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:55:44,473 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:55:50,684 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:55:51,848 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:55:53,958 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:55:53,958 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:55:55,376 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:55:55,384 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:55:55,397 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:55:55,413 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:55:55,486 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:55:55,497 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:56:14,767 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 11:56:15,030 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:56:16,012 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:56:16,016 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:56:17,847 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:56:17,852 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:17,861 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:17,869 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:56:17,951 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:56:17,971 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:56:37,800 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:56:38,680 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:56:39,992 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:56:39,993 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:56:41,261 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:56:41,275 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:41,297 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:41,329 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:56:41,483 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:56:41,524 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:56:54,921 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 11:56:55,386 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:56:56,233 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:56:56,234 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:56:57,290 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:56:57,296 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:57,309 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:56:57,323 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:56:57,389 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:56:57,403 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:57:11,808 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:57:11,810 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952055.984189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267866309687.9212409550592.c335eb473c9287ab93b47fef40a31197', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952055.984189', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': 'xp6EE', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': '9rIhi'}, {'type': 'section', 'block_id': 'RXHsf', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '0+XgR', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'ARAGY'}, {'type': 'section', 'block_id': 'onA1j', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': 'Od+FJ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'iIutE'}, {'type': 'section', 'block_id': 'xJHJT', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': '5OKIG', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267866141911/6M5ZxWQIC2STHGl2lTW88HWg', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'onA1j', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952230.991583'}]}
2025-07-31 11:57:11,818 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:57:11,818 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 11:57:11,820 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:57:11] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:57:11,906 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:57:15,533 - app.services.google_service - INFO - list_available_excel_files:895 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 11:57:17,085 - app.services.google_service - INFO - list_available_excel_files:907 - Found 1 Excel files in folder
2025-07-31 11:57:17,962 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:57:23,454 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 11:57:23,454 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952238.011029', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279167015091.9212409550592.9d6dcfd0258d0cff497c2c7783643157', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952238.011029', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'l40kg', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'rZbvi'}, {'type': 'section', 'block_id': 'zYc7g', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279166973363/Gbw0wBC4sGE5ftwb4J74K79J', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zYc7g', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753952243.165510'}]}
2025-07-31 11:57:23,462 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 11:57:23,463 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 11:57:23,466 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 11:57:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 11:57:23,593 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:57:29,329 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 11:58:18,826 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:58:20,342 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:58:23,260 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:58:23,261 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:58:24,795 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:58:24,800 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:58:24,809 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:58:24,815 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:58:24,940 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:58:24,950 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:58:52,275 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:58:58,171 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:59:11,445 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:59:11,446 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:59:38,055 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:59:38,073 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:59:38,103 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:59:38,128 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:59:38,513 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:59:38,535 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 11:59:43,572 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 11:59:44,438 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 11:59:47,523 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 11:59:47,524 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 11:59:49,193 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 11:59:49,201 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:59:49,219 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 11:59:49,229 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 11:59:49,811 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 11:59:49,854 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:00:50,113 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:00:50,114 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952238.011029', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9304977272096.9212409550592.246cf06d849f58aa7738102efa505329', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952238.011029', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'l40kg', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'rZbvi'}, {'type': 'section', 'block_id': 'zYc7g', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9304977212624/Lq37dAOmAfJX52lqtfdpdoqA', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zYc7g', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753952449.781236'}]}
2025-07-31 12:00:50,119 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:00:50,121 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:00:50,143 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:00:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:00:50,432 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:00:58,875 - app.services.google_service - INFO - read_excel_by_file_id:602 - Processing Excel file: sales report.xlsx, extension: '', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
2025-07-31 12:00:58,876 - app.services.google_service - WARNING - read_excel_by_file_id:634 - openpyxl failed for sales report.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:00:58,878 - app.services.google_service - ERROR - read_excel_by_file_id:699 - Error reading Excel from Drive by file ID: File has no extension. Please ensure the file is a valid Excel file (.xlsx, .xlsm, .xltx, .xltm). File name: sales report.xlsx, MIME type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
2025-07-31 12:00:58,881 - app.handlers.command_handler - ERROR - fetch_and_send_excel_data:355 - Error fetching Excel data: File has no extension. Please ensure the file is a valid Excel file (.xlsx, .xlsm, .xltx, .xltm). File name: sales report.xlsx, MIME type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
2025-07-31 12:00:59,802 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:02:38,376 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:02:39,647 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:02:42,449 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:02:42,450 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:02:44,443 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:02:46,178 - app.services.google_service - INFO - _get_oauth_credentials:63 - Refreshed OAuth2 token
2025-07-31 12:02:46,191 - app.services.google_service - INFO - _get_oauth_credentials:88 - Saved OAuth2 token to file
2025-07-31 12:02:46,202 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:02:46,234 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:02:46,251 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:02:46,468 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:02:46,479 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:02:54,115 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:02:55,536 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:02:57,574 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:02:57,575 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:02:59,044 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:02:59,053 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:02:59,068 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:02:59,077 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:02:59,189 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:02:59,207 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:03:16,729 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:03:17,905 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:03:20,361 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:03:20,362 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:03:21,941 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:03:21,947 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:03:21,956 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:03:21,959 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:03:22,043 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:03:22,057 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:03:38,212 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:03:39,694 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:03:41,684 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:03:41,685 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:03:43,107 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:03:43,116 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:03:43,134 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:03:43,145 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:03:43,291 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:03:43,309 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:04:01,920 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:04:01,920 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952067.538839', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279207587395.9212409550592.e9e7330882d3033d49fc089b1799923f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952067.538839', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'sXElQ', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': '0xhHh'}, {'type': 'section', 'block_id': 'tkU7G', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279207549155/awasl7osjdu2XRqr9Om4GFFw', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'tkU7G', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753952641.656114'}]}
2025-07-31 12:04:01,924 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:04:01,927 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:04:01,930 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:04:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:04:02,114 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:04:08,334 - app.services.google_service - INFO - read_excel_by_file_id:602 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
2025-07-31 12:04:08,335 - app.services.google_service - WARNING - read_excel_by_file_id:639 - openpyxl failed for sales report.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:04:09,454 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:04:19,163 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 12:04:19,164 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:04:19] "POST /api/command HTTP/1.1" 200 -
2025-07-31 12:04:25,166 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:04:25,167 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952659.581089', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9267912337431.9212409550592.a376e3ede9940c2d91e61d3222036f6b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952659.581089', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9267912308391/IpyqSJJ50uKnwFC0MOQ6JOi0', 'actions': [{'action_id': 'list_csv_menu', 'block_id': 'L+vd+', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952664.814295'}]}
2025-07-31 12:04:25,184 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:04:25,193 - app.handlers.command_handler - INFO - handle_list_csv_action:640 - Handling list CSV action
2025-07-31 12:04:25,196 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:04:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:04:25,408 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:04:28,676 - app.services.google_service - INFO - list_available_csv_files:999 - Searching for CSV files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:04:29,157 - app.services.google_service - INFO - list_available_csv_files:1011 - Found 2 CSV files in folder
2025-07-31 12:04:29,922 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:04:34,726 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:04:34,727 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952669.973619', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284328023588.9212409550592.9b5df3d236804b249ac72a0d30d547f7', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952669.973619', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'gM5cz', 'text': {'type': 'plain_text', 'text': ':clipboard: Available CSV Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'FExJh'}, {'type': 'section', 'block_id': 'pFO7j', 'text': {'type': 'mrkdwn', 'text': '*1. sales data.csv*\n:id: `1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq'}}, {'type': 'divider', 'block_id': 'oVWgS'}, {'type': 'section', 'block_id': '6z1qI', 'text': {'type': 'mrkdwn', 'text': '*2. sales data.csv*\n:id: `19fleNBSfueW7oyr7VGf__CpmasYMNdkV`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/19fleNBSfueW7oyr7VGf__CpmasYMNdkV/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_19fleNBSfueW7oyr7VGf__CpmasYMNdkV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '19fleNBSfueW7oyr7VGf__CpmasYMNdkV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284328023508/DjbQO4j4ZEGAtcL5qHsSDU3i', 'actions': [{'action_id': 'get_data_csv_19fleNBSfueW7oyr7VGf__CpmasYMNdkV', 'block_id': '6z1qI', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '19fleNBSfueW7oyr7VGf__CpmasYMNdkV', 'type': 'button', 'action_ts': '1753952674.564501'}]}
2025-07-31 12:04:34,740 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:04:34,740 - app.handlers.command_handler - INFO - handle_get_data_csv_action:378 - Handling get data CSV action
2025-07-31 12:04:34,742 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:04:34] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:04:34,834 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:04:38,458 - app.services.google_service - INFO - read_csv_by_file_id:465 - Read 0 rows from CSV file ID: 19fleNBSfueW7oyr7VGf__CpmasYMNdkV
2025-07-31 12:04:39,217 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:06:20,861 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:06:22,088 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:06:23,999 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:06:23,999 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:06:25,087 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:06:25,095 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:06:25,105 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:06:25,111 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:06:25,194 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:06:25,207 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:06:38,324 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:06:39,027 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:06:41,302 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:06:41,303 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:06:42,342 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:06:42,349 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:06:42,359 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:06:42,363 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:06:42,445 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:06:42,459 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:06:54,642 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:06:55,858 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:06:59,578 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:06:59,579 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:07:01,438 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:07:01,446 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:07:01,463 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:07:01,467 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:07:01,553 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:07:01,562 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:07:07,664 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:07:08,479 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:07:10,939 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:07:10,939 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:07:13,171 - app.services.google_service - INFO - _get_oauth_credentials:54 - Loaded OAuth2 token from file
2025-07-31 12:07:13,177 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:07:13,201 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:07:13,206 - app.services.google_service - INFO - _init_google_clients:243 - Google API clients initialized with OAuth2
2025-07-31 12:07:13,294 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:07:13,311 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:08:56,295 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 12:08:56,297 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:08:56] "POST /api/command HTTP/1.1" 200 -
2025-07-31 12:09:01,846 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:09:01,847 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952936.702259', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279234169987.9212409550592.dd25057525be8ecc4739c2b748735e68', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952936.702259', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279234158755/20fyiUfZcr3lxc9vkfT2C0sw', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952941.550025'}]}
2025-07-31 12:09:01,852 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:09:01,853 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 12:09:01,854 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:09:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:09:02,018 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:09:04,954 - app.services.google_service - INFO - list_available_excel_files:977 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:09:06,402 - app.services.google_service - INFO - list_available_excel_files:989 - Found 1 Excel files in folder
2025-07-31 12:09:07,316 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:09:12,689 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:09:12,689 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952947.336699', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279983510582.9212409550592.20eb75d4cba354589a5e7a812363fb50', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753952947.336699', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'l40kg', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'rZbvi'}, {'type': 'section', 'block_id': 'zYc7g', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279983509414/l1dJ2bpuyzHD10rJ8H9teMt0', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zYc7g', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753952952.362429'}]}
2025-07-31 12:09:12,691 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:09:12,692 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:09:12,693 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:09:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:09:12,792 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:09:17,434 - app.services.google_service - INFO - read_excel_by_file_id:603 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4765
2025-07-31 12:09:17,435 - app.services.google_service - WARNING - read_excel_by_file_id:640 - openpyxl failed for sales report.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:09:18,404 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:09:32,650 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:09:32,653 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952936.702259', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279236168883.9212409550592.3c135dcf26ed0a7a81a6fafa85deb764', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952936.702259', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279236168723/kkR47k8G1SsGUekFeuLdbKHo', 'actions': [{'action_id': 'create_excel_menu', 'block_id': '964TQ', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952972.371571'}]}
2025-07-31 12:09:32,662 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:09:32,663 - app.handlers.command_handler - INFO - handle_create_excel_action:617 - Handling create Excel action
2025-07-31 12:09:33,450 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279236168883.9212409550592.3c135dcf26ed0a7a81a6fafa85deb764
2025-07-31 12:09:33,456 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:09:33] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:09:44,602 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:09:44,604 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9305020816560.9212409550592.9de9ca76cc2f7930f86dd2f053485ccf', 'view': {'id': 'V09876YCCAF', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'title_block', 'label': {'type': 'plain_text', 'text': 'File Name', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'title_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter file name (e.g., Sales Report)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'template_block', 'label': {'type': 'plain_text', 'text': 'Template', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'static_select', 'action_id': 'template_input', 'placeholder': {'type': 'plain_text', 'text': 'Select a template', 'emoji': True}, 'options': [{'text': {'type': 'plain_text', 'text': 'Empty', 'emoji': True}, 'value': 'empty'}, {'text': {'type': 'plain_text', 'text': 'Sales Report', 'emoji': True}, 'value': 'sales'}, {'text': {'type': 'plain_text', 'text': 'Inventory', 'emoji': True}, 'value': 'inventory'}, {'text': {'type': 'plain_text', 'text': 'Project Tracker', 'emoji': True}, 'value': 'project'}]}}], 'private_metadata': '', 'callback_id': 'create_excel_modal', 'state': {'values': {'title_block': {'title_input': {'type': 'plain_text_input', 'value': 'abc'}}, 'template_block': {'template_input': {'type': 'static_select', 'selected_option': {'text': {'type': 'plain_text', 'text': 'Empty', 'emoji': True}, 'value': 'empty'}}}}}, 'hash': '1753952973.gC4qjgt9', 'title': {'type': 'plain_text', 'text': 'Create Excel File', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Create', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09876YCCAF', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 12:09:44,612 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 12:09:44,613 - app.handlers.command_handler - INFO - handle_view_submission:725 - Modal submission received
2025-07-31 12:09:44,614 - app.handlers.command_handler - INFO - handle_create_excel_modal_submission:975 - Handling create Excel modal submission
2025-07-31 12:09:44,615 - app.handlers.command_handler - INFO - handle_create_excel_modal_submission:983 - Modal values - Title: abc, Template: empty
2025-07-31 12:09:44,618 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:09:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:09:44,807 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:09:50,397 - app.services.google_service - INFO - write_excel_to_drive:787 - Created new Excel file: abc.xlsx (ID: 1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV)
2025-07-31 12:09:50,400 - app.services.google_service - WARNING - write_excel_to_drive:813 - Could not delete temp file C:\Users\dell\AppData\Local\Temp\tmpl1my16im.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpl1my16im.xlsx'
2025-07-31 12:09:51,139 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:09:57,684 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:09:57,685 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753952936.702259', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279987072438.9212409550592.28710b2b0828a59c97e52077695ab86b', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753952936.702259', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279987036422/2KGaVTr55cizhQYnx66I9tZ1', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753952997.367753'}]}
2025-07-31 12:09:57,697 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:09:57,698 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 12:09:57,702 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:09:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:09:57,820 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:10:00,834 - app.services.google_service - INFO - list_available_excel_files:977 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:10:01,353 - app.services.google_service - INFO - list_available_excel_files:989 - Found 2 Excel files in folder
2025-07-31 12:10:02,162 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:10:07,960 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:10:07,961 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753953002.176629', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279988631910.9212409550592.d61ba9c8cf13e3847e2c179c934ec46d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753953002.176629', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': '9FNRB', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'xlM2h'}, {'type': 'section', 'block_id': 'hw3UY', 'text': {'type': 'mrkdwn', 'text': '*1. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}, {'type': 'divider', 'block_id': 'a9grW'}, {'type': 'section', 'block_id': 'Fqwkl', 'text': {'type': 'mrkdwn', 'text': '*2. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279988625174/DBDAmwrDL3gDfkde3wEP66rs', 'actions': [{'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'block_id': 'hw3UY', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'type': 'button', 'action_ts': '1753953007.626169'}]}
2025-07-31 12:10:07,965 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:10:07,966 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:10:07,991 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:10:07] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:10:08,087 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:10:12,834 - app.services.google_service - INFO - read_excel_by_file_id:603 - Processing Excel file: abc.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4765
2025-07-31 12:10:12,835 - app.services.google_service - WARNING - read_excel_by_file_id:640 - openpyxl failed for abc.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:10:13,883 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:12:25,235 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:12:25,238 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753953002.176629', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279998301510.9212409550592.d3c678916ab3ccbade9c38f2def605d9', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753953002.176629', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': '9FNRB', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'xlM2h'}, {'type': 'section', 'block_id': 'hw3UY', 'text': {'type': 'mrkdwn', 'text': '*1. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}, {'type': 'divider', 'block_id': 'a9grW'}, {'type': 'section', 'block_id': 'Fqwkl', 'text': {'type': 'mrkdwn', 'text': '*2. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279998301430/yWSOZHiFvCbMxmtPR872U4cd', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'Fqwkl', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753953144.951938'}]}
2025-07-31 12:12:25,264 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:12:25,265 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:12:25,277 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:12:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:12:25,465 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:12:30,776 - app.services.google_service - INFO - read_excel_by_file_id:603 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 8450
2025-07-31 12:12:30,780 - app.services.google_service - WARNING - read_excel_by_file_id:640 - openpyxl failed for sales report.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:12:32,482 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:14:14,297 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:14:16,211 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:14:18,622 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:14:18,624 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:14:20,326 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:14:20,460 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:14:20,469 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:14:20,485 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:14:20,489 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:14:20,598 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:14:20,615 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:14:29,833 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:14:31,312 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:14:33,333 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:14:33,334 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:14:34,781 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:14:34,866 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:14:34,873 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:14:34,882 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:14:34,887 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:14:35,006 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:14:35,020 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:16:27,576 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:16:28,728 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:16:32,616 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:16:32,617 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:16:34,647 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:16:34,791 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:16:34,806 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:16:34,825 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:16:34,831 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:16:34,963 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:16:34,976 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:16:45,305 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:16:46,452 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:16:48,720 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:16:48,720 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:16:50,117 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:16:50,195 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:16:50,201 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:16:50,211 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:16:50,215 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:16:50,317 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:16:50,335 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:17:00,879 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:17:01,897 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:17:05,330 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:17:05,338 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:17:07,296 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:17:07,407 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:17:07,418 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:17:07,433 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:17:07,440 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:17:07,534 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:17:07,546 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:17:16,595 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:17:17,893 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:17:20,598 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:17:20,598 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:28:09,080 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:28:09,083 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:28:10,666 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:28:10,753 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:28:10,759 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:10,772 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:10,777 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:28:10,910 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 12:28:10,911 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 12:28:10,914 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:28:11,573 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:28:11,574 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:28:12,623 - root - WARNING - <module>:28 - pandas not available - Excel reading fallback disabled
2025-07-31 12:28:12,696 - app.services.google_service - INFO - _get_oauth_credentials:62 - Loaded OAuth2 token from file
2025-07-31 12:28:12,701 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:12,717 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:12,724 - app.services.google_service - INFO - _init_google_clients:251 - Google API clients initialized with OAuth2
2025-07-31 12:28:12,795 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:28:12,804 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:28:29,973 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 12:28:29,977 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:28:29] "POST /api/command HTTP/1.1" 200 -
2025-07-31 12:28:37,931 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:28:37,934 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954110.437909', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283176479714.9212409550592.2bbe6828946b41b9d7a5b7a08e4e73da', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753954110.437909', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283176478674/3hSNQnCcH4iuYsEKBOyVeXF7', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753954117.608822'}]}
2025-07-31 12:28:37,968 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:28:37,969 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 12:28:37,971 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:28:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:28:38,185 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:42,423 - app.services.google_service - INFO - list_available_excel_files:1030 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:28:44,214 - app.services.google_service - INFO - list_available_excel_files:1042 - Found 2 Excel files in folder
2025-07-31 12:28:45,256 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:28:48,707 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:28:48,709 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954125.282029', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279332810467.9212409550592.d035abad406bd17403070585b7886b53', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954125.282029', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279332805107/V9E0ngVnNmZjGyL8eABhyL7P', 'actions': [{'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'block_id': 'jHgrE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'type': 'button', 'action_ts': '1753954128.638182'}]}
2025-07-31 12:28:48,774 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:28:48,793 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:28:48,812 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:28:48] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:28:48,977 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:28:54,822 - app.services.google_service - INFO - read_excel_by_file_id:611 - Processing Excel file: abc.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4765
2025-07-31 12:28:54,825 - app.services.google_service - WARNING - read_excel_by_file_id:648 - openpyxl failed for abc.xlsx: openpyxl does not support  file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-07-31 12:28:56,108 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:35:31,049 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:35:31,050 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:35:35,235 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:35:35,240 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:35:35,253 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:35:35,257 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:35:35,350 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 12:35:35,351 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 12:35:35,353 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:35:36,010 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:35:36,011 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:35:37,323 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:35:37,329 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:35:37,339 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:35:37,345 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:35:37,427 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:35:37,443 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:35:50,315 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 12:35:50,326 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:35:50] "POST /api/command HTTP/1.1" 200 -
2025-07-31 12:35:56,858 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:35:56,858 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954550.806469', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280115163654.9212409550592.c18882a7def34877681a17ba409088f4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753954550.806469', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280115144454/pXxnHJrvL8QYV54TYPbvEoK8', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753954556.575746'}]}
2025-07-31 12:35:56,889 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:35:56,903 - app.handlers.command_handler - INFO - handle_list_excel_action:555 - Handling list Excel action
2025-07-31 12:35:56,937 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:35:56] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:35:57,038 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:35:59,973 - app.services.google_service - INFO - list_available_excel_files:1019 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:36:01,493 - app.services.google_service - INFO - list_available_excel_files:1031 - Found 2 Excel files in folder
2025-07-31 12:36:02,375 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:36:05,741 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:36:05,742 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954562.417759', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268074199159.9212409550592.f0ac74fac9c63558835dc6d449419511', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954562.417759', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268074056023/nUavTvMCFSv1sGqzUUPpZa34', 'actions': [{'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'block_id': 'jHgrE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'type': 'button', 'action_ts': '1753954565.598842'}]}
2025-07-31 12:36:05,749 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:36:05,750 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:36:05,763 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:36:05] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:36:05,879 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:36:10,717 - app.services.google_service - INFO - read_excel_by_file_id:609 - Processing Excel file: abc.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4765
2025-07-31 12:36:11,193 - app.services.google_service - INFO - _read_excel_with_pandas:763 - Successfully read Excel file with pandas: 1 rows
2025-07-31 12:36:11,194 - app.services.google_service - INFO - read_excel_by_file_id:638 - Successfully read Excel file with pandas: abc.xlsx
2025-07-31 12:36:11,194 - app.services.google_service - INFO - read_excel_by_file_id:682 - Read 1 rows from Excel file ID: 1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV
2025-07-31 12:36:11,975 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:36:19,900 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:36:19,900 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954572.023199', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284487779684.9212409550592.c73b58a02df17f4c349bf83400d11815', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954572.023199', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5Ozad', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'U1Mqd'}, {'type': 'section', 'block_id': 'uK91v', 'text': {'type': 'mrkdwn', 'text': '*``*', 'verbatim': False}}, {'type': 'actions', 'block_id': 'Vln8U', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284487756132/mPhLTGQXniKOJ5BIbjjO6lAL', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'Vln8U', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV"}}', 'type': 'button', 'action_ts': '1753954579.731300'}]}
2025-07-31 12:36:19,904 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:36:19,904 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:36:19,905 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: excel, params: {'file_id': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}
2025-07-31 12:36:20,699 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9284487779684.9212409550592.c73b58a02df17f4c349bf83400d11815
2025-07-31 12:36:20,701 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:36:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:36:40,301 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:36:40,302 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284489049428.9212409550592.e2c13bb8248234e3c1d23cd3c3aea42b', 'view': {'id': 'V0987B14W5R', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": null}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'name'}}}}, 'hash': '1753954580.NED7wW0H', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987B14W5R', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 12:36:40,313 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 12:36:40,314 - app.handlers.command_handler - INFO - handle_view_submission:725 - Modal submission received
2025-07-31 12:36:40,314 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:750 - Handling write data modal submission
2025-07-31 12:36:40,315 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:775 - No sheet_id found in private_metadata
2025-07-31 12:36:40,316 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:36:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:36:58,961 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:36:58,962 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283219747570.9212409550592.dc0e84b83c2cb81ef6af7c86571b9fc5', 'view': {'id': 'V0987B14W5R', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": null}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': 'a'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'name'}}}}, 'hash': '1753954580.NED7wW0H', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987B14W5R', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 12:36:58,965 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 12:36:58,965 - app.handlers.command_handler - INFO - handle_view_submission:725 - Modal submission received
2025-07-31 12:36:58,966 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:750 - Handling write data modal submission
2025-07-31 12:36:58,966 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:775 - No sheet_id found in private_metadata
2025-07-31 12:36:58,967 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:36:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:38:04,802 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 12:38:06,166 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:38:07,111 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:38:07,112 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:38:08,817 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:38:08,833 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:38:08,845 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:38:08,849 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:38:08,893 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:38:08,913 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:38:15,294 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:38:15,296 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954562.417759', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280128438134.9212409550592.4b82bb68f8ad72c4d5d3d12ed7b570d1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954562.417759', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280128431622/pLB65GKAW825Bva8luWuFBVK', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753954695.164346'}]}
2025-07-31 12:38:15,363 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:38:15,364 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:38:15,393 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:38:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:38:16,080 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:38:23,845 - app.services.google_service - INFO - read_excel_by_file_id:609 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 8450
2025-07-31 12:38:24,900 - app.services.google_service - INFO - _read_excel_with_pandas:763 - Successfully read Excel file with pandas: 2 rows
2025-07-31 12:38:24,901 - app.services.google_service - INFO - read_excel_by_file_id:638 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 12:38:24,903 - app.services.google_service - INFO - read_excel_by_file_id:682 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 12:38:25,742 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:38:48,111 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:38:49,751 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:38:53,713 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:38:53,738 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:38:57,787 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:38:57,792 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:38:57,801 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:38:57,805 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:38:57,881 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:38:57,892 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:40:02,343 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:40:03,478 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:40:05,459 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:40:05,460 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:40:07,689 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:40:07,696 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:40:07,708 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:40:07,712 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:40:07,767 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:40:07,779 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:40:25,774 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:40:25,775 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954705.799019', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284507111236.9212409550592.8dff9bca3e6cff889a3ceb264361b528', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954705.799019', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284507107268/lFLKK863rHwBb4pUfBFzMjfr', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753954825.685616'}]}
2025-07-31 12:40:25,783 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:40:25,784 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:40:25,784 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 12:40:26,819 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9284507111236.9212409550592.8dff9bca3e6cff889a3ceb264361b528
2025-07-31 12:40:26,821 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:40:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:40:32,523 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:40:32,811 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:40:33,553 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:40:33,554 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:40:36,014 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:40:36,019 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:40:36,031 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:40:36,043 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:40:36,167 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:40:36,177 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:41:22,627 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 12:41:22,629 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:41:22] "POST /api/command HTTP/1.1" 200 -
2025-07-31 12:41:29,414 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:41:29,415 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954883.059679', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268100989623.9212409550592.f3c2db540c0cebcc46326651f10bebe9', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753954883.059679', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268100989559/P4FdeYvG2D9uuYBr44uyGK7g', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '4dxlO', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753954889.338849'}]}
2025-07-31 12:41:29,427 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:41:29,428 - app.handlers.command_handler - INFO - handle_list_sheets_action:145 - Handling list sheets action
2025-07-31 12:41:29,430 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:41:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:41:29,579 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:41:32,602 - app.services.google_service - INFO - list_available_sheets:1102 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:41:34,132 - app.services.google_service - INFO - list_available_sheets:1114 - Found 5 Google Sheets in folder
2025-07-31 12:41:35,025 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:41:38,226 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:41:38,227 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954895.076619', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268101351031.9212409550592.e365ae0be25a71adb09f5b8569efa15d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954895.076619', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'AG752', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'ugEOC'}, {'type': 'section', 'block_id': 'cMVeG', 'text': {'type': 'mrkdwn', 'text': '*1. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}, {'type': 'divider', 'block_id': 'hMXnD'}, {'type': 'section', 'block_id': '3rnXM', 'text': {'type': 'mrkdwn', 'text': '*2. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'YAP8M'}, {'type': 'section', 'block_id': 'xeBhh', 'text': {'type': 'mrkdwn', 'text': '*3. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': '2cZDA'}, {'type': 'section', 'block_id': '6MuNk', 'text': {'type': 'mrkdwn', 'text': '*4. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}, {'type': 'divider', 'block_id': 'HsYI/'}, {'type': 'section', 'block_id': 'ctOO+', 'text': {'type': 'mrkdwn', 'text': '*5. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-30\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268101293591/hmpi2m2kr2mta3GC93O56n3R', 'actions': [{'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'block_id': 'ctOO+', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'type': 'button', 'action_ts': '1753954898.123924'}]}
2025-07-31 12:41:38,235 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:41:38,235 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:234 - Handling get data sheet action
2025-07-31 12:41:38,238 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:41:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:41:38,353 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:41:43,570 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-31 12:41:44,371 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:41:48,737 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:41:48,737 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954904.429189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279400538995.9212409550592.487b1787bc7f3eaf3b6805c2485701e1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954904.429189', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'OxYL/', 'text': {'type': 'mrkdwn', 'text': '*Data from 1DZ8FMOL4J0XM4LNMFHVSSSIWPW50EN8GLETLKUZRUQ0*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'nsNbe'}, {'type': 'section', 'block_id': 'xS7Ag', 'text': {'type': 'mrkdwn', 'text': '*Name | Age | Class*', 'verbatim': False}}, {'type': 'section', 'block_id': 'sjyyd', 'text': {'type': 'plain_text', 'text': 'mulugeta | 11 | 1A', 'emoji': True}}, {'type': 'actions', 'block_id': 'MTEDX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279400528435/0CkRbwT2QLPycZL63byOxS3V', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'MTEDX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}', 'type': 'button', 'action_ts': '1753954908.660705'}]}
2025-07-31 12:41:48,740 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:41:48,740 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:41:48,741 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, params: {'sheet_id': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}
2025-07-31 12:41:49,571 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279400538995.9212409550592.487b1787bc7f3eaf3b6805c2485701e1
2025-07-31 12:41:49,573 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:41:49] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:41:57,076 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:41:57,078 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954904.429189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298406536513.9212409550592.7b0e78f082a3e72d52a231c999539c2c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954904.429189', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'OxYL/', 'text': {'type': 'mrkdwn', 'text': '*Data from 1DZ8FMOL4J0XM4LNMFHVSSSIWPW50EN8GLETLKUZRUQ0*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'nsNbe'}, {'type': 'section', 'block_id': 'xS7Ag', 'text': {'type': 'mrkdwn', 'text': '*Name | Age | Class*', 'verbatim': False}}, {'type': 'section', 'block_id': 'sjyyd', 'text': {'type': 'plain_text', 'text': 'mulugeta | 11 | 1A', 'emoji': True}}, {'type': 'actions', 'block_id': 'MTEDX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298406530529/vMYfyxzwyevDbR1JJd9reaQu', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'MTEDX', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}', 'type': 'button', 'action_ts': '1753954916.787668'}]}
2025-07-31 12:41:57,081 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:41:57,081 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:41:57,082 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, params: {'sheet_id': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}
2025-07-31 12:41:57,902 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9298406536513.9212409550592.7b0e78f082a3e72d52a231c999539c2c
2025-07-31 12:41:57,904 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:41:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:42:15,295 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:42:15,296 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9305167532848.9212409550592.df214f8a9a7a5fc44a35e2a874d4a96f', 'view': {'id': 'V098SBY3SQH', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "source": "sheet"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'C'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '1C'}}}}, 'hash': '1753954917.1smK8pGq', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098SBY3SQH', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 12:42:15,299 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 12:42:15,299 - app.handlers.command_handler - INFO - handle_view_submission:733 - Modal submission received
2025-07-31 12:42:15,300 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:758 - Handling write data modal submission
2025-07-31 12:42:15,300 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:791 - Modal values - Sheet ID: 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0, Row: 2, Col: C, Value: 1C
2025-07-31 12:42:15,302 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:42:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:42:15,412 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:42:19,729 - app.services.google_service - INFO - write_sheet_data:359 - Wrote data to sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0 at range C2
2025-07-31 12:42:20,344 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:42:20,345 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954904.429189', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298407662849.9212409550592.ad44b4baabd0cebf9890a0db9c951d78', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954904.429189', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'OxYL/', 'text': {'type': 'mrkdwn', 'text': '*Data from 1DZ8FMOL4J0XM4LNMFHVSSSIWPW50EN8GLETLKUZRUQ0*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'nsNbe'}, {'type': 'section', 'block_id': 'xS7Ag', 'text': {'type': 'mrkdwn', 'text': '*Name | Age | Class*', 'verbatim': False}}, {'type': 'section', 'block_id': 'sjyyd', 'text': {'type': 'plain_text', 'text': 'mulugeta | 11 | 1A', 'emoji': True}}, {'type': 'actions', 'block_id': 'MTEDX', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298407644993/idR1E1gbsShM3ylmRT7dji8X', 'actions': [{'action_id': 'refresh_data', 'block_id': 'MTEDX', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0", "params": {"sheet_id": "1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0"}}', 'type': 'button', 'action_ts': '1753954940.233599'}]}
2025-07-31 12:42:20,348 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:42:20,348 - app.handlers.command_handler - INFO - handle_refresh_data_action:450 - Handling refresh data action
2025-07-31 12:42:20,350 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:42:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:42:20,457 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:42:20,507 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:42:24,569 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0
2025-07-31 12:42:25,362 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:42:33,907 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:42:33,907 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954883.059679', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305169531328.9212409550592.1a45ef9e8de2bf7806fb37f43d977641', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753954883.059679', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305169493360/kBZkhigiAQYewFV4huJtPYle', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753954953.656846'}]}
2025-07-31 12:42:33,912 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:42:33,913 - app.handlers.command_handler - INFO - handle_list_excel_action:563 - Handling list Excel action
2025-07-31 12:42:33,916 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:42:33] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:42:34,008 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:42:36,908 - app.services.google_service - INFO - list_available_excel_files:1143 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 12:42:37,529 - app.services.google_service - INFO - list_available_excel_files:1155 - Found 2 Excel files in folder
2025-07-31 12:42:38,325 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:42:46,724 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:42:46,726 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954958.388319', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268107256359.9212409550592.71c0916cbd9593c8e7f2c57c6dee9274', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954958.388319', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268107136343/yS154Lp1sxkN00giAydMGoIq', 'actions': [{'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'block_id': 'jHgrE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'type': 'button', 'action_ts': '1753954966.633142'}]}
2025-07-31 12:42:46,885 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:42:47,017 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:42:47,124 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:42:47] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:42:47,690 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:42:56,929 - app.services.google_service - INFO - read_excel_by_file_id:733 - Processing Excel file: abc.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4765
2025-07-31 12:42:59,512 - app.services.google_service - INFO - _read_excel_with_pandas:887 - Successfully read Excel file with pandas: 1 rows
2025-07-31 12:42:59,513 - app.services.google_service - INFO - read_excel_by_file_id:762 - Successfully read Excel file with pandas: abc.xlsx
2025-07-31 12:42:59,515 - app.services.google_service - INFO - read_excel_by_file_id:806 - Read 1 rows from Excel file ID: 1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV
2025-07-31 12:43:00,332 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:43:08,026 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:43:08,028 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954958.388319', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268108777495.9212409550592.3fabbe497daa840cf56b2762182cd9a4', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954958.388319', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268108777447/zr3kKjJ054dnHnGTsjkoYy9O', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753954987.745520'}]}
2025-07-31 12:43:08,053 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:43:08,059 - app.handlers.command_handler - INFO - handle_get_data_excel_action:306 - Handling get data Excel action
2025-07-31 12:43:08,068 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:43:08] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:43:08,211 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:43:14,088 - app.services.google_service - INFO - read_excel_by_file_id:733 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 8450
2025-07-31 12:43:14,182 - app.services.google_service - INFO - _read_excel_with_pandas:887 - Successfully read Excel file with pandas: 2 rows
2025-07-31 12:43:14,184 - app.services.google_service - INFO - read_excel_by_file_id:762 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 12:43:14,186 - app.services.google_service - INFO - read_excel_by_file_id:806 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 12:43:14,929 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 12:43:19,607 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:43:19,611 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298413057073.9212409550592.c4363f14338b3728941ee7aeaee85b1f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298413024913/0wyfLUkex8YJqYAGJ6XSxFhi', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753954999.489091'}]}
2025-07-31 12:43:19,641 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:43:19,644 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:43:19,656 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 12:43:20,546 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9298413057073.9212409550592.c4363f14338b3728941ee7aeaee85b1f
2025-07-31 12:43:20,555 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:43:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:43:43,437 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:43:44,196 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:43:45,222 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:43:45,224 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:43:47,612 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:43:47,625 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:43:47,659 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:43:47,673 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:43:47,770 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:43:47,783 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:43:56,302 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:43:56,304 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268113007095.9212409550592.f9f37e2d31b3dc08951fe216b4f95610', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268113006279/PMNNZSLB8SHsIZTCrNtXtL5l', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753955036.159936'}]}
2025-07-31 12:43:56,310 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:43:56,310 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:43:56,311 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 12:43:57,331 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268113007095.9212409550592.f9f37e2d31b3dc08951fe216b4f95610
2025-07-31 12:43:57,338 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:43:57] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:44:15,801 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:44:15,803 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9298417104593.9212409550592.0692476dd959c2add5fcfe4029798e80', 'view': {'id': 'V098Z54VBMW', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": null}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753955037.l7QP8pQD', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098Z54VBMW', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 12:44:15,821 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 12:44:15,822 - app.handlers.command_handler - INFO - handle_view_submission:725 - Modal submission received
2025-07-31 12:44:15,823 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:750 - Handling write data modal submission
2025-07-31 12:44:15,824 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:775 - No sheet_id found in private_metadata
2025-07-31 12:44:15,827 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:44:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:45:54,666 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:45:55,665 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:45:56,733 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:45:56,733 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:45:58,618 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:45:58,625 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:45:58,646 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:45:58,659 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:45:58,761 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:45:58,772 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:46:21,786 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:46:22,804 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:46:24,535 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:46:24,535 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:46:26,060 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:46:26,066 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:46:26,077 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:46:26,081 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:46:26,163 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:46:26,178 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:47:18,483 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:47:20,569 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:47:22,718 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:47:22,719 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:47:27,511 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:47:27,518 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:47:27,532 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:47:27,554 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:47:28,097 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:47:28,126 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:47:35,848 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:47:37,717 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:47:39,400 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:47:39,401 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:47:41,616 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:47:41,627 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:47:41,646 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:47:41,658 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:47:41,926 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:47:41,959 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:47:57,538 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 12:47:59,847 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:48:02,773 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:48:02,774 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:48:05,399 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:48:05,411 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:05,433 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:05,446 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:48:05,547 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:48:05,574 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:48:35,847 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 12:48:37,259 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:48:40,739 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:48:40,739 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:48:42,695 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:48:42,705 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:42,722 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:42,728 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:48:42,846 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:48:42,865 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:48:51,242 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 12:48:51,551 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:48:53,071 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:48:53,072 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:48:54,733 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 12:48:54,738 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:54,748 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 12:48:54,753 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 12:48:54,839 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 12:48:54,861 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 12:49:40,760 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 12:49:40,762 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305200704656.9212409550592.3fad1eb0e4139d9e042c697eba3bf317', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305200646256/b93iT4nPhdc2k9NE558V7XmM', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753955380.415623'}]}
2025-07-31 12:49:40,781 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 12:49:40,783 - app.handlers.command_handler - INFO - handle_open_update_modal_action:522 - Handling open update modal action
2025-07-31 12:49:40,784 - app.handlers.command_handler - INFO - handle_open_update_modal_action:532 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 12:49:41,778 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9305200704656.9212409550592.3fad1eb0e4139d9e042c697eba3bf317
2025-07-31 12:49:41,783 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 12:49:41] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 12:51:33,720 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 12:51:34,097 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 12:51:37,673 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:51:37,674 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:52:24,126 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:52:24,127 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:52:29,268 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:52:29,268 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:55:57,722 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:55:57,723 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:58:18,872 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:58:18,872 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 12:59:55,774 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 12:59:55,775 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:01:05,079 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:01:05,080 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:02:28,136 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:02:28,137 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:03:29,318 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:03:29,320 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:03:30,977 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:03:32,283 - app.services.google_service - INFO - _get_oauth_credentials:69 - Refreshed OAuth2 token
2025-07-31 13:03:32,285 - app.services.google_service - INFO - _get_oauth_credentials:94 - Saved OAuth2 token to file
2025-07-31 13:03:32,291 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:03:32,301 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:03:32,306 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:03:32,426 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:03:32,428 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:03:32,432 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:03:33,157 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:03:33,158 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:03:34,607 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:03:34,613 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:03:34,627 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:03:34,638 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:03:34,793 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:03:34,800 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:03:41,121 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:03:41,128 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283342183362.9212409550592.5ca6386bfb9a849d6c4d5128acaa79ef', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283342183282/MElR6LHKDOHvStt3sUbq5Jxq', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956220.929040'}]}
2025-07-31 13:03:41,257 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:03:41,312 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:03:41,393 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:03:42,478 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283342183362.9212409550592.5ca6386bfb9a849d6c4d5128acaa79ef
2025-07-31 13:03:42,489 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:03:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:03:54,171 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:03:54,173 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268215808359.9212409550592.93265ed68c7e91289ed69895fda20640', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268215792679/Jf10BR5FKZigMiokU1JKDd1j', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956233.915436'}]}
2025-07-31 13:03:54,184 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:03:54,185 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:03:54,191 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:03:54,966 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268215808359.9212409550592.93265ed68c7e91289ed69895fda20640
2025-07-31 13:03:54,967 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:03:54] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:04:12,033 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:04:12,035 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9298516424529.9212409550592.b688718066a0ef3d8ea7efc93c2bfa44', 'view': {'id': 'V097W6B9287', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753956235.nopnJqs0', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097W6B9287', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:04:12,047 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:04:12,049 - app.handlers.command_handler - INFO - handle_view_submission:728 - Modal submission received
2025-07-31 13:04:12,050 - app.handlers.command_handler - INFO - handle_view_submission:741 - Unknown modal callback_id: write_excel_data_modal
2025-07-31 13:04:12,052 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:04:12] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:04:29,417 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:04:29,419 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753954994.995509', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268217870071.9212409550592.a9d7f83156b1e804cffa922f1eaa62aa', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753954994.995509', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268217796103/e2KocARbvfmthrlSpdTeJk8v', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956269.171755'}]}
2025-07-31 13:04:29,428 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:04:29,429 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:04:29,432 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:04:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:04:29,908 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:04:38,862 - app.services.google_service - INFO - read_sheet_data:309 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 13:04:39,710 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:05:07,934 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:05:09,420 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:05:11,583 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:05:11,585 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:05:14,884 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:05:14,892 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:14,907 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:14,912 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:05:14,990 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:05:15,022 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:05:37,974 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:05:38,600 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:05:40,000 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:05:40,001 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:05:41,563 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:05:41,580 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:41,623 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:41,638 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:05:41,718 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:05:41,734 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:05:50,628 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:05:50,902 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:05:52,225 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:05:52,225 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:05:53,803 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:05:53,808 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:53,821 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:05:53,829 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:05:53,912 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:05:53,925 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:06:23,804 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 13:06:23,807 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:06:23] "POST /api/command HTTP/1.1" 200 -
2025-07-31 13:06:29,529 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:06:29,534 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956384.252569', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280267238646.9212409550592.2aaffb224cc35c7a7a62705281586c1e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753956384.252569', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280267237798/iPzHfg6quUxmLxG1QNNIugw5', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753956389.214206'}]}
2025-07-31 13:06:29,654 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:06:29,697 - app.handlers.command_handler - INFO - handle_list_excel_action:560 - Handling list Excel action
2025-07-31 13:06:29,739 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:06:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:06:29,956 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:06:34,123 - app.services.google_service - INFO - list_available_excel_files:1143 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:06:36,185 - app.services.google_service - INFO - list_available_excel_files:1155 - Found 2 Excel files in folder
2025-07-31 13:06:37,157 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:06:42,539 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:06:42,542 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956397.212019', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281517830789.9212409550592.91359c8bcb257486dfdb5f194bcec982', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956397.212019', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281517774021/C1HQQquRcsVtmUbraGqJiCYf', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753956402.159885'}]}
2025-07-31 13:06:42,547 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:06:42,548 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:06:42,549 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:06:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:06:42,675 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:06:47,677 - app.services.google_service - INFO - read_excel_by_file_id:733 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 8450
2025-07-31 13:06:48,654 - app.services.google_service - INFO - _read_excel_with_pandas:887 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:06:48,655 - app.services.google_service - INFO - read_excel_by_file_id:762 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:06:48,656 - app.services.google_service - INFO - read_excel_by_file_id:806 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:06:49,439 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:06:54,165 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:06:54,174 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956409.506409', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280269594454.9212409550592.4b52b97ab32fbb1431c91447a94109aa', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956409.506409', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280269483238/z5JEGpJXiLNKt6aaq8ZGCoVd', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956413.896958'}]}
2025-07-31 13:06:54,228 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:06:54,231 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:06:54,232 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:06:55,036 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280269594454.9212409550592.4b52b97ab32fbb1431c91447a94109aa
2025-07-31 13:06:55,039 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:06:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:07:08,028 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:07:08,032 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284639012324.9212409550592.13c8b49ad59084161bb595cdeb9efcb0', 'view': {'id': 'V098BAGNQEN', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753956415.81TLdXzJ', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098BAGNQEN', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:07:08,065 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:07:08,067 - app.handlers.command_handler - INFO - handle_view_submission:728 - Modal submission received
2025-07-31 13:07:08,070 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:753 - Handling write data modal submission
2025-07-31 13:07:08,079 - app.handlers.command_handler - ERROR - handle_write_data_modal_submission:910 - Error writing to sheet: cannot access local variable 'sheet_id' where it is not associated with a value
2025-07-31 13:07:08,084 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:07:08] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:08:16,852 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:08:17,185 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:08:18,397 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:08:18,401 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:08:20,411 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:08:20,419 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:08:20,431 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:08:20,450 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:08:20,577 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:08:20,585 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:08:42,808 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:08:43,442 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:08:44,997 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:08:44,998 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:08:46,620 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:08:46,629 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:08:46,651 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:08:46,665 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:08:46,757 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:08:46,770 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:09:22,769 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:09:22,770 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956409.506409', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279541268787.9212409550592.6e832f3387c7a049e06023d9346f80e0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956409.506409', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279541240691/k0yhjIUg0i5ujkAemcbvmiNy', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956562.506124'}]}
2025-07-31 13:09:22,773 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:09:22,785 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:09:22,787 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:09:23,920 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279541268787.9212409550592.6e832f3387c7a049e06023d9346f80e0
2025-07-31 13:09:23,922 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:09:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:09:37,294 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:09:37,295 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279541607075.9212409550592.fc1a9fe58ce091bbe1dabcb970cbdb6d', 'view': {'id': 'V098887FP0W', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753956563.ClQEVJ1s', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098887FP0W', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:09:37,304 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:09:37,305 - app.handlers.command_handler - INFO - handle_view_submission:728 - Modal submission received
2025-07-31 13:09:37,307 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:753 - Handling write data modal submission
2025-07-31 13:09:37,309 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:811 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: sales
2025-07-31 13:09:37,312 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:09:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:09:37,453 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:09:47,929 - app.services.google_service - ERROR - write_excel_data:424 - Error writing to Excel file: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmphj1ym2ac'
2025-07-31 13:09:47,932 - app.handlers.command_handler - ERROR - update_data_async:895 - Error in async sheet update: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmphj1ym2ac'
2025-07-31 13:09:48,998 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:10:13,230 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:10:13,237 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956409.506409', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268244570679.9212409550592.a519d4c6d4e326f95bc23d8bbaa8f1b0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956409.506409', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268244561095/3OjBYvPvQpQMvXsqitdfpmRK', 'actions': [{'action_id': 'refresh_data', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956612.992319'}]}
2025-07-31 13:10:13,262 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:10:13,273 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:10:13,277 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:10:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:10:13,722 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:10:27,557 - app.services.google_service - INFO - read_sheet_data:309 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 13:10:28,407 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:11:03,263 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:11:04,213 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:11:08,372 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:11:08,373 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:11:10,710 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:11:10,720 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:11:10,737 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:11:10,758 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:11:11,204 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:11:11,223 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:11:56,507 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:11:56,751 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:11:58,295 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:11:58,296 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:11:59,813 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:11:59,818 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:11:59,834 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:11:59,841 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:11:59,924 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:11:59,936 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:12:14,745 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:12:14,747 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956628.480879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283379153490.9212409550592.d6e58c54144243adac5f075b3a3d6e2f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956628.480879', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'EqLd2', 'text': {'type': 'mrkdwn', 'text': '*Data from SHEET*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qNwkH'}, {'type': 'section', 'block_id': 'bGESb', 'text': {'type': 'mrkdwn', 'text': '*task | Status | Owner | Stage | Due date | Notes*', 'verbatim': False}}, {'type': 'section', 'block_id': 'Uatao', 'text': {'type': 'plain_text', 'text': 'Mobile | Completed | million mulugeta | post event', 'emoji': True}}, {'type': 'section', 'block_id': 'oA55j', 'text': {'type': 'plain_text', 'text': 'app | Completed | million mulugeta | Day of', 'emoji': True}}, {'type': 'section', 'block_id': 'cr6Zf', 'text': {'type': 'plain_text', 'text': 'bot | Blocked | millionmulugeta09@gmail.com | Post-event', 'emoji': True}}, {'type': 'section', 'block_id': 'Pej6q', 'text': {'type': 'plain_text', 'text': 'doc | Completed', 'emoji': True}}, {'type': 'actions', 'block_id': 'iwFQ2', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": null}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": null}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283379095618/PzptvQYF8xQhFKrvbbA9WnZ8', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'iwFQ2', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "sheet", "params": {"sheet_id": null}}', 'type': 'button', 'action_ts': '1753956734.300933'}]}
2025-07-31 13:12:14,763 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:12:14,764 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:12:14,776 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: sheet, params: {'sheet_id': None}
2025-07-31 13:12:15,802 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283379153490.9212409550592.d6e58c54144243adac5f075b3a3d6e2f
2025-07-31 13:12:15,807 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:12:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:12:24,319 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:12:24,321 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956409.506409', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305302055200.9212409550592.76a4e2fe063fa8f45b2d0131fb2cf6f7', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956409.506409', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'vQvvm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'kE53T'}, {'type': 'section', 'block_id': 'qXgI4', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'WjAUh', 'text': {'type': 'plain_text', 'text': 'million | 2000k', 'emoji': True}}, {'type': 'actions', 'block_id': 'aWFIH', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305302050240/u4Qzx9t5h2XciUqkXCjOMpJ6', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'aWFIH', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956743.665751'}]}
2025-07-31 13:12:24,335 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:12:24,338 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:12:24,340 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:12:25,134 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9305302055200.9212409550592.76a4e2fe063fa8f45b2d0131fb2cf6f7
2025-07-31 13:12:25,136 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:12:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:12:39,704 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:12:39,707 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956384.252569', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284662795076.9212409550592.3e2d84f9e03c0ade26db61bdbc7b14d3', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753956384.252569', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284662716628/UEcirUpFP4pSum5osLp59MoV', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753956759.283095'}]}
2025-07-31 13:12:39,784 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:12:39,787 - app.handlers.command_handler - INFO - handle_list_excel_action:560 - Handling list Excel action
2025-07-31 13:12:39,791 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:12:39] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:12:39,972 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:12:43,765 - app.services.google_service - INFO - list_available_excel_files:1167 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:12:45,714 - app.services.google_service - INFO - list_available_excel_files:1179 - Found 2 Excel files in folder
2025-07-31 13:12:46,476 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:12:51,134 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:12:51,141 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956766.555899', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298557858657.9212409550592.fddea5750c160dfb5d4bccd828daa2c1', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956766.555899', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298557826497/aBGzRolbVrRJMmJHeEylxfaM', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753956770.826244'}]}
2025-07-31 13:12:51,246 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:12:51,247 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:12:51,249 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:12:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:12:51,677 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:12:57,635 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4926
2025-07-31 13:12:58,417 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:12:58,418 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:12:58,419 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:12:59,235 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:13:09,403 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:13:09,404 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956779.304729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268259244919.9212409550592.3efabe820e923f18169dd8e74b491155', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956779.304729', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268259230023/7uMaDjFYqQtoXswxPA4y1iC5', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956789.168962'}]}
2025-07-31 13:13:09,408 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:13:09,409 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:13:09,410 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:13:10,219 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268259244919.9212409550592.3efabe820e923f18169dd8e74b491155
2025-07-31 13:13:10,225 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:13:10] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:13:23,802 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:13:23,805 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283383386786.9212409550592.f53292f5b3da5ceaf08a9ba3d6d5c0f2', 'view': {'id': 'V0989G2P2H3', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753956790.CKmpGSRI', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0989G2P2H3', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:13:23,834 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:13:23,843 - app.handlers.command_handler - INFO - handle_view_submission:728 - Modal submission received
2025-07-31 13:13:23,848 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:753 - Handling write data modal submission
2025-07-31 13:13:23,850 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:811 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: sales
2025-07-31 13:13:23,853 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:13:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:13:24,023 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:13:31,964 - app.services.google_service - WARNING - write_excel_data:423 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpn8ck815r: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpn8ck815r'
2025-07-31 13:13:32,969 - app.services.google_service - WARNING - write_excel_data:429 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpn8ck815r: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpn8ck815r'
2025-07-31 13:13:32,971 - app.services.google_service - INFO - write_excel_data:432 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B1
2025-07-31 13:13:33,836 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:13:39,210 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:13:39,213 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956779.304729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268260351223.9212409550592.83b9a463e9c31e92e4df98ba0438f8e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956779.304729', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268260230615/8bAOKVieV0y9MeG969bRS4M7', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753956818.670954'}]}
2025-07-31 13:13:39,229 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:13:39,231 - app.handlers.command_handler - INFO - handle_open_update_modal_action:519 - Handling open update modal action
2025-07-31 13:13:39,232 - app.handlers.command_handler - INFO - handle_open_update_modal_action:529 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:13:40,040 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268260351223.9212409550592.83b9a463e9c31e92e4df98ba0438f8e5
2025-07-31 13:13:40,043 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:13:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:14:02,035 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:14:02,042 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284668721380.9212409550592.d080356f3f19ce688d830291b989431d', 'view': {'id': 'V09888UT0UE', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '2000K'}}}}, 'hash': '1753956820.9hl816CU', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09888UT0UE', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:14:02,114 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:14:02,115 - app.handlers.command_handler - INFO - handle_view_submission:728 - Modal submission received
2025-07-31 13:14:02,128 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:753 - Handling write data modal submission
2025-07-31 13:14:02,130 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:811 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 2000K
2025-07-31 13:14:02,146 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:14:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:14:02,293 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:14:13,268 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:14:13,299 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956766.555899', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279563068003.9212409550592.1f3c02bee18e019dd47231dac86ad10d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956766.555899', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279562949523/6kahMyRPfEfxd6GzCjqzRKLF', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753956853.138329'}]}
2025-07-31 13:14:13,329 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:14:13,345 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:14:13,397 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:14:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:14:13,884 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:14:20,459 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:14:20,742 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:14:20,751 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:14:20,806 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:14:22,177 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:18:16,509 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:18:16,529 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956779.304729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283404615410.9212409550592.27bfecd550f27d8b0ce20dbb486a5882', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753956779.304729', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283404565186/7xdw0GItfaQal3guGJY40pqh', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957096.373907'}]}
2025-07-31 13:18:16,609 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:18:16,658 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:18:16,716 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:18:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:18:17,087 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:18:25,487 - app.services.google_service - INFO - read_sheet_data:309 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 13:18:26,396 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:19:50,103 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:19:50,604 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:19:51,270 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:19:51,271 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:19:52,975 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:19:52,986 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:19:53,006 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:19:53,012 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:19:53,110 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:19:53,131 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:20:03,119 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:20:03,634 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:20:04,428 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:20:04,429 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:20:06,517 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:20:06,524 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:20:06,537 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:20:06,541 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:20:06,588 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:20:06,598 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:20:36,910 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:20:36,916 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753956384.252569', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283412215138.9212409550592.814f5af390091bad7464a6f238bfb778', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753956384.252569', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283412209602/FcgZlnuJaOIOaKM75dnqwX37', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753957236.796814'}]}
2025-07-31 13:20:37,053 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:20:37,089 - app.handlers.command_handler - INFO - handle_list_excel_action:593 - Handling list Excel action
2025-07-31 13:20:37,092 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:20:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:20:37,286 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:20:41,389 - app.services.google_service - INFO - list_available_excel_files:1167 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:20:43,307 - app.services.google_service - INFO - list_available_excel_files:1179 - Found 2 Excel files in folder
2025-07-31 13:20:44,439 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:21:15,840 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:21:15,843 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957244.493499', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280331676358.9212409550592.9c906884dbb114338f251556189ba6b0', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957244.493499', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280331619286/NNNQExI8QELqRZO1jiMc9Iz0', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753957275.775893'}]}
2025-07-31 13:21:15,922 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:21:15,923 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:21:15,925 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:21:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:21:16,048 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:21:20,836 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:21:21,509 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:21:21,510 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:21:21,510 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:21:22,480 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:21:29,494 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:21:29,495 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957282.558449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305338217824.9212409550592.b6639ff25048397d1c24adc23ee87ccb', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957282.558449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305338176864/3AsQbZDNN7GPmp8kO4rgDnjA', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957289.409283'}]}
2025-07-31 13:21:29,507 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:21:29,509 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:21:29,510 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:21:30,469 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9305338217824.9212409550592.b6639ff25048397d1c24adc23ee87ccb
2025-07-31 13:21:30,470 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:21:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:21:42,993 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:21:42,995 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9268297735287.9212409550592.7fa209b5e9fd0265e69c9cc4950ff04f', 'view': {'id': 'V098CLMBXFW', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200k'}}}}, 'hash': '1753957290.rX13gWxu', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098CLMBXFW', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:21:43,031 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:21:43,044 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:21:43,046 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:21:43,047 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200k
2025-07-31 13:21:43,049 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:21:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:21:43,165 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:22:29,693 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:22:29,729 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957282.558449', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279601405571.9212409550592.99297f6093794b6db08c404914f0370e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957282.558449', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279601262883/PEWkTMbwLY3S7cCzyPqwvGQy', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957349.433592'}]}
2025-07-31 13:22:29,754 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:22:29,794 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:22:29,843 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:22:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:22:30,157 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:22:35,385 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:22:35,662 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:22:35,688 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:22:35,726 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:22:36,833 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:23:44,616 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:23:44,617 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:23:46,636 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:23:46,642 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:23:46,655 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:23:46,662 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:23:46,763 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:23:46,765 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:23:46,769 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:23:47,420 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:23:47,420 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:23:49,072 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:23:49,076 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:23:49,094 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:23:49,101 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:23:49,162 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:23:49,175 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:24:00,399 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 13:24:00,404 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:24:00] "POST /api/command HTTP/1.1" 200 -
2025-07-31 13:24:05,891 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:24:05,893 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957440.912399', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268307987319.9212409550592.b0ff980329eaa38d08df8089047db493', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753957440.912399', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268307984567/EsoqxYNQRmlspxhSF8AVw5N3', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753957445.358384'}]}
2025-07-31 13:24:06,029 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:24:06,064 - app.handlers.command_handler - INFO - handle_list_excel_action:593 - Handling list Excel action
2025-07-31 13:24:06,098 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:24:06] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:24:06,260 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:24:10,347 - app.services.google_service - INFO - list_available_excel_files:1167 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:24:12,307 - app.services.google_service - INFO - list_available_excel_files:1179 - Found 2 Excel files in folder
2025-07-31 13:24:13,432 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:24:18,286 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:24:18,288 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957453.516889', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268305899559.9212409550592.8bf07ba802542b5d2185c834e0fd1e9a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957453.516889', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268305885703/Tu2gXaO4IgIfgTFndF1sLCmm', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753957457.995682'}]}
2025-07-31 13:24:18,302 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:24:18,310 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:24:18,334 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:24:18] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:24:18,442 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:24:24,146 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:24:24,854 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:24:24,855 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:24:24,855 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:24:25,754 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:24:31,455 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:24:31,456 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957465.831969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281590973269.9212409550592.a3c0529e07a1ec86293fbad43a75a3cd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957465.831969', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281590959701/ASySkxtEdK5FcZWoxpwU2FhG', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957471.388217'}]}
2025-07-31 13:24:31,538 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:24:31,540 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:24:31,541 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:24:32,555 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9281590973269.9212409550592.a3c0529e07a1ec86293fbad43a75a3cd
2025-07-31 13:24:32,561 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:24:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:24:44,558 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:24:44,559 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9268309816871.9212409550592.12c3c3618380c53b0df3fa748f309477', 'view': {'id': 'V098ZAAHYUQ', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753957472.125JSx7f', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098ZAAHYUQ', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:24:44,573 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:24:44,576 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:24:44,591 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:24:44,594 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: sales
2025-07-31 13:24:44,606 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:24:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:24:44,745 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:24:51,277 - app.services.google_service - WARNING - write_excel_data:423 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpk_jx4eaa: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpk_jx4eaa'
2025-07-31 13:24:52,282 - app.services.google_service - WARNING - write_excel_data:429 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpk_jx4eaa: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpk_jx4eaa'
2025-07-31 13:24:52,285 - app.services.google_service - INFO - write_excel_data:432 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B1
2025-07-31 13:24:53,188 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:25:02,843 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:25:02,844 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957465.831969', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298610735169.9212409550592.7d1838a7c99c1abad4a7b1652e65fdda', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957465.831969', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298610714209/GR8R521sXTeuxvlUFUJuNx7d', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957502.793794'}]}
2025-07-31 13:25:02,894 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:25:02,894 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:25:02,909 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:25:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:25:03,023 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:25:08,266 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4923
2025-07-31 13:25:08,320 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:25:08,321 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:25:08,322 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:25:09,286 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:27:14,954 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:27:14,958 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957509.363009', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298620361569.9212409550592.c0b8edb95b5fef050ffdc0c6eeeb8218', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957509.363009', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298620352657/WV14uguezRENphtVPs7fi1Fw', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957634.712911'}]}
2025-07-31 13:27:14,981 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:27:15,035 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:27:15,136 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:27:16,179 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9298620361569.9212409550592.c0b8edb95b5fef050ffdc0c6eeeb8218
2025-07-31 13:27:16,185 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:27:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:27:27,151 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:27:27,154 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9279624070691.9212409550592.103393ecc2dc90cb3634bb81f6272412', 'view': {'id': 'V098BCZLS8J', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200k'}}}}, 'hash': '1753957636.ielrXcfA', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098BCZLS8J', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:27:27,189 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:27:27,240 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:27:27,274 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:27:27,290 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200k
2025-07-31 13:27:27,293 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:27:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:27:27,546 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:27:35,473 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:27:35,543 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957509.363009', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268323198279.9212409550592.68f4278952d42a9a2d87685627b09105', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957509.363009', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268323198167/HjsegKjjdkaP9Cdjo07WSZad', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957655.156501'}]}
2025-07-31 13:27:35,555 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:27:35,611 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:27:35,689 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:27:35] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:27:36,119 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:27:41,799 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4923
2025-07-31 13:27:42,377 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:27:42,388 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:27:42,419 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:27:43,453 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:28:25,746 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:28:25,747 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:28:27,466 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:28:27,472 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:28:27,485 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:28:27,493 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:28:27,656 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:28:27,686 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:28:27,693 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:28:28,544 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:28:28,545 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:28:31,010 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:28:31,018 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:28:31,042 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:28:31,056 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:28:31,211 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:28:31,225 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:28:33,496 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:28:33,497 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957663.506889', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305366405920.9212409550592.d1d29c7ad0f5c1e2c44a9e7dc8c0411c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957663.506889', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305366405856/rHzKj1iDZY6i1HlWSzQMoTee', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957713.214349'}]}
2025-07-31 13:28:33,580 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:28:33,762 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:28:33,836 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:28:35,125 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9305366405920.9212409550592.d1d29c7ad0f5c1e2c44a9e7dc8c0411c
2025-07-31 13:28:35,127 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:28:35] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:28:55,419 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:28:55,420 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9298627003201.9212409550592.a0b1aaae00ee1c3694a08fc67a635ee3', 'view': {'id': 'V098SJDFV5F', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sales'}}}}, 'hash': '1753957715.zgnovuKZ', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098SJDFV5F', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:28:55,425 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:28:55,426 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:28:55,431 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:28:55,435 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: sales
2025-07-31 13:28:55,438 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:28:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:28:55,568 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:29:03,851 - app.services.google_service - WARNING - write_excel_data:423 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpv7d5_5uc: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpv7d5_5uc'
2025-07-31 13:29:04,866 - app.services.google_service - WARNING - write_excel_data:429 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpv7d5_5uc: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpv7d5_5uc'
2025-07-31 13:29:04,871 - app.services.google_service - INFO - write_excel_data:432 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B1
2025-07-31 13:29:05,814 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:29:34,598 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:29:34,600 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957663.506889', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280369448918.9212409550592.ab6c46bbc833a14900f908b0ea1a7205', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957663.506889', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280369411878/1FoJ4WhSYmPDOOU1LYS6mR0B', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957774.555090'}]}
2025-07-31 13:29:34,614 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:29:34,617 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 13:29:34,635 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:29:34] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:29:34,870 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:29:40,702 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:29:40,735 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:29:40,747 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:29:40,748 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:29:41,700 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:31:36,157 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:31:36,158 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753957781.787459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284745903652.9212409550592.8b4eca134c33a715f8ef228c1266dde2', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753957781.787459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284745864756/9mNeIZueORQzbRDsnRIuPTtM', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753957896.095816'}]}
2025-07-31 13:31:36,190 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:31:36,191 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:31:36,192 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:31:37,180 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9284745903652.9212409550592.8b4eca134c33a715f8ef228c1266dde2
2025-07-31 13:31:37,182 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:31:37] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:31:47,495 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:31:47,497 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9298642340209.9212409550592.dfc4580315d4eb977b75900f0f418d71', 'view': {'id': 'V0988B75EDC', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200'}}}}, 'hash': '1753957897.H1SK6Xzw', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988B75EDC', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:31:47,561 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:31:47,567 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:31:47,574 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:31:47,578 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200
2025-07-31 13:31:47,580 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:31:47] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:31:47,702 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:37:52,547 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:37:52,547 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:37:54,277 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:37:54,284 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:37:54,296 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:37:54,313 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:37:54,474 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:37:54,476 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:37:54,479 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:37:55,301 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:37:55,302 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:37:57,016 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:37:57,021 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:37:57,039 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:37:57,045 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:37:57,115 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:37:57,129 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:38:07,636 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 13:38:07,638 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:38:07] "POST /api/command HTTP/1.1" 200 -
2025-07-31 13:38:12,985 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:38:12,986 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958288.135089', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268371754999.9212409550592.2379f39c27f65f1a8143205ae0e7d2ab', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753958288.135089', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268371735847/8XoQG6qPnL9SHlhAUceXArUp', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753958292.463334'}]}
2025-07-31 13:38:13,053 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:38:13,086 - app.handlers.command_handler - INFO - handle_list_excel_action:593 - Handling list Excel action
2025-07-31 13:38:13,128 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:38:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:38:13,265 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:38:17,511 - app.services.google_service - INFO - list_available_excel_files:1167 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:38:19,537 - app.services.google_service - INFO - list_available_excel_files:1179 - Found 2 Excel files in folder
2025-07-31 13:38:20,540 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:38:25,756 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:38:25,758 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958300.627349', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280410085190.9212409550592.f9cb4b9eb06de9b1ce83b4539e7ef19a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958300.627349', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280410084502/WTDdpn85YLodKcH8tOiCWcBp', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753958305.483791'}]}
2025-07-31 13:38:25,807 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:38:25,822 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:38:25,824 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:38:25] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:38:25,963 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:38:31,297 - app.services.google_service - INFO - read_excel_by_file_id:757 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:38:31,932 - app.services.google_service - INFO - _read_excel_with_pandas:911 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:38:31,932 - app.services.google_service - INFO - read_excel_by_file_id:786 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:38:31,933 - app.services.google_service - INFO - read_excel_by_file_id:830 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:38:32,945 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:38:37,234 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:38:37,238 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958313.002169', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279673475091.9212409550592.9af2c732ded7620a7b6f2261054e7005', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958313.002169', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279673415571/IYQbUa1BvKoy0Skh9h3kLfxT', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753958316.918494'}]}
2025-07-31 13:38:37,328 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:38:37,329 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:38:37,330 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:38:38,289 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9279673475091.9212409550592.9af2c732ded7620a7b6f2261054e7005
2025-07-31 13:38:38,294 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:38:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:38:51,027 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:38:51,028 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283491290354.9212409550592.1031b75fccfc1292cd71491e48b9b7bb', 'view': {'id': 'V098ZBZ2N80', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200'}}}}, 'hash': '1753958318.ykeLtZvt', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098ZBZ2N80', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:38:51,045 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:38:51,048 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:38:51,049 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:38:51,050 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200
2025-07-31 13:38:51,080 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:38:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:38:51,256 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:40:32,402 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:40:33,052 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:40:34,791 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:40:34,792 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:40:36,227 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:40:36,232 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:40:36,248 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:40:36,251 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:40:36,324 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:40:36,331 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:41:02,169 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:41:02,591 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:41:04,409 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:41:04,410 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:41:05,878 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:41:05,886 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:41:05,904 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:41:05,914 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:41:06,063 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:41:06,070 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:41:14,511 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:41:14,812 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:41:16,031 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:41:16,033 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:41:18,587 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:41:18,593 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:41:18,602 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:41:18,606 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:41:18,650 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:41:18,661 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:42:13,848 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:42:13,849 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958313.002169', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268389541799.9212409550592.a1b88b630cc246352a24246e873d559a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958313.002169', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268389541735/o7DEOzD88Jyv2FECd5NeczBi', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753958533.558830'}]}
2025-07-31 13:42:13,855 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:42:13,856 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:42:13,857 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:42:16,744 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268389541799.9212409550592.a1b88b630cc246352a24246e873d559a
2025-07-31 13:42:16,748 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:42:16] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:42:32,981 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:42:32,986 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283505589906.9212409550592.ea058a961b1d787e592e1d5b30ef235a', 'view': {'id': 'V097WBEM087', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200'}}}}, 'hash': '1753958536.hu4VDLwa', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097WBEM087', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:42:33,073 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:42:33,075 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:42:33,076 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:42:33,089 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200
2025-07-31 13:42:33,091 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:42:33] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:42:33,306 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:42:37,096 - app.handlers.command_handler - INFO - update_data_async:908 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:42:37,098 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:43:09,287 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:43:09,288 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:43:10,818 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:43:10,823 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:10,835 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:10,843 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:43:10,954 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:43:10,955 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:43:10,958 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:43:11,624 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:43:11,625 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:43:13,188 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:43:13,194 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:13,203 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:13,207 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:43:13,256 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:43:13,265 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:43:24,254 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 13:43:24,256 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:43:24] "POST /api/command HTTP/1.1" 200 -
2025-07-31 13:43:30,818 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:43:30,820 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958604.757789', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283507139938.9212409550592.2f06b4f9ab6eef19adbcde4d9d27cd37', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753958604.757789', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283507099090/kDK1G3XwIUyD3gF7U5onM3n4', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753958610.492757'}]}
2025-07-31 13:43:30,935 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:43:30,936 - app.handlers.command_handler - INFO - handle_list_excel_action:593 - Handling list Excel action
2025-07-31 13:43:30,945 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:43:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:43:31,144 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:35,141 - app.services.google_service - INFO - list_available_excel_files:1169 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 13:43:37,295 - app.services.google_service - INFO - list_available_excel_files:1181 - Found 2 Excel files in folder
2025-07-31 13:43:38,336 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:43:43,829 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:43:43,833 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958618.436359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280431331382.9212409550592.2d3de3bc5548b0560682333302dc01d7', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958618.436359', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280431241510/6IR4MQqrJk686jTCPnyAP04p', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753958623.414093'}]}
2025-07-31 13:43:43,908 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:43:43,925 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 13:43:43,938 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:43:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:43:44,147 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:43:50,094 - app.services.google_service - INFO - read_excel_by_file_id:759 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 13:43:51,009 - app.services.google_service - INFO - _read_excel_with_pandas:913 - Successfully read Excel file with pandas: 2 rows
2025-07-31 13:43:51,010 - app.services.google_service - INFO - read_excel_by_file_id:788 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 13:43:51,012 - app.services.google_service - INFO - read_excel_by_file_id:832 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:43:51,899 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 13:44:01,273 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:44:01,323 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958631.995909', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284799581732.9212409550592.fbfcdb3937b49d936ab6bde1fcfcc03a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958631.995909', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284799567556/hmPjnGydZcwQ6f35HaI4zsWT', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753958640.799846'}]}
2025-07-31 13:44:01,339 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:44:01,341 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:44:01,342 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:44:02,333 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9284799581732.9212409550592.fbfcdb3937b49d936ab6bde1fcfcc03a
2025-07-31 13:44:02,342 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:44:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:44:15,335 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:44:15,345 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284799062228.9212409550592.06d7beeddfeddc5451b21cc43a8c0351', 'view': {'id': 'V098SLCTR4Z', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200'}}}}, 'hash': '1753958642.Ozq7yPvk', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098SLCTR4Z', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:44:15,427 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:44:15,473 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:44:15,478 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:44:15,479 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200
2025-07-31 13:44:15,499 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:44:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:44:15,805 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:44:24,656 - app.handlers.command_handler - INFO - update_data_async:908 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:44:24,658 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:45:40,148 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:45:42,197 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:45:44,797 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:45:44,798 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:45:46,887 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:45:46,898 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:45:46,915 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:45:46,919 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:45:47,000 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:45:47,015 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:46:10,421 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:46:12,217 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:46:13,956 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:46:13,958 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:46:16,331 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:46:16,340 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:16,357 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:16,362 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:46:16,441 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:46:16,455 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:46:26,204 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:46:27,289 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:46:28,824 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:46:28,825 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:46:31,143 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:46:31,160 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:31,180 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:31,189 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:46:31,260 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:46:31,274 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:46:41,351 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:46:42,670 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:46:45,121 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:46:45,122 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:46:47,095 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:46:47,104 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:47,124 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:46:47,129 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:46:47,204 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:46:47,221 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:47:05,690 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:47:05,919 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:47:07,020 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:47:07,022 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:47:08,494 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:47:08,500 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:47:08,513 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:47:08,521 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:47:08,742 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:47:08,834 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:47:35,041 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:47:35,042 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753958631.995909', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268411474615.9212409550592.18e51bf74019ea403c45ca9feabfae2a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753958631.995909', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268411456487/9N8QgqgJYZpVsgPx6FuBkKiu', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753958854.992035'}]}
2025-07-31 13:47:35,053 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:47:35,055 - app.handlers.command_handler - INFO - handle_open_update_modal_action:552 - Handling open update modal action
2025-07-31 13:47:35,056 - app.handlers.command_handler - INFO - handle_open_update_modal_action:562 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 13:47:36,183 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9268411474615.9212409550592.18e51bf74019ea403c45ca9feabfae2a
2025-07-31 13:47:36,201 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:47:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:47:49,495 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:47:49,505 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284813864244.9212409550592.294e946eb5f33012e8f35b2bfaffa1ef', 'view': {'id': 'V098ZCYTVHN', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '200'}}}}, 'hash': '1753958856.TwmC45Lo', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098ZCYTVHN', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 13:47:49,572 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 13:47:49,573 - app.handlers.command_handler - INFO - handle_view_submission:761 - Modal submission received
2025-07-31 13:47:49,574 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:786 - Handling write data modal submission
2025-07-31 13:47:49,575 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:844 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 200
2025-07-31 13:47:49,577 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:47:49] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:47:49,711 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:47:52,699 - app.handlers.command_handler - INFO - update_data_async:908 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:47:52,711 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=200
2025-07-31 13:47:52,712 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 13:47:54,984 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmpzx8ikp55
2025-07-31 13:47:54,986 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 13:47:55,860 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (1, 2)
2025-07-31 13:47:55,862 - app.services.google_service - INFO - write_excel_data:397 - Converting column B to index 1
2025-07-31 13:47:55,863 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 1, col 1 with value '200'
2025-07-31 13:47:55,864 - app.services.google_service - INFO - write_excel_data:406 - Extending DataFrame - current shape: (1, 2)
2025-07-31 13:53:08,839 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:53:08,840 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:53:11,218 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:53:11,222 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:53:11,233 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:53:11,238 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:53:11,374 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 13:53:11,379 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 13:53:11,389 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:53:12,371 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:53:12,372 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:53:14,313 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:53:14,321 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:53:14,333 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:53:14,345 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:53:14,437 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:53:14,452 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:54:40,973 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:54:44,339 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:54:50,804 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:54:50,806 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:54:54,584 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:54:54,598 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:54:54,623 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:54:54,726 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:54:55,273 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:54:55,296 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:55:16,526 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:55:18,540 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:55:22,054 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:55:22,055 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:55:24,506 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:55:24,519 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:55:24,537 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:55:24,551 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:55:24,682 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:55:24,701 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:56:19,149 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:56:20,213 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:56:24,482 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:56:24,483 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:56:26,522 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:56:26,527 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:56:26,536 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:56:26,540 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:56:26,618 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:56:26,633 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:57:18,518 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 13:57:19,590 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:57:24,370 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:57:24,372 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:57:26,450 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:57:26,457 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:57:26,467 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:57:26,471 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:57:26,541 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:57:26,553 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:58:01,516 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:58:03,298 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:58:05,536 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:58:05,536 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:58:07,366 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:58:07,372 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:07,383 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:07,388 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:58:07,459 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:58:07,474 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:58:29,273 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:58:29,567 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:58:31,544 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:58:31,544 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:58:33,218 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:58:33,230 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:33,252 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:33,263 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:58:33,388 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:58:33,407 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:58:45,402 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 13:58:45,740 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 13:58:46,889 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 13:58:46,890 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 13:58:48,477 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 13:58:48,483 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:48,494 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:58:48,499 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 13:58:48,539 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 13:58:48,549 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 13:59:30,369 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 13:59:30,373 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:59:30] "POST /api/command HTTP/1.1" 200 -
2025-07-31 13:59:55,108 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 13:59:55,110 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959570.896869', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283574029058.9212409550592.62a8e84c068d7053f839c5455937cbf6', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753959570.896869', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283573914466/YyFKqSqhk1DMU4BdhEvLJonn', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753959594.824704'}]}
2025-07-31 13:59:55,192 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 13:59:55,196 - app.handlers.command_handler - INFO - handle_list_excel_action:599 - Handling list Excel action
2025-07-31 13:59:55,211 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 13:59:55] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 13:59:55,421 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 13:59:59,404 - app.services.google_service - INFO - list_available_excel_files:1191 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:00:01,249 - app.services.google_service - INFO - list_available_excel_files:1203 - Found 2 Excel files in folder
2025-07-31 14:00:02,371 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:00:07,300 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:00:07,304 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959602.447729', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279770703091.9212409550592.7fdc4d78ef0cb10565073522a7754780', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959602.447729', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279770703011/KI1oAr8fkD69DZygEvNspEDU', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753959607.221127'}]}
2025-07-31 14:00:07,362 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:00:07,364 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:00:07,366 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:00:07] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:00:07,583 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:00:13,285 - app.services.google_service - INFO - read_excel_by_file_id:781 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 14:00:14,358 - app.services.google_service - INFO - _read_excel_with_pandas:935 - Successfully read Excel file with pandas: 2 rows
2025-07-31 14:00:14,359 - app.services.google_service - INFO - read_excel_by_file_id:810 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:00:14,360 - app.services.google_service - INFO - read_excel_by_file_id:854 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:00:15,268 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:01:16,765 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:01:16,767 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959615.362459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283583745666.9212409550592.50a01c8b223f66f548698ea0fd7089dd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959615.362459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283583744946/cplwDFfjosGBlbQvjrA8fcHa', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753959676.465411'}]}
2025-07-31 14:01:16,829 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:01:16,831 - app.handlers.command_handler - INFO - handle_open_update_modal_action:558 - Handling open update modal action
2025-07-31 14:01:16,832 - app.handlers.command_handler - INFO - handle_open_update_modal_action:568 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:01:17,769 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283583745666.9212409550592.50a01c8b223f66f548698ea0fd7089dd
2025-07-31 14:01:17,781 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:01:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:01:30,637 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:01:30,639 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9284875510612.9212409550592.bf0902645b4203777b46ea7699e86fed', 'view': {'id': 'V0987NVU3QT', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '22'}}}}, 'hash': '1753959677.2rLYQKZU', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0987NVU3QT', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:01:30,672 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:01:30,678 - app.handlers.command_handler - INFO - handle_view_submission:767 - Modal submission received
2025-07-31 14:01:30,683 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:792 - Handling write data modal submission
2025-07-31 14:01:30,684 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:850 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: 22
2025-07-31 14:01:30,687 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:01:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:01:30,864 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:01:34,574 - app.handlers.command_handler - INFO - update_data_async:914 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=22
2025-07-31 14:01:34,577 - app.services.google_service - INFO - write_file_data:1387 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=22
2025-07-31 14:01:35,044 - app.services.google_service - INFO - write_file_data:1392 - Writing to file type: excel
2025-07-31 14:01:35,046 - app.services.google_service - ERROR - write_file_data:1404 - Failed to write file data: 'GoogleService' object has no attribute '_write_excel_data'
2025-07-31 14:01:35,051 - app.handlers.command_handler - ERROR - update_data_async:919 - Excel write failed: 'GoogleService' object has no attribute '_write_excel_data'
2025-07-31 14:01:35,052 - app.handlers.command_handler - ERROR - update_data_async:944 - Error in async sheet update: 'GoogleService' object has no attribute '_write_excel_data'
2025-07-31 14:01:36,076 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:02:21,776 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:02:22,692 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:02:26,806 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:02:26,807 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:02:29,901 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:02:29,910 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:02:29,929 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:02:29,937 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:02:30,048 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:02:30,062 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:02:37,617 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:02:37,842 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:02:39,100 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:02:39,100 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:02:40,579 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:02:40,584 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:02:40,599 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:02:40,604 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:02:40,687 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:02:40,699 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:02:56,011 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 14:02:56,018 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:02:56] "POST /api/command HTTP/1.1" 200 -
2025-07-31 14:03:02,195 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:03:02,197 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959776.549109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283591443890.9212409550592.e96ccc40062fc3346e7f72517d88a935', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753959776.549109', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283591409138/kewWPUEbV87EOtrfccg5SYap', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753959781.909797'}]}
2025-07-31 14:03:02,242 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:03:02,243 - app.handlers.command_handler - INFO - handle_list_excel_action:599 - Handling list Excel action
2025-07-31 14:03:02,245 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:03:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:03:02,442 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:03:06,414 - app.services.google_service - INFO - list_available_excel_files:1191 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:03:08,577 - app.services.google_service - INFO - list_available_excel_files:1203 - Found 2 Excel files in folder
2025-07-31 14:03:09,776 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:03:13,790 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:03:13,792 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959789.829639', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279788752467.9212409550592.e63a2b49bd13dcc68685fe51b4defbce', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959789.829639', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279788736019/XCZ9NVQILKYfQSD5XY4Pr6Z8', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753959793.731988'}]}
2025-07-31 14:03:13,851 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:03:13,853 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:03:13,855 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:03:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:03:14,010 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:03:21,372 - app.services.google_service - INFO - read_excel_by_file_id:781 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4922
2025-07-31 14:03:23,044 - app.services.google_service - INFO - _read_excel_with_pandas:935 - Successfully read Excel file with pandas: 2 rows
2025-07-31 14:03:23,045 - app.services.google_service - INFO - read_excel_by_file_id:810 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:03:23,047 - app.services.google_service - INFO - read_excel_by_file_id:854 - Read 2 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:03:24,208 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:03:28,603 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:03:28,606 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959804.065799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281746042309.9212409550592.4a65bcc0a143516bf379f422f074b020', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959804.065799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281746039125/85u1iaqnBW6muXwrwxLlzLfh', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753959808.477418'}]}
2025-07-31 14:03:28,621 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:03:28,622 - app.handlers.command_handler - INFO - handle_open_update_modal_action:558 - Handling open update modal action
2025-07-31 14:03:28,623 - app.handlers.command_handler - INFO - handle_open_update_modal_action:568 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:03:29,874 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9281746042309.9212409550592.4a65bcc0a143516bf379f422f074b020
2025-07-31 14:03:29,876 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:03:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:04:02,800 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:04:02,805 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283593336850.9212409550592.576d97b4653ef900659a13c1ad5d1603', 'view': {'id': 'V0989MWB05B', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '899'}}}}, 'hash': '1753959809.VMgtmvdR', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0989MWB05B', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:04:02,826 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:04:02,828 - app.handlers.command_handler - INFO - handle_view_submission:767 - Modal submission received
2025-07-31 14:04:02,831 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:792 - Handling write data modal submission
2025-07-31 14:04:02,839 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:850 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: B, Value: 899
2025-07-31 14:04:02,843 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:04:02] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:04:03,047 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:04:06,965 - app.handlers.command_handler - INFO - update_data_async:914 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=899
2025-07-31 14:04:06,968 - app.services.google_service - INFO - write_file_data:1387 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=899
2025-07-31 14:04:07,442 - app.services.google_service - INFO - write_file_data:1392 - Writing to file type: excel
2025-07-31 14:04:07,444 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=B, value=899
2025-07-31 14:04:07,447 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:04:08,565 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmp8w6t13ix
2025-07-31 14:04:08,568 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:04:08,619 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (1, 2)
2025-07-31 14:04:08,624 - app.services.google_service - INFO - write_excel_data:397 - Converting column B to index 1
2025-07-31 14:04:08,635 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 1, col 1 with value '899'
2025-07-31 14:04:08,638 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:04:08,640 - app.services.google_service - INFO - write_excel_data:409 - Extending DataFrame rows from 1 to 2
2025-07-31 14:04:08,665 - app.services.google_service - INFO - write_excel_data:421 - Successfully updated cell - final shape: (2, 2)
2025-07-31 14:04:08,669 - app.services.google_service - INFO - write_excel_data:424 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmp8w6t13ix
2025-07-31 14:04:08,805 - app.services.google_service - INFO - write_excel_data:427 - Successfully wrote Excel file
2025-07-31 14:04:08,807 - app.services.google_service - INFO - write_excel_data:430 - Uploading updated file to Google Drive
2025-07-31 14:04:11,123 - app.services.google_service - INFO - write_excel_data:439 - Successfully uploaded to Google Drive
2025-07-31 14:04:11,230 - app.services.google_service - WARNING - write_excel_data:447 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp8w6t13ix: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp8w6t13ix'
2025-07-31 14:04:12,241 - app.services.google_service - WARNING - write_excel_data:453 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp8w6t13ix: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp8w6t13ix'
2025-07-31 14:04:12,247 - app.services.google_service - INFO - write_excel_data:456 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B2
2025-07-31 14:04:13,305 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:04:20,060 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:04:20,061 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959804.065799', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305509654064.9212409550592.ff550c216a2ab3cb6bb38f0b916ecbae', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959804.065799', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'aBGfm', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': '9+8Cu'}, {'type': 'section', 'block_id': 'NrkD6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'IGYJS', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'actions', 'block_id': 'BXwB8', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305509618624/vI2vYZ8WTchw27wCFsyAsnSU', 'actions': [{'action_id': 'refresh_data', 'block_id': 'BXwB8', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753959859.794720'}]}
2025-07-31 14:04:20,107 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:04:20,139 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 14:04:20,163 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:04:20] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:04:20,346 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:04:24,244 - app.services.google_service - INFO - read_file_data:1267 - Reading file data: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:04:24,687 - app.services.google_service - INFO - read_file_data:1272 - File type determined: excel
2025-07-31 14:04:27,778 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:04:48,906 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:04:48,908 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959776.549109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268491499383.9212409550592.6b7d57475711a6139a7336899ee526fd', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753959776.549109', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268491499319/IZEiVBoDKe3xhlQSlVKaDcfk', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753959888.396487'}]}
2025-07-31 14:04:48,950 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:04:48,951 - app.handlers.command_handler - INFO - handle_list_excel_action:599 - Handling list Excel action
2025-07-31 14:04:48,953 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:04:48] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:04:49,094 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:04:52,782 - app.services.google_service - INFO - list_available_excel_files:1191 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:04:53,304 - app.services.google_service - INFO - list_available_excel_files:1203 - Found 2 Excel files in folder
2025-07-31 14:04:54,164 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:05:15,021 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:05:15,027 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959894.248789', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284892781636.9212409550592.2690036c9ac082f64fe0b89f6f67eb65', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959894.248789', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284892745524/CHpLC8L4DXe4nSemIpgTinGc', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753959914.764935'}]}
2025-07-31 14:05:15,112 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:05:15,113 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:05:15,211 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:05:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:05:15,378 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:05:20,841 - app.services.google_service - INFO - read_excel_by_file_id:781 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4942
2025-07-31 14:05:20,869 - app.services.google_service - INFO - _read_excel_with_pandas:935 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:05:20,881 - app.services.google_service - INFO - read_excel_by_file_id:810 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:05:20,886 - app.services.google_service - INFO - read_excel_by_file_id:854 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:05:21,828 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:05:29,147 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:05:29,149 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959921.938379', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9281754752501.9212409550592.6b9ea24cec5ba934ae2d5cca4395b82f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959921.938379', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '5rqtZ', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'QP95q'}, {'type': 'section', 'block_id': '8INJ6', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'j9Y0j', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'section', 'block_id': 'kuaQO', 'text': {'type': 'plain_text', 'text': ' | 899', 'emoji': True}}, {'type': 'actions', 'block_id': 'di2gR', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9281754749365/PsO5kT3thdjQ00BuQ3fK7YBB', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'di2gR', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753959928.901013'}]}
2025-07-31 14:05:29,210 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:05:29,213 - app.handlers.command_handler - INFO - handle_open_update_modal_action:558 - Handling open update modal action
2025-07-31 14:05:29,226 - app.handlers.command_handler - INFO - handle_open_update_modal_action:568 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:05:30,205 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9281754752501.9212409550592.6b9ea24cec5ba934ae2d5cca4395b82f
2025-07-31 14:05:30,213 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:05:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:05:51,989 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:05:51,990 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280531081078.9212409550592.bd26cd8ed6e6a75bf5315456eb61dc06', 'view': {'id': 'V098SP78QBT', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'million'}}}}, 'hash': '1753959930.0qxgJFUm', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098SP78QBT', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:05:52,001 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:05:52,004 - app.handlers.command_handler - INFO - handle_view_submission:767 - Modal submission received
2025-07-31 14:05:52,005 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:792 - Handling write data modal submission
2025-07-31 14:05:52,007 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:850 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 2, Col: A, Value: million
2025-07-31 14:05:52,009 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:05:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:05:52,108 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:05:55,124 - app.handlers.command_handler - INFO - update_data_async:914 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=A, value=million
2025-07-31 14:05:55,126 - app.services.google_service - INFO - write_file_data:1387 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=A, value=million
2025-07-31 14:05:55,551 - app.services.google_service - INFO - write_file_data:1392 - Writing to file type: excel
2025-07-31 14:05:55,552 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=2, col=A, value=million
2025-07-31 14:05:55,553 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:05:56,765 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmp5ixmooca
2025-07-31 14:05:56,765 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:05:56,782 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (2, 2)
2025-07-31 14:05:56,785 - app.services.google_service - INFO - write_excel_data:397 - Converting column A to index 0
2025-07-31 14:05:56,787 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 1, col 0 with value 'million'
2025-07-31 14:05:56,789 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:05:56,790 - app.services.google_service - INFO - write_excel_data:421 - Successfully updated cell - final shape: (2, 2)
2025-07-31 14:05:56,790 - app.services.google_service - INFO - write_excel_data:424 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmp5ixmooca
2025-07-31 14:05:56,866 - app.services.google_service - INFO - write_excel_data:427 - Successfully wrote Excel file
2025-07-31 14:05:56,867 - app.services.google_service - INFO - write_excel_data:430 - Uploading updated file to Google Drive
2025-07-31 14:05:59,193 - app.services.google_service - INFO - write_excel_data:439 - Successfully uploaded to Google Drive
2025-07-31 14:05:59,294 - app.services.google_service - WARNING - write_excel_data:447 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp5ixmooca: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp5ixmooca'
2025-07-31 14:06:00,296 - app.services.google_service - WARNING - write_excel_data:453 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp5ixmooca: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp5ixmooca'
2025-07-31 14:06:00,297 - app.services.google_service - INFO - write_excel_data:456 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at A2
2025-07-31 14:06:00,408 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:06:00,409 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753959894.248789', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280531347894.9212409550592.c327b6088b4ffe3e03ca5ff12e4fa517', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753959894.248789', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280531331862/1sB2JuFt7ioJMHbxM2WdjUH4', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753959960.173834'}]}
2025-07-31 14:06:00,418 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:06:00,423 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:06:00,435 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:06:00] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:06:00,546 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:06:01,176 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:06:05,281 - app.services.google_service - INFO - read_excel_by_file_id:781 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4939
2025-07-31 14:06:05,292 - app.services.google_service - INFO - _read_excel_with_pandas:935 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:06:05,293 - app.services.google_service - INFO - read_excel_by_file_id:810 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:06:05,293 - app.services.google_service - INFO - read_excel_by_file_id:854 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:06:06,244 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:08:02,835 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:08:04,071 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:08:06,773 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:08:06,778 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:08:08,606 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:08:10,169 - app.services.google_service - INFO - _get_oauth_credentials:69 - Refreshed OAuth2 token
2025-07-31 14:08:10,171 - app.services.google_service - INFO - _get_oauth_credentials:94 - Saved OAuth2 token to file
2025-07-31 14:08:10,181 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:10,197 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:10,203 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:08:10,273 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:08:10,287 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:08:18,269 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:08:19,552 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:08:21,980 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:08:21,980 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:08:24,187 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:08:24,194 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:24,204 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:24,210 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:08:24,319 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:08:24,344 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:08:39,874 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:08:41,699 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:08:46,567 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:08:46,568 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:08:49,276 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:08:49,302 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:49,327 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:08:49,345 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:08:49,527 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:08:49,549 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:09:02,062 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:09:03,631 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:09:06,389 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:09:06,391 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:09:08,808 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:09:08,814 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:08,823 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:08,826 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:09:08,889 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:09:08,907 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:09:21,861 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:09:23,462 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:09:25,732 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:09:25,733 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:09:27,663 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:09:27,673 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:27,684 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:27,688 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:09:27,759 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:09:27,773 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:09:34,807 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:09:36,561 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:09:38,148 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:09:38,148 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:09:39,770 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:09:39,779 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:39,794 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:39,801 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:09:39,869 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:09:39,880 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:09:49,538 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:09:49,788 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:09:50,513 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:09:50,514 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:09:52,135 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:09:52,143 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:52,153 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:09:52,165 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:09:52,253 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:09:52,268 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:12:13,365 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 14:12:13,366 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:12:13] "POST /api/command HTTP/1.1" 200 -
2025-07-31 14:12:18,569 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:12:18,570 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960333.886879', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279827385859.9212409550592.389733b166df395bf3553cbf7b0d3ed9', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753960333.886879', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279827376323/v25vGmAdsxe0CUuWpIpfpmGH', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753960338.324911'}]}
2025-07-31 14:12:18,577 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:12:18,578 - app.handlers.command_handler - INFO - handle_list_excel_action:599 - Handling list Excel action
2025-07-31 14:12:18,580 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:12:18] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:12:18,692 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:12:21,757 - app.services.google_service - INFO - list_available_excel_files:1204 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:12:23,438 - app.services.google_service - INFO - list_available_excel_files:1216 - Found 2 Excel files in folder
2025-07-31 14:12:24,470 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:12:43,692 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:12:43,695 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960344.586299', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9279830615827.9212409550592.de462f272215222fd18d9d135a7f20cf', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960344.586299', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9279830615283/wLTWSQRMXkAS5xjr94wrb8hH', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753960363.608843'}]}
2025-07-31 14:12:43,703 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:12:43,703 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:12:43,707 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:12:43] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:12:43,834 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:12:48,837 - app.services.google_service - INFO - read_excel_by_file_id:791 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4939
2025-07-31 14:12:49,298 - app.services.google_service - INFO - _read_excel_with_pandas:948 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:12:49,298 - app.services.google_service - INFO - read_excel_by_file_id:820 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:12:49,299 - app.services.google_service - INFO - read_excel_by_file_id:864 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:12:50,158 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:12:56,946 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:12:56,950 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960370.249059', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280560209174.9212409550592.04fd78a11444d4f4ee9fb3868e86b836', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960370.249059', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'Pmoo7', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'S02Cb'}, {'type': 'section', 'block_id': 'NbdDi', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'RwJib', 'text': {'type': 'plain_text', 'text': 'million | sales', 'emoji': True}}, {'type': 'section', 'block_id': 'Q6z94', 'text': {'type': 'plain_text', 'text': 'million | 899', 'emoji': True}}, {'type': 'actions', 'block_id': '+dz2S', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280560207078/89NSnctUZzdH38eJa3gUZGxY', 'actions': [{'action_id': 'open_update_modal', 'block_id': '+dz2S', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753960376.714349'}]}
2025-07-31 14:12:56,955 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:12:56,955 - app.handlers.command_handler - INFO - handle_open_update_modal_action:558 - Handling open update modal action
2025-07-31 14:12:56,956 - app.handlers.command_handler - INFO - handle_open_update_modal_action:568 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:12:58,198 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280560209174.9212409550592.04fd78a11444d4f4ee9fb3868e86b836
2025-07-31 14:12:58,200 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:12:58] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:13:19,659 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:13:19,661 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283628259506.9212409550592.ae922c093f2da1d9a26198f525852e2f', 'view': {'id': 'V0988GG49EJ', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'sale'}}}}, 'hash': '1753960378.6gFPzfbN', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0988GG49EJ', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:13:19,666 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:13:19,667 - app.handlers.command_handler - INFO - handle_view_submission:767 - Modal submission received
2025-07-31 14:13:19,667 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:792 - Handling write data modal submission
2025-07-31 14:13:19,668 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:850 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: sale
2025-07-31 14:13:19,669 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:13:19] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:13:19,769 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:13:22,557 - app.handlers.command_handler - INFO - update_data_async:914 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=sale
2025-07-31 14:13:22,558 - app.services.google_service - INFO - write_file_data:1408 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=sale
2025-07-31 14:13:23,015 - app.services.google_service - INFO - write_file_data:1413 - Writing to file type: excel
2025-07-31 14:13:23,016 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=sale
2025-07-31 14:13:23,017 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:13:24,125 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmpfgt0zjr1
2025-07-31 14:13:24,126 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:13:24,137 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (2, 2)
2025-07-31 14:13:24,139 - app.services.google_service - INFO - write_excel_data:397 - Converting column B to index 1
2025-07-31 14:13:24,140 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 0, col 1 with value 'sale'
2025-07-31 14:13:24,140 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:13:24,142 - app.services.google_service - INFO - write_excel_data:427 - Successfully updated cell - final shape: (2, 2)
2025-07-31 14:13:24,143 - app.services.google_service - INFO - write_excel_data:431 - Cleaned up NaN values
2025-07-31 14:13:24,143 - app.services.google_service - INFO - write_excel_data:434 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmpfgt0zjr1
2025-07-31 14:13:24,225 - app.services.google_service - INFO - write_excel_data:437 - Successfully wrote Excel file
2025-07-31 14:13:24,225 - app.services.google_service - INFO - write_excel_data:440 - Uploading updated file to Google Drive
2025-07-31 14:13:26,804 - app.services.google_service - INFO - write_excel_data:449 - Successfully uploaded to Google Drive
2025-07-31 14:13:26,906 - app.services.google_service - WARNING - write_excel_data:457 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpfgt0zjr1: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpfgt0zjr1'
2025-07-31 14:13:27,907 - app.services.google_service - WARNING - write_excel_data:463 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpfgt0zjr1: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpfgt0zjr1'
2025-07-31 14:13:27,908 - app.services.google_service - INFO - write_excel_data:466 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B1
2025-07-31 14:13:28,919 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:13:42,285 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:13:42,286 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960344.586299', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9298821856785.9212409550592.de7362a0279ec3962bbdb3f61ce563c9', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960344.586299', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9298821856641/Y0cNcfIdxcRgBa4kpo1ZK0B9', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753960422.260648'}]}
2025-07-31 14:13:42,297 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:13:42,298 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:13:42,300 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:13:42] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:13:42,430 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:13:47,516 - app.services.google_service - INFO - read_excel_by_file_id:791 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4938
2025-07-31 14:13:47,527 - app.services.google_service - INFO - _read_excel_with_pandas:948 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:13:47,527 - app.services.google_service - INFO - read_excel_by_file_id:820 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:13:47,528 - app.services.google_service - INFO - read_excel_by_file_id:864 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:13:49,718 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:16:26,897 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:16:28,755 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:16:29,940 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:16:29,941 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:16:32,738 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:16:32,746 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:16:32,756 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:16:32,761 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:16:32,836 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:16:32,849 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:16:40,020 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:16:40,800 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:16:41,898 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:16:41,899 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:16:43,487 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:16:43,495 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:16:43,518 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:16:43,527 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:16:43,609 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:16:43,626 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:16:56,283 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:16:57,688 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:16:58,690 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:16:58,690 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:17:00,872 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:17:00,883 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:17:00,900 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:17:00,906 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:17:01,001 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:17:01,021 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:17:08,355 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:17:08,692 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:17:09,547 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:17:09,550 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:17:11,406 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:17:11,411 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:17:11,422 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:17:11,429 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:17:11,511 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:17:11,520 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:18:46,457 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:18:47,699 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:18:49,382 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:18:49,382 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:18:50,934 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:18:50,938 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:18:50,947 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:18:50,951 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:18:51,020 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:18:51,030 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:19:34,948 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:19:36,133 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:19:38,135 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:19:38,136 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:19:39,557 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:19:39,562 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:19:39,571 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:19:39,574 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:19:39,639 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:19:39,651 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:19:52,870 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-07-31 14:19:53,240 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:19:54,104 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:19:54,104 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:19:55,687 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:19:55,693 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:19:55,714 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:19:55,724 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:19:55,818 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:19:55,830 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:21:22,203 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 14:21:22,205 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:21:22] "POST /api/command HTTP/1.1" 200 -
2025-07-31 14:21:26,638 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:21:26,640 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960882.801359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268563440871.9212409550592.764be5fa916d97c165d94a9e85923c46', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753960882.801359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268563393559/TwF33xPhBEvckwtV0WTVsE8l', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753960886.363338'}]}
2025-07-31 14:21:26,655 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:21:26,656 - app.handlers.command_handler - INFO - handle_list_excel_action:602 - Handling list Excel action
2025-07-31 14:21:26,708 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:21:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:21:26,884 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:21:30,272 - app.services.google_service - INFO - list_available_excel_files:1204 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:21:31,760 - app.services.google_service - INFO - list_available_excel_files:1216 - Found 2 Excel files in folder
2025-07-31 14:21:32,753 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:21:36,522 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:21:36,523 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960892.831689', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284960087332.9212409550592.bcd4fd2365384ee3a71e6920c50120a5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960892.831689', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284960056548/539wWxJoO5WK9ulqy3FWET4q', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753960896.491035'}]}
2025-07-31 14:21:36,538 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:21:36,553 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:21:36,580 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:21:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:21:36,708 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:21:41,564 - app.services.google_service - INFO - read_excel_by_file_id:791 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4938
2025-07-31 14:21:42,362 - app.services.google_service - INFO - _read_excel_with_pandas:948 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:21:42,363 - app.services.google_service - INFO - read_excel_by_file_id:820 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:21:42,364 - app.services.google_service - INFO - read_excel_by_file_id:864 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:21:43,308 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:24:30,736 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:24:30,736 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960903.420669', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284970972004.9212409550592.b15d7a8f941cf8862548c2bc608f3a0e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960903.420669', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '40T0P', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'tgEyb'}, {'type': 'section', 'block_id': 'sXC0x', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'lTYMb', 'text': {'type': 'plain_text', 'text': 'million | sale', 'emoji': True}}, {'type': 'section', 'block_id': 'sK9rM', 'text': {'type': 'plain_text', 'text': 'million | 899', 'emoji': True}}, {'type': 'actions', 'block_id': 'T/4Kg', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284970962612/z5QM9zOhf4KNUQBlNiuXsWoL', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'T/4Kg', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753961070.498029'}]}
2025-07-31 14:24:30,739 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:24:30,740 - app.handlers.command_handler - INFO - handle_open_update_modal_action:561 - Handling open update modal action
2025-07-31 14:24:30,740 - app.handlers.command_handler - INFO - handle_open_update_modal_action:571 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:24:31,689 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9284970972004.9212409550592.b15d7a8f941cf8862548c2bc608f3a0e
2025-07-31 14:24:31,691 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:24:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:24:48,859 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:24:48,860 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280608300662.9212409550592.c663c90caa5521b572ac02e1b5b99303', 'view': {'id': 'V098ZH56SKA', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '1'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '20'}}}}, 'hash': '1753961071.2KirvmJr', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098ZH56SKA', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:24:48,873 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:24:48,874 - app.handlers.command_handler - INFO - handle_view_submission:770 - Modal submission received
2025-07-31 14:24:48,876 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:795 - Handling write data modal submission
2025-07-31 14:24:48,877 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:853 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 1, Col: B, Value: 20
2025-07-31 14:24:48,890 - app.handlers.command_handler - INFO - update_data_async:903 - DEBUG - Async function start: row=1, col=B, value=20
2025-07-31 14:24:48,891 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:24:48] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:24:49,021 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:24:52,229 - app.handlers.command_handler - INFO - update_data_async:920 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=20
2025-07-31 14:24:52,230 - app.services.google_service - INFO - write_file_data:1412 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=20
2025-07-31 14:24:52,709 - app.services.google_service - INFO - write_file_data:1417 - Writing to file type: excel
2025-07-31 14:24:52,710 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=1, col=B, value=20
2025-07-31 14:24:52,710 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:24:54,167 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmp02jbieel
2025-07-31 14:24:54,167 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:24:54,186 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (2, 2)
2025-07-31 14:24:54,187 - app.services.google_service - INFO - write_excel_data:397 - Converting column B to index 1
2025-07-31 14:24:54,187 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 0, col 1 with value '20'
2025-07-31 14:24:54,188 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:24:54,188 - app.services.google_service - INFO - write_excel_data:427 - Successfully updated cell - final shape: (2, 2)
2025-07-31 14:24:54,195 - app.services.google_service - INFO - write_excel_data:431 - Cleaned up NaN values
2025-07-31 14:24:54,197 - app.services.google_service - INFO - write_excel_data:434 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmp02jbieel
2025-07-31 14:24:54,279 - app.services.google_service - INFO - write_excel_data:437 - Successfully wrote Excel file
2025-07-31 14:24:54,280 - app.services.google_service - INFO - write_excel_data:440 - Uploading updated file to Google Drive
2025-07-31 14:24:56,589 - app.services.google_service - INFO - write_excel_data:449 - Successfully uploaded to Google Drive
2025-07-31 14:24:56,690 - app.services.google_service - WARNING - write_excel_data:457 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp02jbieel: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp02jbieel'
2025-07-31 14:24:57,692 - app.services.google_service - WARNING - write_excel_data:463 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp02jbieel: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp02jbieel'
2025-07-31 14:24:57,693 - app.services.google_service - INFO - write_excel_data:466 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B1
2025-07-31 14:24:57,718 - app.handlers.command_handler - INFO - update_data_async:924 - DEBUG - Success message variables: col=B, row=1, value=20
2025-07-31 14:24:57,719 - app.handlers.command_handler - INFO - update_data_async:945 - DEBUG - Final success message variables: col=B, row=1, value=20
2025-07-31 14:24:58,631 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:25:05,353 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:25:05,354 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960903.420669', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305585509712.9212409550592.e58f2c709cf08ef8a02899be799ccc6d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753960903.420669', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '40T0P', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'tgEyb'}, {'type': 'section', 'block_id': 'sXC0x', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'lTYMb', 'text': {'type': 'plain_text', 'text': 'million | sale', 'emoji': True}}, {'type': 'section', 'block_id': 'sK9rM', 'text': {'type': 'plain_text', 'text': 'million | 899', 'emoji': True}}, {'type': 'actions', 'block_id': 'T/4Kg', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305585471984/9HAwd8IPuKwsMN270wz6za8r', 'actions': [{'action_id': 'refresh_data', 'block_id': 'T/4Kg', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753961105.080544'}]}
2025-07-31 14:25:05,357 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:25:05,358 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 14:25:05,359 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:25:05] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:25:05,472 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:25:08,436 - app.services.google_service - INFO - read_file_data:1280 - Reading file data: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:25:09,122 - app.services.google_service - INFO - read_file_data:1285 - File type determined: excel
2025-07-31 14:25:10,723 - app.services.google_service - INFO - _read_excel_file:1338 - DEBUG - Excel read: shape=(2, 2), headers=['name', 'salary']
2025-07-31 14:25:10,724 - app.services.google_service - INFO - _read_excel_file:1339 - DEBUG - Excel data: [['million', 20], ['million', 899]]
2025-07-31 14:25:10,725 - app.handlers.command_handler - INFO - refresh_data:490 - DEBUG - Excel refresh: original_data=[['million', 20], ['million', 899]]
2025-07-31 14:25:10,726 - app.handlers.command_handler - INFO - refresh_data:491 - DEBUG - Excel refresh: headers=['name', 'salary']
2025-07-31 14:25:10,726 - app.handlers.command_handler - INFO - refresh_data:492 - DEBUG - Excel refresh: final_data=[['name', 'salary'], ['million', 20], ['million', 899]]
2025-07-31 14:25:11,617 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:29:15,935 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:29:15,936 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753960882.801359', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268595652775.9212409550592.23207d3fbdf835b653d16fe72355ef26', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753960882.801359', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268595651735/pwl0khZhsXPBkjh62mJqo4zH', 'actions': [{'action_id': 'list_csv_menu', 'block_id': 'L+vd+', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753961355.715580'}]}
2025-07-31 14:29:15,942 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:29:15,945 - app.handlers.command_handler - INFO - handle_list_csv_action:686 - Handling list CSV action
2025-07-31 14:29:15,948 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:29:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:29:16,047 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:29:18,907 - app.services.google_service - INFO - list_available_csv_files:1245 - Searching for CSV files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:29:19,836 - app.services.google_service - INFO - list_available_csv_files:1257 - Found 1 CSV files in folder
2025-07-31 14:29:20,748 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:29:32,293 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:29:32,294 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753961360.857819', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9284991935572.9212409550592.6da5bb4c2b1f7bdefcd32f38a34e8342', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753961360.857819', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'DSR0C', 'text': {'type': 'plain_text', 'text': ':clipboard: Available CSV Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'i3Cyd'}, {'type': 'section', 'block_id': '1IvlH', 'text': {'type': 'mrkdwn', 'text': '*1. sales data.csv*\n:id: `1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9284991923172/2874Ag4WC4JdpZccUzflQWmG', 'actions': [{'action_id': 'get_data_csv_1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'block_id': '1IvlH', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'type': 'button', 'action_ts': '1753961372.034502'}]}
2025-07-31 14:29:32,302 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:29:32,303 - app.handlers.command_handler - INFO - handle_get_data_csv_action:375 - Handling get data CSV action
2025-07-31 14:29:32,305 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:29:32] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:29:32,439 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:29:36,169 - app.services.google_service - INFO - read_csv_by_file_id:653 - Read 0 rows from CSV file ID: 1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq
2025-07-31 14:29:37,038 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:32:07,139 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:32:07,872 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:32:09,060 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:32:09,061 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:32:10,883 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:32:10,888 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:32:10,899 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:32:10,905 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:32:10,991 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:32:11,062 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:38:44,261 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 14:38:45,988 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:38:47,765 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:38:47,766 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:40:25,533 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:40:25,533 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:40:34,018 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:40:34,019 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:44:46,093 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:44:46,100 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:46:39,568 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:46:39,568 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:50:12,379 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:50:12,383 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:56:55,328 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:56:55,331 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:56:58,090 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:56:58,098 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:56:58,112 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:56:58,119 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:56:58,311 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 14:56:58,313 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 14:56:58,316 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 14:56:59,033 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 14:56:59,034 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 14:57:00,639 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 14:57:00,646 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:57:00,660 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:57:00,673 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 14:57:00,818 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 14:57:00,830 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 14:57:11,222 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 14:57:11,226 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:57:11] "POST /api/command HTTP/1.1" 200 -
2025-07-31 14:57:17,555 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:57:17,559 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963031.776309', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280746146758.9212409550592.d55c6e716fa958b16d6dc85d7a53e77d', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753963031.776309', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280746146246/WXdIP8Yqni92Eyk2jjxDX0bc', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753963037.293962'}]}
2025-07-31 14:57:17,647 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:57:17,660 - app.handlers.command_handler - INFO - handle_list_excel_action:601 - Handling list Excel action
2025-07-31 14:57:17,664 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:57:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:57:17,926 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:57:22,133 - app.services.google_service - INFO - list_available_excel_files:1204 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 14:57:24,131 - app.services.google_service - INFO - list_available_excel_files:1216 - Found 2 Excel files in folder
2025-07-31 14:57:25,288 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:57:30,218 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:57:30,228 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963045.328119', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305707772432.9212409550592.62406de84be474f7b82072970b3ee699', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963045.328119', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'y+4oM', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Excel Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'HNP/L'}, {'type': 'section', 'block_id': 'zXB1v', 'text': {'type': 'mrkdwn', 'text': '*1. sales report.xlsx*\n:id: `1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}}, {'type': 'divider', 'block_id': 'LcC5L'}, {'type': 'section', 'block_id': 'jHgrE', 'text': {'type': 'mrkdwn', 'text': '*2. abc.xlsx*\n:id: `1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV`\n:date: Modified: 2025-07-31\n:page_facing_up: .XLSX\n:link: <https://docs.google.com/spreadsheets/d/1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV/edit?usp=drivesdk&amp;ouid=114214836504731748091&amp;rtpof=true&amp;sd=true|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_excel_1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1WsTpSas9UYsbe_CPuq4RewMEPrj38BgV'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305707740848/qnB9teXOpSSvhePh3bpG814W', 'actions': [{'action_id': 'get_data_excel_1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'block_id': 'zXB1v', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb', 'type': 'button', 'action_ts': '1753963049.984365'}]}
2025-07-31 14:57:30,275 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:57:30,282 - app.handlers.command_handler - INFO - handle_get_data_excel_action:304 - Handling get data Excel action
2025-07-31 14:57:30,308 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:57:30] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:57:30,487 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:57:36,211 - app.services.google_service - INFO - read_excel_by_file_id:791 - Processing Excel file: sales report.xlsx, extension: '.xlsx', mime: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, size: 4938
2025-07-31 14:57:38,924 - app.services.google_service - INFO - _read_excel_with_pandas:948 - Successfully read Excel file with pandas: 3 rows
2025-07-31 14:57:38,926 - app.services.google_service - INFO - read_excel_by_file_id:820 - Successfully read Excel file with pandas: sales report.xlsx
2025-07-31 14:57:38,928 - app.services.google_service - INFO - read_excel_by_file_id:864 - Read 3 rows from Excel file ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:57:39,856 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:58:08,944 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:58:08,947 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963059.977459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9283808592274.9212409550592.4de886bca84b8da5b50c83fe60fdd60a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963059.977459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'Z5M6Q', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'gUIuE'}, {'type': 'section', 'block_id': '7BPDD', 'text': {'type': 'mrkdwn', 'text': ":warning: *Header can't be edited. Row numbers start from the second row.*", 'verbatim': False}}, {'type': 'section', 'block_id': '+3vqd', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'j2j7N', 'text': {'type': 'plain_text', 'text': 'million | 20', 'emoji': True}}, {'type': 'section', 'block_id': 'lhtQO', 'text': {'type': 'plain_text', 'text': 'million | 899', 'emoji': True}}, {'type': 'actions', 'block_id': 'iofV0', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9283808587938/gHaMH1juqGOMazo4wctJ4WkQ', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'iofV0', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753963088.879804'}]}
2025-07-31 14:58:08,977 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:58:09,030 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 14:58:09,046 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:58:10,013 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9283808592274.9212409550592.4de886bca84b8da5b50c83fe60fdd60a
2025-07-31 14:58:10,016 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:58:10] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:58:25,970 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:58:25,976 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280025755459.9212409550592.7fb78c6b6af3ded329a2433c5c651395', 'view': {'id': 'V098D3ANM7W', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '3'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'abi'}}}}, 'hash': '1753963090.ta2lb7ZX', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098D3ANM7W', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:58:26,097 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:58:26,099 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 14:58:26,099 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 14:58:26,114 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:852 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 3, Col: A, Value: abi
2025-07-31 14:58:26,116 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=3, col=A, value=abi
2025-07-31 14:58:26,116 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:58:26] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:58:26,294 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:58:30,154 - app.handlers.command_handler - INFO - update_data_async:919 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=A, value=abi
2025-07-31 14:58:30,156 - app.services.google_service - INFO - write_file_data:1412 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=A, value=abi
2025-07-31 14:58:30,674 - app.services.google_service - INFO - write_file_data:1417 - Writing to file type: excel
2025-07-31 14:58:30,676 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=A, value=abi
2025-07-31 14:58:30,678 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:58:32,045 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmpv9pib4hu
2025-07-31 14:58:32,048 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:58:32,078 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (2, 2)
2025-07-31 14:58:32,088 - app.services.google_service - INFO - write_excel_data:397 - Converting column A to index 0
2025-07-31 14:58:32,092 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 2, col 0 with value 'abi'
2025-07-31 14:58:32,103 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:58:32,108 - app.services.google_service - INFO - write_excel_data:409 - Extending DataFrame rows from 2 to 3
2025-07-31 14:58:32,118 - app.services.google_service - INFO - write_excel_data:427 - Successfully updated cell - final shape: (3, 2)
2025-07-31 14:58:32,135 - app.services.google_service - INFO - write_excel_data:431 - Cleaned up NaN values
2025-07-31 14:58:32,138 - app.services.google_service - INFO - write_excel_data:434 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmpv9pib4hu
2025-07-31 14:58:32,368 - app.services.google_service - INFO - write_excel_data:437 - Successfully wrote Excel file
2025-07-31 14:58:32,369 - app.services.google_service - INFO - write_excel_data:440 - Uploading updated file to Google Drive
2025-07-31 14:58:34,567 - app.services.google_service - INFO - write_excel_data:449 - Successfully uploaded to Google Drive
2025-07-31 14:58:34,673 - app.services.google_service - WARNING - write_excel_data:457 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpv9pib4hu: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpv9pib4hu'
2025-07-31 14:58:35,677 - app.services.google_service - WARNING - write_excel_data:463 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmpv9pib4hu: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpv9pib4hu'
2025-07-31 14:58:35,681 - app.services.google_service - INFO - write_excel_data:466 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at A3
2025-07-31 14:58:35,711 - app.handlers.command_handler - INFO - update_data_async:923 - DEBUG - Success message variables: col=A, row=3, value=abi
2025-07-31 14:58:35,715 - app.handlers.command_handler - INFO - update_data_async:944 - DEBUG - Final success message variables: col=A, row=3, value=abi
2025-07-31 14:58:36,654 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:58:40,647 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:58:40,651 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963059.977459', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9299009692817.9212409550592.9d6d30ebcb64dfff8898b3317976a546', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963059.977459', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'Z5M6Q', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'gUIuE'}, {'type': 'section', 'block_id': '7BPDD', 'text': {'type': 'mrkdwn', 'text': ":warning: *Header can't be edited. Row numbers start from the second row.*", 'verbatim': False}}, {'type': 'section', 'block_id': '+3vqd', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'j2j7N', 'text': {'type': 'plain_text', 'text': 'million | 20', 'emoji': True}}, {'type': 'section', 'block_id': 'lhtQO', 'text': {'type': 'plain_text', 'text': 'million | 899', 'emoji': True}}, {'type': 'actions', 'block_id': 'iofV0', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9299009667393/oimh4XxGmhpBOY5J0YilVEQ0', 'actions': [{'action_id': 'refresh_data', 'block_id': 'iofV0', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753963120.572930'}]}
2025-07-31 14:58:40,747 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:58:40,762 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 14:58:40,795 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:58:40] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:58:40,973 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:58:44,890 - app.services.google_service - INFO - read_file_data:1280 - Reading file data: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:58:45,332 - app.services.google_service - INFO - read_file_data:1285 - File type determined: excel
2025-07-31 14:58:46,961 - app.services.google_service - INFO - _read_excel_file:1338 - DEBUG - Excel read: shape=(3, 2), headers=['name', 'salary']
2025-07-31 14:58:46,962 - app.services.google_service - INFO - _read_excel_file:1339 - DEBUG - Excel data: [['million', 20.0], ['million', 899.0], ['abi', '']]
2025-07-31 14:58:46,964 - app.handlers.command_handler - INFO - refresh_data:490 - DEBUG - Excel refresh: original_data=[['million', 20.0], ['million', 899.0], ['abi', '']]
2025-07-31 14:58:46,966 - app.handlers.command_handler - INFO - refresh_data:491 - DEBUG - Excel refresh: headers=['name', 'salary']
2025-07-31 14:58:46,966 - app.handlers.command_handler - INFO - refresh_data:492 - DEBUG - Excel refresh: final_data=[['name', 'salary'], ['million', 20.0], ['million', 899.0], ['abi', '']]
2025-07-31 14:58:47,989 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:59:12,116 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:59:12,119 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963128.128679', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280755684854.9212409550592.0d36d0932f61d55570bd64f944ef0bf7', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963128.128679', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'fDnaR', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'juMx9'}, {'type': 'section', 'block_id': '3rzJx', 'text': {'type': 'mrkdwn', 'text': ":warning: *Header can't be edited. Row numbers start from the second row.*", 'verbatim': False}}, {'type': 'section', 'block_id': '9gWfU', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'NMpUZ', 'text': {'type': 'plain_text', 'text': 'million | 20.0', 'emoji': True}}, {'type': 'section', 'block_id': 'Akz2L', 'text': {'type': 'plain_text', 'text': 'million | 899.0', 'emoji': True}}, {'type': 'section', 'block_id': 'hee+F', 'text': {'type': 'plain_text', 'text': 'abi | ', 'emoji': True}}, {'type': 'actions', 'block_id': 'p5oBY', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280755684582/g5NjDLk0Fy4xoCHXv2TRWaec', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'p5oBY', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753963152.083446'}]}
2025-07-31 14:59:12,135 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:59:12,137 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 14:59:12,139 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: excel, params: {'file_id': '1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb'}
2025-07-31 14:59:13,135 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280755684854.9212409550592.0d36d0932f61d55570bd64f944ef0bf7
2025-07-31 14:59:13,188 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:59:13] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:59:44,625 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:59:44,633 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9280758747350.9212409550592.3cb2ceb8cf59a1c8e3e8d8966bca9ede', 'view': {'id': 'V0989U2R345', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "excel", "file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}', 'callback_id': 'write_excel_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '3'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '22'}}}}, 'hash': '1753963153.oi3sOwQ9', 'title': {'type': 'plain_text', 'text': 'Update Excel', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V0989U2R345', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 14:59:44,669 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 14:59:44,673 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 14:59:44,686 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 14:59:44,688 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:852 - Modal values - Excel File ID: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, Row: 3, Col: B, Value: 22
2025-07-31 14:59:44,702 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=3, col=B, value=22
2025-07-31 14:59:44,703 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:59:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:59:44,888 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:59:48,510 - app.handlers.command_handler - INFO - update_data_async:919 - Attempting to write Excel data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=B, value=22
2025-07-31 14:59:48,513 - app.services.google_service - INFO - write_file_data:1412 - Writing data: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=B, value=22
2025-07-31 14:59:49,011 - app.services.google_service - INFO - write_file_data:1417 - Writing to file type: excel
2025-07-31 14:59:49,022 - app.services.google_service - INFO - write_excel_data:380 - Starting Excel write: file_id=1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb, row=3, col=B, value=22
2025-07-31 14:59:49,028 - app.services.google_service - INFO - write_excel_data:386 - Downloading Excel file: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:59:50,454 - app.services.google_service - INFO - write_excel_data:388 - Downloaded to: C:\Users\dell\AppData\Local\Temp\tmp8tko2qru
2025-07-31 14:59:50,458 - app.services.google_service - INFO - write_excel_data:391 - Reading Excel file with pandas
2025-07-31 14:59:50,529 - app.services.google_service - INFO - write_excel_data:393 - Read DataFrame with shape: (3, 2)
2025-07-31 14:59:50,535 - app.services.google_service - INFO - write_excel_data:397 - Converting column B to index 1
2025-07-31 14:59:50,536 - app.services.google_service - INFO - write_excel_data:400 - Updating cell at row 2, col 1 with value '22'
2025-07-31 14:59:50,541 - app.services.google_service - INFO - write_excel_data:403 - Ensuring DataFrame has sufficient size
2025-07-31 14:59:50,691 - app.services.google_service - INFO - write_excel_data:427 - Successfully updated cell - final shape: (3, 2)
2025-07-31 14:59:50,692 - app.services.google_service - INFO - write_excel_data:431 - Cleaned up NaN values
2025-07-31 14:59:50,692 - app.services.google_service - INFO - write_excel_data:434 - Writing DataFrame back to file: C:\Users\dell\AppData\Local\Temp\tmp8tko2qru
2025-07-31 14:59:51,032 - app.services.google_service - INFO - write_excel_data:437 - Successfully wrote Excel file
2025-07-31 14:59:51,035 - app.services.google_service - INFO - write_excel_data:440 - Uploading updated file to Google Drive
2025-07-31 14:59:51,999 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 14:59:52,001 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963128.128679', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280034316195.9212409550592.822a9248606bb5d56151f8b00c60f1e9', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963128.128679', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'fDnaR', 'text': {'type': 'mrkdwn', 'text': '*Data from EXCEL*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'juMx9'}, {'type': 'section', 'block_id': '3rzJx', 'text': {'type': 'mrkdwn', 'text': ":warning: *Header can't be edited. Row numbers start from the second row.*", 'verbatim': False}}, {'type': 'section', 'block_id': '9gWfU', 'text': {'type': 'mrkdwn', 'text': '*name | salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'NMpUZ', 'text': {'type': 'plain_text', 'text': 'million | 20.0', 'emoji': True}}, {'type': 'section', 'block_id': 'Akz2L', 'text': {'type': 'plain_text', 'text': 'million | 899.0', 'emoji': True}}, {'type': 'section', 'block_id': 'hee+F', 'text': {'type': 'plain_text', 'text': 'abi | ', 'emoji': True}}, {'type': 'actions', 'block_id': 'p5oBY', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280034252179/66FM7yKHdBlndc89BGiq4ZV2', 'actions': [{'action_id': 'refresh_data', 'block_id': 'p5oBY', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "excel", "params": {"file_id": "1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb"}}', 'type': 'button', 'action_ts': '1753963191.788196'}]}
2025-07-31 14:59:52,016 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 14:59:52,019 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 14:59:52,027 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 14:59:52] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 14:59:52,198 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 14:59:53,570 - app.services.google_service - INFO - write_excel_data:449 - Successfully uploaded to Google Drive
2025-07-31 14:59:53,672 - app.services.google_service - WARNING - write_excel_data:457 - Could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp8tko2qru: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp8tko2qru'
2025-07-31 14:59:54,675 - app.services.google_service - WARNING - write_excel_data:463 - Still could not delete temporary file C:\Users\dell\AppData\Local\Temp\tmp8tko2qru: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmp8tko2qru'
2025-07-31 14:59:54,676 - app.services.google_service - INFO - write_excel_data:466 - Updated Excel file 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb at B3
2025-07-31 14:59:54,722 - app.handlers.command_handler - INFO - update_data_async:923 - DEBUG - Success message variables: col=B, row=3, value=22
2025-07-31 14:59:54,729 - app.handlers.command_handler - INFO - update_data_async:944 - DEBUG - Final success message variables: col=B, row=3, value=22
2025-07-31 14:59:55,635 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 14:59:56,170 - app.services.google_service - INFO - read_file_data:1280 - Reading file data: 1m7Jze_c4OS3QaqzMC1B0WBIwUW8QocDb
2025-07-31 14:59:56,611 - app.services.google_service - INFO - read_file_data:1285 - File type determined: excel
2025-07-31 14:59:58,479 - app.services.google_service - INFO - _read_excel_file:1338 - DEBUG - Excel read: shape=(3, 2), headers=['name', 'salary']
2025-07-31 14:59:58,482 - app.services.google_service - INFO - _read_excel_file:1339 - DEBUG - Excel data: [['million', 20], ['million', 899], ['abi', 22]]
2025-07-31 14:59:58,486 - app.handlers.command_handler - INFO - refresh_data:490 - DEBUG - Excel refresh: original_data=[['million', 20], ['million', 899], ['abi', 22]]
2025-07-31 14:59:58,520 - app.handlers.command_handler - INFO - refresh_data:491 - DEBUG - Excel refresh: headers=['name', 'salary']
2025-07-31 14:59:58,533 - app.handlers.command_handler - INFO - refresh_data:492 - DEBUG - Excel refresh: final_data=[['name', 'salary'], ['million', 20], ['million', 899], ['abi', 22]]
2025-07-31 14:59:59,453 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:00:14,385 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 15:00:14,388 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:00:14] "POST /api/command HTTP/1.1" 200 -
2025-07-31 15:00:19,836 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:00:19,849 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963214.944029', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280763215574.9212409550592.4196082b0f47c24e002ec26f4292bf5a', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753963214.944029', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280763211542/XPn4yVoBJniYrN6r4hIN6LYj', 'actions': [{'action_id': 'list_excel_menu', 'block_id': 'EbC0F', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753963219.417889'}]}
2025-07-31 15:00:19,924 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:00:19,941 - app.handlers.command_handler - INFO - handle_list_excel_action:601 - Handling list Excel action
2025-07-31 15:00:19,953 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:00:19] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:00:20,113 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:00:24,452 - app.services.google_service - INFO - list_available_excel_files:1204 - Searching for Excel files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 15:00:24,999 - app.services.google_service - INFO - list_available_excel_files:1216 - Found 2 Excel files in folder
2025-07-31 15:00:25,897 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:00:34,991 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:00:34,994 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963214.944029', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280040069587.9212409550592.08d697d3a092ca4d63c3303635a394da', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753963214.944029', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280039982147/r7EleooUOLfuACcxu1DPTFO4', 'actions': [{'action_id': 'list_sheets_menu', 'block_id': '4dxlO', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753963234.715798'}]}
2025-07-31 15:00:35,078 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:00:35,181 - app.handlers.command_handler - INFO - handle_list_sheets_action:145 - Handling list sheets action
2025-07-31 15:00:35,251 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:00:35] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:00:35,397 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:00:39,231 - app.services.google_service - INFO - list_available_sheets:1163 - Searching for sheets in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 15:00:39,767 - app.services.google_service - INFO - list_available_sheets:1175 - Found 5 Google Sheets in folder
2025-07-31 15:00:40,669 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:01:01,731 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:01:01,734 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963240.802759', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9299025566001.9212409550592.363705a824701a0255ce6343c5a88d72', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963240.802759', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'aXCt7', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'MOhyY'}, {'type': 'section', 'block_id': 'NOud0', 'text': {'type': 'mrkdwn', 'text': '*1. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'h4r6s'}, {'type': 'section', 'block_id': 'da/Fz', 'text': {'type': 'mrkdwn', 'text': '*2. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}, {'type': 'divider', 'block_id': 'fXwqB'}, {'type': 'section', 'block_id': 'v8iI1', 'text': {'type': 'mrkdwn', 'text': '*3. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'E6wkf'}, {'type': 'section', 'block_id': 'wNUKw', 'text': {'type': 'mrkdwn', 'text': '*4. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'Bc5jl'}, {'type': 'section', 'block_id': 'RR03E', 'text': {'type': 'mrkdwn', 'text': '*5. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9299025366769/F0aubj5BzAkvI1ImRhRgqEy7', 'actions': [{'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'block_id': 'da/Fz', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'type': 'button', 'action_ts': '1753963261.463335'}]}
2025-07-31 15:01:01,860 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:01:01,869 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:233 - Handling get data sheet action
2025-07-31 15:01:01,886 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:01:01] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:01:02,061 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:01:09,169 - app.services.google_service - INFO - read_sheet_data:309 - Read 5 rows from sheet 1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c
2025-07-31 15:01:10,141 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:01:24,193 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:01:24,194 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963240.802759', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280046787731.9212409550592.bb9327cbefa319f056af6792da7b455c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963240.802759', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'aXCt7', 'text': {'type': 'plain_text', 'text': ':bar_chart: Available Google Sheets', 'emoji': True}}, {'type': 'divider', 'block_id': 'MOhyY'}, {'type': 'section', 'block_id': 'NOud0', 'text': {'type': 'mrkdwn', 'text': '*1. slack2*\n:id: `1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1DZ8fMoL4j0Xm4lNMFHvssSIwPW50en8glETLKUZRuq0'}}, {'type': 'divider', 'block_id': 'h4r6s'}, {'type': 'section', 'block_id': 'da/Fz', 'text': {'type': 'mrkdwn', 'text': '*2. slack*\n:id: `1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1H-gxlBQ4tD2F-7qt4OzACXwdP8f5PABvxEzbbde0m_c'}}, {'type': 'divider', 'block_id': 'fXwqB'}, {'type': 'section', 'block_id': 'v8iI1', 'text': {'type': 'mrkdwn', 'text': '*3. mmm*\n:id: `1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1sltVnqRiPalv28AE2s_PIsNELIczjV9b_RKEJCLXdW0'}}, {'type': 'divider', 'block_id': 'E6wkf'}, {'type': 'section', 'block_id': 'wNUKw', 'text': {'type': 'mrkdwn', 'text': '*4. projects*\n:id: `1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}}, {'type': 'divider', 'block_id': 'Bc5jl'}, {'type': 'section', 'block_id': 'RR03E', 'text': {'type': 'mrkdwn', 'text': '*5. opn*\n:id: `16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU`\n:date: Modified: 2025-07-31\n:link: <https://docs.google.com/spreadsheets/d/16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU/edit?usp=drivesdk|Open in Google Sheets>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_sheet_16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '16R2rVvVgSbXFqwUy-4clH25PzvIh5Hwv7AfmcTCNMOU'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280046727747/LwGZvfU6rXrhq7Twcj25EtEK', 'actions': [{'action_id': 'get_data_sheet_1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'block_id': 'wNUKw', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE', 'type': 'button', 'action_ts': '1753963283.966193'}]}
2025-07-31 15:01:24,210 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:01:24,211 - app.handlers.command_handler - INFO - handle_get_data_sheet_action:233 - Handling get data sheet action
2025-07-31 15:01:24,212 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:01:24] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:01:24,351 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:01:29,118 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 15:01:30,035 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:02:26,313 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:02:26,317 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963290.171109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9285139431540.9212409550592.5c0502627f8b8699a7530fa709b5f03c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963290.171109', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'YAk1n', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'BmymG'}, {'type': 'section', 'block_id': 'Rd7ok', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': 'LeVra', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': '77y7N', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9285139409620/TOM4LINH3h4xntQ2JQNnpQMB', 'actions': [{'action_id': 'open_update_modal', 'block_id': '77y7N', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963346.277478'}]}
2025-07-31 15:02:26,362 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:02:26,367 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 15:02:26,378 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, params: {'sheet_id': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}
2025-07-31 15:02:27,344 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9285139431540.9212409550592.5c0502627f8b8699a7530fa709b5f03c
2025-07-31 15:02:27,352 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:02:27] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:02:41,390 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:02:41,391 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9268749653879.9212409550592.e4c69587914e2eca74696dd366d01ced', 'view': {'id': 'V097WN2G9D5', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'pending'}}}}, 'hash': '1753963347.Sj9Nx40n', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V097WN2G9D5', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 15:02:41,407 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 15:02:41,408 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 15:02:41,409 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 15:02:41,436 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:856 - Modal values - Sheet ID: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, Row: 2, Col: B, Value: pending
2025-07-31 15:02:41,441 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=2, col=B, value=pending
2025-07-31 15:02:41,442 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:02:41] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:02:41,679 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:02:46,616 - app.services.google_service - INFO - write_sheet_data:359 - Wrote data to sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE at range B2
2025-07-31 15:02:46,620 - app.handlers.command_handler - INFO - update_data_async:944 - DEBUG - Final success message variables: col=B, row=2, value=pending
2025-07-31 15:02:46,850 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:02:46,851 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963290.171109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268751823319.9212409550592.a49ce0f71be565b9a469afccfb009a0c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963290.171109', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'YAk1n', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'BmymG'}, {'type': 'section', 'block_id': 'Rd7ok', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': 'LeVra', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': '77y7N', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268751820551/mUK6i01ifKmiPQ9bvXDc3TOP', 'actions': [{'action_id': 'refresh_data', 'block_id': '77y7N', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963366.878897'}]}
2025-07-31 15:02:46,861 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:02:46,863 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:02:46,865 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:02:46] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:02:47,009 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:02:47,530 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:02:50,254 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:02:50,257 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963290.171109', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280780020758.9212409550592.d136130a72cb77e1e461eba8130d5c9e', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963290.171109', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'YAk1n', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'BmymG'}, {'type': 'section', 'block_id': 'Rd7ok', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': 'LeVra', 'text': {'type': 'plain_text', 'text': ' | Not Started |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': '77y7N', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280780005574/IgwLG2OXT7SxUah8Y4BGEfiE', 'actions': [{'action_id': 'refresh_data', 'block_id': '77y7N', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963370.256834'}]}
2025-07-31 15:02:50,261 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:02:50,262 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:02:50,264 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:02:50] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:02:50,415 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:02:52,095 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 15:02:53,983 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:02:55,369 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 15:02:56,234 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:03:22,570 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:03:22,579 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963376.378469', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280055178723.9212409550592.4c9d889446c9db0eceba5cfcf925b592', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963376.378469', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'SDKOe', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'N8/0U'}, {'type': 'section', 'block_id': 'Bh+f7', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': '6seAI', 'text': {'type': 'plain_text', 'text': ' | pending |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'J98Q6', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280055165571/yZwUZBnuYRVfEzLN1wEbw6Pj', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'J98Q6', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963402.541277'}]}
2025-07-31 15:03:22,671 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:03:22,685 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 15:03:22,687 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, params: {'sheet_id': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}
2025-07-31 15:03:23,692 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280055178723.9212409550592.4c9d889446c9db0eceba5cfcf925b592
2025-07-31 15:03:23,697 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:03:23] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:03:38,128 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:03:38,130 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9268755572167.9212409550592.65a4b365d1ef1e0ccb6ac7a5ce030c77', 'view': {'id': 'V098D46KGN8', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'A'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'app'}}}}, 'hash': '1753963403.Ej90FQFt', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098D46KGN8', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 15:03:38,145 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 15:03:38,147 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 15:03:38,148 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 15:03:38,150 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:856 - Modal values - Sheet ID: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, Row: 2, Col: A, Value: app
2025-07-31 15:03:38,152 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=2, col=A, value=app
2025-07-31 15:03:38,154 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:03:38] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:03:38,315 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:03:43,527 - app.services.google_service - INFO - write_sheet_data:359 - Wrote data to sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE at range A2
2025-07-31 15:03:43,528 - app.handlers.command_handler - INFO - update_data_async:944 - DEBUG - Final success message variables: col=A, row=2, value=app
2025-07-31 15:03:44,572 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:03:47,594 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:03:47,597 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963376.378469', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268757621559.9212409550592.036467f18d8be7c8a4f06f587faefe48', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963376.378469', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'SDKOe', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'N8/0U'}, {'type': 'section', 'block_id': 'Bh+f7', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': '6seAI', 'text': {'type': 'plain_text', 'text': ' | pending |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': 'J98Q6', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268757621431/5Qdsb90qaXWWMeOC2vYekWEW', 'actions': [{'action_id': 'refresh_data', 'block_id': 'J98Q6', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963427.584432'}]}
2025-07-31 15:03:47,693 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:03:47,695 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:03:47,697 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:03:47] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:03:47,846 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:03:52,665 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 15:03:53,572 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:04:21,245 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:04:21,246 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963433.706129', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280787555686.9212409550592.0c1f06dbeee0cdf9de0603d7e2ab5751', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963433.706129', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '6TFG9', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'cgFQF'}, {'type': 'section', 'block_id': 'qvmuJ', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': 'XuL7s', 'text': {'type': 'plain_text', 'text': 'app | pending |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': '2zwjr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280787507286/g8IFAy5WLMVIVfkZPr5rEQ55', 'actions': [{'action_id': 'open_update_modal', 'block_id': '2zwjr', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963461.241002'}]}
2025-07-31 15:04:21,277 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:04:21,279 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 15:04:21,280 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, params: {'sheet_id': '1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE'}
2025-07-31 15:04:22,211 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280787555686.9212409550592.0c1f06dbeee0cdf9de0603d7e2ab5751
2025-07-31 15:04:22,213 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:04:22] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:04:36,518 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:04:36,523 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9285150214180.9212409550592.bd18fa405d8d19da7e6ef29761669d05', 'view': {'id': 'V09881V5L03', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "sheet", "sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}', 'callback_id': 'write_sheet_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'C'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': '12'}}}}, 'hash': '1753963462.JRTESUm3', 'title': {'type': 'plain_text', 'text': 'Update Sheet', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V09881V5L03', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 15:04:36,675 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 15:04:36,677 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 15:04:36,678 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 15:04:36,680 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:856 - Modal values - Sheet ID: 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE, Row: 2, Col: C, Value: 12
2025-07-31 15:04:36,728 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=2, col=C, value=12
2025-07-31 15:04:36,729 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:04:36] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:04:36,950 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:04:42,208 - app.services.google_service - INFO - write_sheet_data:359 - Wrote data to sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE at range C2
2025-07-31 15:04:42,209 - app.handlers.command_handler - INFO - update_data_async:944 - DEBUG - Final success message variables: col=C, row=2, value=12
2025-07-31 15:04:43,168 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:04:46,690 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:04:46,696 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963433.706129', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9268761365175.9212409550592.d517dd0673eab4205e2252b7835ee604', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963433.706129', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '6TFG9', 'text': {'type': 'mrkdwn', 'text': '*Data from 1OKGFKL1GUGGI4CZEREEMSDPZRKJCSOLANM4MRBK4UBE*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'cgFQF'}, {'type': 'section', 'block_id': 'qvmuJ', 'text': {'type': 'mrkdwn', 'text': '*Task | Status | Assignee | Due Date | Priority*', 'verbatim': False}}, {'type': 'section', 'block_id': 'XuL7s', 'text': {'type': 'plain_text', 'text': 'app | pending |  |  | Medium', 'emoji': True}}, {'type': 'actions', 'block_id': '2zwjr', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9268761314087/9jv3wekmtlHIfuZknh5LXZay', 'actions': [{'action_id': 'refresh_data', 'block_id': '2zwjr', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE", "params": {"sheet_id": "1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE"}}', 'type': 'button', 'action_ts': '1753963486.646690'}]}
2025-07-31 15:04:46,756 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:04:46,787 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:04:46,852 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:04:46] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:04:47,008 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:04:52,049 - app.services.google_service - INFO - read_sheet_data:309 - Read 2 rows from sheet 1OKgFKL1gUGGI4czeReemSdpZRKjCSolaNm4MRBK4UbE
2025-07-31 15:04:53,059 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:08:08,278 - app.utils.helpers - INFO - log_request:26 - Request: U0968C1G72L | User: slash_command_/start | Details: {'text': ''}
2025-07-31 15:08:08,282 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:08:08] "POST /api/command HTTP/1.1" 200 -
2025-07-31 15:08:15,200 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:08:15,201 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963688.894259', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280081525699.9212409550592.ac1b285cb255c510bf485f4b32c807e5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'subtype': 'bot_message', 'text': 'Welcome to Slack Data Manager Bot!', 'type': 'message', 'ts': '1753963688.894259', 'bot_id': 'B0981PK5WQK', 'blocks': [{'type': 'section', 'block_id': '8dFn+', 'text': {'type': 'mrkdwn', 'text': "Hello! I'm your Data Manager Bot. How can I help you today?", 'verbatim': False}}, {'type': 'divider', 'block_id': 'R27Zu'}, {'type': 'section', 'block_id': '4dxlO', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List Sheets*\nView all available Google Sheets', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_sheets_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Sheets', 'emoji': True}}}, {'type': 'section', 'block_id': '/Di18', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create New Sheet*\nCreate a new Google Sheet in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_sheet_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Sheet', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd5hKP'}, {'type': 'section', 'block_id': 'EbC0F', 'text': {'type': 'mrkdwn', 'text': '*:bar_chart: List Excel Files*\nView all available Excel files\n\n*Supported formats:* .xlsx, .xlsm, .xltx, .xltm', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List Excel', 'emoji': True}}}, {'type': 'section', 'block_id': '964TQ', 'text': {'type': 'mrkdwn', 'text': '*:chart_with_upwards_trend: Create Excel File*\nCreate a new Excel file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_excel_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create Excel', 'emoji': True}}}, {'type': 'divider', 'block_id': 'd0rC/'}, {'type': 'section', 'block_id': 'L+vd+', 'text': {'type': 'mrkdwn', 'text': '*:clipboard: List CSV Files*\nView all available CSV files', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'list_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}}}, {'type': 'section', 'block_id': 'GBiGn', 'text': {'type': 'mrkdwn', 'text': '*:page_facing_up: Create CSV File*\nCreate a new CSV file in your Drive folder', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'create_csv_menu', 'style': 'primary', 'text': {'type': 'plain_text', 'text': 'Create CSV', 'emoji': True}}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280081507779/pyZG3F776cFqjyNwEJg9ImI2', 'actions': [{'action_id': 'list_csv_menu', 'block_id': 'L+vd+', 'text': {'type': 'plain_text', 'text': 'List CSV', 'emoji': True}, 'style': 'primary', 'type': 'button', 'action_ts': '1753963695.188920'}]}
2025-07-31 15:08:15,224 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:08:15,225 - app.handlers.command_handler - INFO - handle_list_csv_action:685 - Handling list CSV action
2025-07-31 15:08:15,229 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:08:15] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:08:15,401 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:08:19,324 - app.services.google_service - INFO - list_available_csv_files:1245 - Searching for CSV files in folder: 1-EuvpmVvutbvrwAbitrVC89o-cNa8xgK
2025-07-31 15:08:22,055 - app.services.google_service - INFO - list_available_csv_files:1257 - Found 2 CSV files in folder
2025-07-31 15:08:23,046 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:08:29,465 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:08:29,466 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963703.132319', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9299062351377.9212409550592.68c36a014e17df5b4cb233451408295f', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963703.132319', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'unP63', 'text': {'type': 'plain_text', 'text': ':clipboard: Available CSV Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'ifqYn'}, {'type': 'section', 'block_id': 'WeEYL', 'text': {'type': 'mrkdwn', 'text': '*1. test.csv*\n:id: `1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy'}}, {'type': 'divider', 'block_id': 'h1pb4'}, {'type': 'section', 'block_id': 'Zx06e', 'text': {'type': 'mrkdwn', 'text': '*2. sales data.csv*\n:id: `1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9299062319857/OUkGQV1RxWGXhIOGVCRlbaYe', 'actions': [{'action_id': 'get_data_csv_1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'block_id': 'WeEYL', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'type': 'button', 'action_ts': '1753963709.460032'}]}
2025-07-31 15:08:29,547 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:08:29,576 - app.handlers.command_handler - INFO - handle_get_data_csv_action:375 - Handling get data CSV action
2025-07-31 15:08:29,596 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:08:29] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:08:29,835 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:08:35,642 - app.services.google_service - INFO - read_csv_by_file_id:653 - Read 6 rows from CSV file ID: 1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy
2025-07-31 15:08:36,537 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:08:43,809 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:08:43,812 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963716.679329', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280084055923.9212409550592.2e42938a2da5bf438ba97b03a1801d00', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963716.679329', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'V9hNH', 'text': {'type': 'mrkdwn', 'text': '*Data from CSV*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qLbQT'}, {'type': 'section', 'block_id': 'flEWv', 'text': {'type': 'mrkdwn', 'text': '*EmployeeID | FirstName | LastName | Department | Salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'TvfUv', 'text': {'type': 'plain_text', 'text': '101 | John | Doe | Engineering | 75000', 'emoji': True}}, {'type': 'section', 'block_id': 'XFrOw', 'text': {'type': 'plain_text', 'text': '102 | Jane | Smith | Marketing | 68000', 'emoji': True}}, {'type': 'section', 'block_id': 'YqM64', 'text': {'type': 'plain_text', 'text': '103 | Emily | Davis | HR | 62000', 'emoji': True}}, {'type': 'section', 'block_id': 'XwWQN', 'text': {'type': 'plain_text', 'text': '104 | Michael | Brown | Finance | 80000', 'emoji': True}}, {'type': 'section', 'block_id': 'CxEyG', 'text': {'type': 'plain_text', 'text': '105 | Sarah | Wilson | IT | 72000', 'emoji': True}}, {'type': 'actions', 'block_id': 'yjtwN', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280084053843/ifompPY9TY9KjEmyQSIxIFRU', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'yjtwN', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}', 'type': 'button', 'action_ts': '1753963723.795857'}]}
2025-07-31 15:08:43,860 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:08:43,867 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 15:08:43,884 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: csv, params: {'file_id': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy'}
2025-07-31 15:08:44,797 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280084055923.9212409550592.2e42938a2da5bf438ba97b03a1801d00
2025-07-31 15:08:44,801 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:08:44] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:09:06,697 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:09:06,704 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963716.679329', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9280810549414.9212409550592.306e1c60f26ebb31f0d57c4dc1fdb17c', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963716.679329', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'V9hNH', 'text': {'type': 'mrkdwn', 'text': '*Data from CSV*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qLbQT'}, {'type': 'section', 'block_id': 'flEWv', 'text': {'type': 'mrkdwn', 'text': '*EmployeeID | FirstName | LastName | Department | Salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'TvfUv', 'text': {'type': 'plain_text', 'text': '101 | John | Doe | Engineering | 75000', 'emoji': True}}, {'type': 'section', 'block_id': 'XFrOw', 'text': {'type': 'plain_text', 'text': '102 | Jane | Smith | Marketing | 68000', 'emoji': True}}, {'type': 'section', 'block_id': 'YqM64', 'text': {'type': 'plain_text', 'text': '103 | Emily | Davis | HR | 62000', 'emoji': True}}, {'type': 'section', 'block_id': 'XwWQN', 'text': {'type': 'plain_text', 'text': '104 | Michael | Brown | Finance | 80000', 'emoji': True}}, {'type': 'section', 'block_id': 'CxEyG', 'text': {'type': 'plain_text', 'text': '105 | Sarah | Wilson | IT | 72000', 'emoji': True}}, {'type': 'actions', 'block_id': 'yjtwN', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9280810511414/NedEra9qMMyUU9ecVlEqSSOJ', 'actions': [{'action_id': 'open_update_modal', 'block_id': 'yjtwN', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}', 'type': 'button', 'action_ts': '1753963746.357576'}]}
2025-07-31 15:09:06,758 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:09:06,761 - app.handlers.command_handler - INFO - handle_open_update_modal_action:560 - Handling open update modal action
2025-07-31 15:09:06,772 - app.handlers.command_handler - INFO - handle_open_update_modal_action:570 - Opening update modal for source: csv, params: {'file_id': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy'}
2025-07-31 15:09:07,713 - app.services.slack_service - INFO - open_modal:140 - Opened modal with trigger_id 9280810549414.9212409550592.306e1c60f26ebb31f0d57c4dc1fdb17c
2025-07-31 15:09:07,733 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:09:07] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:09:17,803 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:09:17,809 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'view_submission', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'trigger_id': '9283864088034.9212409550592.609dc67429ddb73903f67f089216320d', 'view': {'id': 'V098D50U676', 'team_id': 'T0968C1G6HE', 'type': 'modal', 'blocks': [{'type': 'input', 'block_id': 'row_block', 'label': {'type': 'plain_text', 'text': 'Row', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'row_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter row number', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'col_block', 'label': {'type': 'plain_text', 'text': 'Column', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'col_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter column letter (A, B, C...)', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}, {'type': 'input', 'block_id': 'value_block', 'label': {'type': 'plain_text', 'text': 'Value', 'emoji': True}, 'optional': False, 'dispatch_action': False, 'element': {'type': 'plain_text_input', 'action_id': 'value_input', 'placeholder': {'type': 'plain_text', 'text': 'Enter the value to write', 'emoji': True}, 'dispatch_action_config': {'trigger_actions_on': ['on_enter_pressed']}}}], 'private_metadata': '{"source": "csv", "file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}', 'callback_id': 'write_csv_data_modal', 'state': {'values': {'row_block': {'row_input': {'type': 'plain_text_input', 'value': '2'}}, 'col_block': {'col_input': {'type': 'plain_text_input', 'value': 'B'}}, 'value_block': {'value_input': {'type': 'plain_text_input', 'value': 'million'}}}}, 'hash': '1753963747.wzVnh8Ms', 'title': {'type': 'plain_text', 'text': 'Update Csv', 'emoji': True}, 'clear_on_close': False, 'notify_on_close': False, 'close': {'type': 'plain_text', 'text': 'Cancel', 'emoji': True}, 'submit': {'type': 'plain_text', 'text': 'Update', 'emoji': True}, 'previous_view_id': None, 'root_view_id': 'V098D50U676', 'app_id': 'A0980TP4JEP', 'external_id': '', 'app_installed_team_id': 'T0968C1G6HE', 'bot_id': 'B0981PK8CPM'}, 'response_urls': [], 'is_enterprise_install': False, 'enterprise': None}
2025-07-31 15:09:17,883 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: view_submission
2025-07-31 15:09:17,900 - app.handlers.command_handler - INFO - handle_view_submission:769 - Modal submission received
2025-07-31 15:09:17,902 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:794 - Handling write data modal submission
2025-07-31 15:09:17,913 - app.handlers.command_handler - INFO - handle_write_data_modal_submission:854 - Modal values - CSV File ID: 1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy, Row: 2, Col: B, Value: million
2025-07-31 15:09:17,938 - app.handlers.command_handler - INFO - update_data_async:902 - DEBUG - Async function start: row=2, col=B, value=million
2025-07-31 15:09:17,943 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:09:17] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:09:18,119 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:09:21,645 - app.handlers.command_handler - INFO - update_data_async:929 - Attempting to write CSV data: file_id=1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy, row=2, col=B, value=million
2025-07-31 15:09:21,646 - app.services.google_service - INFO - write_file_data:1412 - Writing data: file_id=1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy, row=2, col=B, value=million
2025-07-31 15:09:22,124 - app.services.google_service - INFO - write_file_data:1417 - Writing to file type: csv
2025-07-31 15:09:22,125 - app.services.google_service - INFO - _write_csv_data:1435 - Starting CSV write: file_id=1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy, row=2, col=B, value=million
2025-07-31 15:09:25,956 - app.services.google_service - ERROR - _write_csv_data:1484 - CSV write failed: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpeg9rywro'
2025-07-31 15:09:25,960 - app.services.google_service - ERROR - write_file_data:1429 - Failed to write file data: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpeg9rywro'
2025-07-31 15:09:25,965 - app.handlers.command_handler - ERROR - update_data_async:934 - CSV write failed: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpeg9rywro'
2025-07-31 15:09:25,976 - app.handlers.command_handler - ERROR - update_data_async:951 - Error in async sheet update: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\dell\\AppData\\Local\\Temp\\tmpeg9rywro'
2025-07-31 15:09:26,970 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:09:53,603 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\handlers\\command_handler.py', reloading
2025-07-31 15:09:53,936 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 15:09:56,308 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 15:09:56,309 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 15:09:58,671 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 15:10:00,061 - app.services.google_service - INFO - _get_oauth_credentials:69 - Refreshed OAuth2 token
2025-07-31 15:10:00,067 - app.services.google_service - INFO - _get_oauth_credentials:94 - Saved OAuth2 token to file
2025-07-31 15:10:00,090 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:10:00,121 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:10:00,170 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 15:10:00,852 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 15:10:00,866 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 15:11:31,485 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:11:31,501 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963716.679329', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9299077063057.9212409550592.1d3a7597a1296f02f486ad04cf7e2762', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963716.679329', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': 'V9hNH', 'text': {'type': 'mrkdwn', 'text': '*Data from CSV*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'qLbQT'}, {'type': 'section', 'block_id': 'flEWv', 'text': {'type': 'mrkdwn', 'text': '*EmployeeID | FirstName | LastName | Department | Salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'TvfUv', 'text': {'type': 'plain_text', 'text': '101 | John | Doe | Engineering | 75000', 'emoji': True}}, {'type': 'section', 'block_id': 'XFrOw', 'text': {'type': 'plain_text', 'text': '102 | Jane | Smith | Marketing | 68000', 'emoji': True}}, {'type': 'section', 'block_id': 'YqM64', 'text': {'type': 'plain_text', 'text': '103 | Emily | Davis | HR | 62000', 'emoji': True}}, {'type': 'section', 'block_id': 'XwWQN', 'text': {'type': 'plain_text', 'text': '104 | Michael | Brown | Finance | 80000', 'emoji': True}}, {'type': 'section', 'block_id': 'CxEyG', 'text': {'type': 'plain_text', 'text': '105 | Sarah | Wilson | IT | 72000', 'emoji': True}}, {'type': 'actions', 'block_id': 'yjtwN', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9299077033441/i1oJPhrQiCPyHbbV9U7UfoyJ', 'actions': [{'action_id': 'refresh_data', 'block_id': 'yjtwN', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}', 'type': 'button', 'action_ts': '1753963891.470783'}]}
2025-07-31 15:11:31,569 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:11:31,603 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:11:31,622 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:11:31] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:11:32,114 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:11:36,565 - app.services.google_service - INFO - read_file_data:1280 - Reading file data: 1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy
2025-07-31 15:11:38,443 - app.services.google_service - INFO - read_file_data:1285 - File type determined: csv
2025-07-31 15:11:40,707 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:13:05,079 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 15:13:06,385 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 15:13:07,181 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 15:13:07,182 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 15:13:08,715 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 15:13:08,729 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:13:08,765 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:13:08,782 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 15:13:08,908 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 15:13:08,924 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 15:13:16,517 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\slack_service.py', reloading
2025-07-31 15:13:16,855 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 15:13:17,943 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 15:13:17,946 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 15:13:19,906 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 15:13:19,912 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:13:19,923 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:13:19,926 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 15:13:19,965 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 15:13:19,972 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 15:13:51,626 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:13:51,627 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753963703.132319', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9305783007296.9212409550592.81530205c3194f77ad64bbb7602092f5', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753963703.132319', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'header', 'block_id': 'unP63', 'text': {'type': 'plain_text', 'text': ':clipboard: Available CSV Files', 'emoji': True}}, {'type': 'divider', 'block_id': 'ifqYn'}, {'type': 'section', 'block_id': 'WeEYL', 'text': {'type': 'mrkdwn', 'text': '*1. test.csv*\n:id: `1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy'}}, {'type': 'divider', 'block_id': 'h1pb4'}, {'type': 'section', 'block_id': 'Zx06e', 'text': {'type': 'mrkdwn', 'text': '*2. sales data.csv*\n:id: `1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq`\n:date: Modified: 2025-07-31\n:link: <https://drive.google.com/file/d/1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq/view?usp=drivesdk|Open in Google Drive>', 'verbatim': False}, 'accessory': {'type': 'button', 'action_id': 'get_data_csv_1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1irMK2h4oK-dfd72jxPYsP76kWA_7NrFq'}}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9305782993392/KMdqwDgF2eQVOKOjEKPiZ8Sp', 'actions': [{'action_id': 'get_data_csv_1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'block_id': 'WeEYL', 'text': {'type': 'plain_text', 'text': 'Get Data', 'emoji': True}, 'value': '1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy', 'type': 'button', 'action_ts': '1753964031.263106'}]}
2025-07-31 15:13:51,635 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:13:51,636 - app.handlers.command_handler - INFO - handle_get_data_csv_action:375 - Handling get data CSV action
2025-07-31 15:13:51,661 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:13:51] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:13:51,782 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:13:58,037 - app.services.google_service - INFO - read_csv_by_file_id:653 - Read 6 rows from CSV file ID: 1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy
2025-07-31 15:13:59,098 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:14:08,222 - app.handlers.command_handler - INFO - handle_interaction:79 - Interaction received
2025-07-31 15:14:08,228 - app.handlers.command_handler - INFO - handle_interaction:81 - Payload: {'type': 'block_actions', 'user': {'id': 'U0968C1G72L', 'username': 'millionmulugeta09', 'name': 'millionmulugeta09', 'team_id': 'T0968C1G6HE'}, 'api_app_id': 'A0980TP4JEP', 'token': 'JnykCvwaBIViO0dKOYatW0Ez', 'container': {'type': 'message', 'message_ts': '1753964039.238229', 'channel_id': 'D0981PKFR8T', 'is_ephemeral': False}, 'trigger_id': '9285193874452.9212409550592.09ee1fec32619320900f34a12a444716', 'team': {'id': 'T0968C1G6HE', 'domain': 'techsphereco'}, 'enterprise': None, 'is_enterprise_install': False, 'channel': {'id': 'D0981PKFR8T', 'name': 'directmessage'}, 'message': {'user': 'U0981PKACV9', 'type': 'message', 'ts': '1753964039.238229', 'bot_id': 'B0981PK8CPM', 'app_id': 'A0980TP4JEP', 'text': 'Message from Slack Data Manager Bot', 'team': 'T0968C1G6HE', 'blocks': [{'type': 'section', 'block_id': '+FtZU', 'text': {'type': 'mrkdwn', 'text': '*Data from CSV*', 'verbatim': False}}, {'type': 'divider', 'block_id': 'JyEpX'}, {'type': 'section', 'block_id': 'PU6zK', 'text': {'type': 'mrkdwn', 'text': ":warning: *Header can't be edited. Row numbers start from the second row.*", 'verbatim': False}}, {'type': 'section', 'block_id': '/HTqV', 'text': {'type': 'mrkdwn', 'text': '*EmployeeID | FirstName | LastName | Department | Salary*', 'verbatim': False}}, {'type': 'section', 'block_id': 'MvLnA', 'text': {'type': 'plain_text', 'text': '101 | John | Doe | Engineering | 75000', 'emoji': True}}, {'type': 'section', 'block_id': 'uW4HD', 'text': {'type': 'plain_text', 'text': '102 | million | Smith | Marketing | 68000', 'emoji': True}}, {'type': 'section', 'block_id': 'Gxoki', 'text': {'type': 'plain_text', 'text': '103 | Emily | Davis | HR | 62000', 'emoji': True}}, {'type': 'section', 'block_id': '0Ri/Z', 'text': {'type': 'plain_text', 'text': '104 | Michael | Brown | Finance | 80000', 'emoji': True}}, {'type': 'section', 'block_id': 'oHE8m', 'text': {'type': 'plain_text', 'text': '105 | Sarah | Wilson | IT | 72000', 'emoji': True}}, {'type': 'actions', 'block_id': 'k4sas', 'elements': [{'type': 'button', 'action_id': 'refresh_data', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}, {'type': 'button', 'action_id': 'open_update_modal', 'text': {'type': 'plain_text', 'text': ':pencil2: Update Cell', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}'}]}]}, 'state': {'values': {}}, 'response_url': 'https://hooks.slack.com/actions/T0968C1G6HE/9285193868404/0kx0oqrHyFpdoa3rPehujBuL', 'actions': [{'action_id': 'refresh_data', 'block_id': 'k4sas', 'text': {'type': 'plain_text', 'text': ':arrows_counterclockwise: Refresh', 'emoji': True}, 'value': '{"source": "csv", "params": {"file_id": "1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy"}}', 'type': 'button', 'action_ts': '1753964048.204989'}]}
2025-07-31 15:14:08,294 - app.handlers.command_handler - INFO - handle_interaction:84 - Interaction type: block_actions
2025-07-31 15:14:08,296 - app.handlers.command_handler - INFO - handle_refresh_data_action:447 - Handling refresh data action
2025-07-31 15:14:08,308 - werkzeug - INFO - _log:97 - 127.0.0.1 - - [31/Jul/2025 15:14:08] "POST /api/interactions/command HTTP/1.1" 200 -
2025-07-31 15:14:08,439 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:14:12,177 - app.services.google_service - INFO - read_file_data:1280 - Reading file data: 1HQBtL1m90bvvW7jToguxDRKHLAfnVyhy
2025-07-31 15:14:12,602 - app.services.google_service - INFO - read_file_data:1285 - File type determined: csv
2025-07-31 15:14:14,590 - app.services.slack_service - INFO - post_message:75 - Posted message to channel U0968C1G72L
2025-07-31 15:22:28,972 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 15:22:28,973 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 15:22:31,560 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 15:22:31,569 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:22:31,591 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:22:31,695 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 15:22:32,284 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 15:22:32,288 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 15:22:32,300 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 15:22:33,334 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 15:22:33,334 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 15:22:35,196 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 15:22:35,201 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:22:35,212 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 15:22:35,234 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 15:22:35,344 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 15:22:35,357 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-07-31 22:46:14,246 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 22:46:14,247 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 22:46:22,340 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 22:46:23,929 - app.services.google_service - INFO - _get_oauth_credentials:69 - Refreshed OAuth2 token
2025-07-31 22:46:23,931 - app.services.google_service - INFO - _get_oauth_credentials:94 - Saved OAuth2 token to file
2025-07-31 22:46:23,943 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 22:46:23,994 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 22:46:24,033 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 22:46:24,187 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-07-31 22:46:24,188 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-07-31 22:46:24,192 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-07-31 22:46:25,185 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-07-31 22:46:25,186 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-07-31 22:46:26,641 - app.services.google_service - INFO - _get_oauth_credentials:60 - Loaded OAuth2 token from file
2025-07-31 22:46:26,646 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 22:46:26,657 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-07-31 22:46:26,662 - app.services.google_service - INFO - _init_google_clients:249 - Google API clients initialized with OAuth2
2025-07-31 22:46:26,749 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-07-31 22:46:26,761 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:03:35,802 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:03:35,805 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:03:43,381 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:03:44,782 - app.services.google_service - INFO - _get_oauth_credentials:93 - Refreshed OAuth2 token
2025-08-01 10:03:44,788 - app.services.google_service - INFO - _get_oauth_credentials:130 - Saved OAuth2 token to file
2025-08-01 10:03:44,818 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:03:44,900 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:03:44,953 - app.services.google_service - INFO - _init_google_clients:285 - Google API clients initialized with OAuth2
2025-08-01 10:03:45,000 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:03:45,002 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:03:45,003 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:03:45,004 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:03:45,007 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:03:45,007 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:03:45,008 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:03:45,009 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:03:45,009 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:03:45,010 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:03:45,011 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:03:45,200 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.190:5000
2025-08-01 10:03:45,201 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-08-01 10:03:45,206 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:03:46,024 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:03:46,024 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:03:47,493 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:03:47,499 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:03:47,513 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:03:47,516 - app.services.google_service - INFO - _init_google_clients:285 - Google API clients initialized with OAuth2
2025-08-01 10:03:47,545 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:03:47,549 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:03:47,550 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:03:47,550 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:03:47,551 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:03:47,554 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:03:47,555 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:03:47,559 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:03:47,560 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:03:47,564 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:03:47,567 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:03:47,622 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:03:47,650 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:10:33,430 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:10:34,767 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:10:40,462 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:10:40,463 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:10:42,957 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:10:42,978 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:10:43,008 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:10:43,039 - app.services.google_service - INFO - _init_google_clients:311 - Google API clients initialized with OAuth2
2025-08-01 10:10:43,390 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:10:43,409 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:10:43,435 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:10:43,482 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:10:43,486 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:10:43,489 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:10:43,504 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:10:43,506 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:10:43,507 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:10:43,533 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:10:43,539 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:10:43,775 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:10:43,792 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:11:59,028 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:12:01,264 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:12:05,558 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:12:05,560 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:12:09,208 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:12:09,257 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:09,508 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:09,596 - app.services.google_service - INFO - _init_google_clients:283 - Google API clients initialized with OAuth2
2025-08-01 10:12:10,373 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:12:10,392 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:12:10,425 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:12:10,435 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:12:10,459 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:12:10,493 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:12:10,541 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:12:10,558 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:12:10,561 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:12:10,591 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:12:10,608 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:12:10,752 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:12:10,767 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:12:27,595 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:12:30,359 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:12:33,472 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:12:33,473 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:12:37,351 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:12:37,358 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:37,370 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:37,391 - app.services.google_service - INFO - _init_google_clients:283 - Google API clients initialized with OAuth2
2025-08-01 10:12:37,453 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:12:37,464 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:12:37,473 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:12:37,475 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:12:37,477 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:12:37,478 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:12:37,479 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:12:37,481 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:12:37,482 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:12:37,484 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:12:37,485 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:12:37,617 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:12:37,639 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:12:49,818 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:12:51,986 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:12:55,614 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:12:55,615 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:12:57,640 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:12:57,650 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:57,661 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:12:57,665 - app.services.google_service - INFO - _init_google_clients:272 - Google API clients initialized with OAuth2
2025-08-01 10:12:57,734 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:12:57,744 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:12:57,747 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:12:57,748 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:12:57,749 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:12:57,749 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:12:57,750 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:12:57,750 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:12:57,755 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:12:57,758 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:12:57,760 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:12:57,816 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:12:57,839 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:14:33,644 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:14:34,490 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:14:36,647 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:14:36,654 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:14:39,247 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:14:39,259 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:14:39,276 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:14:39,280 - app.services.google_service - INFO - _init_google_clients:272 - Google API clients initialized with OAuth2
2025-08-01 10:14:39,329 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:14:39,331 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:14:39,332 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:14:39,333 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:14:39,334 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:14:39,336 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:14:39,337 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:14:39,338 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:14:39,347 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:14:39,349 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:14:39,349 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:14:39,509 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:14:39,526 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
2025-08-01 10:15:07,422 - werkzeug - INFO - _log:97 -  * Detected change in 'C:\\Users\\dell\\Desktop\\slack-bot\\app\\services\\google_service.py', reloading
2025-08-01 10:15:07,915 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-08-01 10:15:09,047 - app.core.cache - INFO - init_cache:28 - In-memory cache initialized successfully
2025-08-01 10:15:09,060 - app.core.rate_limiter - INFO - init_rate_limiter:28 - Rate limiter initialized: 100 requests per 3600 seconds
2025-08-01 10:15:11,489 - app.services.google_service - INFO - _get_oauth_credentials:84 - Loaded OAuth2 token from file
2025-08-01 10:15:11,495 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:15:11,506 - googleapiclient.discovery_cache - INFO - autodetect:49 - file_cache is only supported with oauth2client<4.0.0
2025-08-01 10:15:11,519 - app.services.google_service - INFO - _init_google_clients:272 - Google API clients initialized with OAuth2
2025-08-01 10:15:11,555 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 8
2025-08-01 10:15:11,557 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 9
2025-08-01 10:15:11,563 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 10
2025-08-01 10:15:11,564 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 11
2025-08-01 10:15:11,565 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 12
2025-08-01 10:15:11,566 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 13
2025-08-01 10:15:11,567 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 14
2025-08-01 10:15:11,568 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 15
2025-08-01 10:15:11,569 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 16
2025-08-01 10:15:11,570 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 17
2025-08-01 10:15:11,570 - dotenv.main - WARNING - with_warn_for_invalid_lines:27 - Python-dotenv could not parse statement starting at line 18
2025-08-01 10:15:11,624 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-08-01 10:15:11,638 - werkzeug - INFO - _log:97 -  * Debugger PIN: 871-558-511
